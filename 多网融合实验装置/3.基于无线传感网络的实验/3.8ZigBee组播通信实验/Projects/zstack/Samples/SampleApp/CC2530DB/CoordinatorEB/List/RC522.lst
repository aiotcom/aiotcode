###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         26/Feb/2019  21:50:08 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Components\HARDWARE\RC522.c                   #
#    Command line       =  -f D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\br #
#                          oadcast\Projects\zstack\Samples\SampleApp\CC2530DB #
#                          \..\..\..\Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ  #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS) -f     #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\Tools\CC2530DB\f8wConfig.cfg (-DSECURE=0    #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFF11                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=TRUE      #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Components\HARDWARE\RC522.c -D ZIGBEEPRO -D   #
#                          ZTOOL_P1 -D MT_SYS_FUNC -D xMT_ZDO_FUNC -D         #
#                          LCD_SUPPORTED=DEBUG -D NV_RESTORE -lC              #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\Co #
#                          ordinatorEB\List\ -lA D:\ZigBee\KJXY-ZigBee\useful #
#                          _code\ZigBee-Ext\broadcast\Projects\zstack\Samples #
#                          \SampleApp\CC2530DB\CoordinatorEB\List\            #
#                          --diag_suppress Pe001,Pa010 -o                     #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\Co #
#                          ordinatorEB\Obj\ -e --debug --core=plain           #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I D:\ZigBee\KJXY-ZigBee\usef #
#                          ul_code\ZigBee-Ext\broadcast\Projects\zstack\Sampl #
#                          es\SampleApp\CC2530DB\ -I                          #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \SOURCE\ -I D:\ZigBee\KJXY-ZigBee\useful_code\ZigB #
#                          ee-Ext\broadcast\Projects\zstack\Samples\SampleApp #
#                          \CC2530DB\..\..\..\ZMAIN\TI2530DB\ -I              #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\MT\ -I                     #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\HAL\INCLUDE\ -I            #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\HAL\TARGET\CC2530EB\ -I    #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\OSAL\MCU\CCSOC\ -I         #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\OSAL\INCLUDE\ -I           #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\STACK\AF\ -I               #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\STACK\NWK\ -I              #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\STACK\SEC\ -I              #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\STACK\SAPI\ -I             #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\STACK\SYS\ -I              #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\STACK\ZDO\ -I              #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\ZMAC\F8W\ -I               #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\ZMAC\ -I                   #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\SERVICES\SADDR\ -I         #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\SERVICES\SDATA\ -I         #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\MAC\INCLUDE\ -I            #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\MAC\HIGH_LEVEL\ -I         #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\ -I    #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE #
#                          _CHIP\ -I D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee #
#                          -Ext\broadcast\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\COMPONENTS\HARDWARE\ -I     #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\HARDWARE\MPU6050\ -I       #
#                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\COMPONENTS\HARDWARE\MPU6050\eMPL\     #
#                          -Ohz                                               #
#    List file          =  D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\Co #
#                          ordinatorEB\List\RC522.lst                         #
#    Object file        =  D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broad #
#                          cast\Projects\zstack\Samples\SampleApp\CC2530DB\Co #
#                          ordinatorEB\Obj\RC522.r51                          #
#                                                                             #
#                                                                             #
###############################################################################

D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broadcast\Components\HARDWARE\RC522.c
      1          #include "RC522.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf6
   \   unsigned char volatile __sfr P1INP
   \                     P1INP:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
      2          #include "stdio.h"
      3          #include "stdlib.h"
      4          #include "string.h"
      5          #include "OLED.h"
      6          #include "delay.h"
      7          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      8          int icd  = 0;
   \                     icd:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      9          uint8 i = 0;
   \                     i:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     10          uint8 IC_Card_Exist = 0;
   \                     IC_Card_Exist:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
     11          unsigned char pk[6] ={0xff,0xff,0xff,0xff,0xff,0xff};     
   \                     pk:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for pk>`
   \   000006                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     12          unsigned char ucArray_ID [ 16 ] = {0,0,0,0};//先后存放IC卡的类型和UID(IC卡序列号)
   \                     ucArray_ID:
   \   000000                DS 16
   \   000010                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     13          uint8 SendBuf[33];
   \                     SendBuf:
   \   000000                DS 33
   \   000021                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     14          uint8 SendData[9];
   \                     SendData:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     15          unsigned char ucStatusReturn;  //返回状态
   \                     ucStatusReturn:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     16          unsigned char date1[16] = {0x00};
   \                     date1:
   \   000000                DS 16
   \   000010                REQUIRE __INIT_XDATA_Z
     17          static void RC522_SPI_Config( void );
     18          
     19          //==========================================================
     20          //	函数名称：	RC522_Init
     21          //
     22          //	函数功能：	RC522初始化函数
     23          //
     24          //	入口参数：	无
     25          //
     26          //	返回参数：	无
     27          //
     28          //	说明：		
     29          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     30          void RC522_Init ( void )
   \                     RC522_Init:
     31          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     32              RC522_SPI_Config ();
   \   000004   53F40D       ANL     0xf4,#0xd
   \   000007   43FE72       ORL     0xfe,#0x72
   \   00000A   53FE7F       ANL     0xfe,#0x7f
   \   00000D   53F67F       ANL     0xf6,#0x7f
     33              
     34              macRC522_Reset_Disable();
   \   000010   D291         SETB    0x90.1
   \   000012   D291         SETB    0x90.1
     35              
     36              macRC522_CS_Disable();
   \   000014   D294         SETB    0x90.4
   \   000016   D294         SETB    0x90.4
     37              
     38              PcdReset();
   \   000018                ; Setup parameters for call to function PcdReset
   \   000018   12....       LCALL   ??PcdReset?relay
     39              M500PcdConfigISOType ( 'A' );//设置工作模式    
   \   00001B                ; Setup parameters for call to function M500PcdConfigISOType
   \   00001B   7941         MOV     R1,#0x41
   \   00001D   12....       LCALL   ??M500PcdConfigISOType?relay
     40          }
   \   000020   02....       LJMP    ?Subroutine0 & 0xFFFF
   \   000023                REQUIRE _A_P1
   \   000023                REQUIRE P1SEL
   \   000023                REQUIRE P1DIR
   \   000023                REQUIRE P1INP

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
     41          
     42          //==========================================================
     43          //	函数名称：	DataRep()
     44          //
     45          //	函数功能：	显示数据装换
     46          //
     47          //	入口参数：	无
     48          //
     49          //	返回参数：	无
     50          //
     51          //	说明：		
     52          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     53          void DataRep(uint8 data,uint8 num,uint8 flag,uint8 flg)
   \                     DataRep:
     54          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FD           MOV     R5,A
   \   000007   EA           MOV     A,R2
   \   000008   FF           MOV     R7,A
   \   000009   EB           MOV     A,R3
   \   00000A   FE           MOV     R6,A
   \   00000B   EF           MOV     A,R7
   \   00000C   C3           CLR     C
   \   00000D   13           RRC     A
   \   00000E   FA           MOV     R2,A
   \   00000F   8F82         MOV     DPL,R7
   \   000011   A882         MOV     R0,DPL
   \   000013   EC           MOV     A,R4
   \   000014   6062         JZ      ??DataRep_0
     55            if(flg)
     56            {
     57              switch(data)
   \   000016   74..         MOV     A,#SendData & 0xff
   \   000018   28           ADD     A,R0
   \   000019   F8           MOV     R0,A
   \   00001A   74..         MOV     A,#(SendData >> 8) & 0xff
   \   00001C   3400         ADDC    A,#0x0
   \   00001E   F9           MOV     R1,A
   \   00001F   ED           MOV     A,R5
   \   000020   24F6         ADD     A,#-0xa
   \   000022   6011         JZ      ??DataRep_1
   \   000024   14           DEC     A
   \   000025   6016         JZ      ??DataRep_2
   \   000027   14           DEC     A
   \   000028   601B         JZ      ??DataRep_3
   \   00002A   14           DEC     A
   \   00002B   6020         JZ      ??DataRep_4
   \   00002D   14           DEC     A
   \   00002E   6025         JZ      ??DataRep_5
   \   000030   14           DEC     A
   \   000031   602A         JZ      ??DataRep_6
   \   000033   8030         SJMP    ??DataRep_7
     58              {
     59                case 0x0A:
     60                  SendData[num] = 65;
   \                     ??DataRep_1:
   \   000035   8882         MOV     DPL,R0
   \   000037   8983         MOV     DPH,R1
   \   000039   7441         MOV     A,#0x41
   \   00003B   806E         SJMP    ??DataRep_8
     61                  break;
     62                case 0x0B:
     63                  SendData[num] = 66;
   \                     ??DataRep_2:
   \   00003D   8882         MOV     DPL,R0
   \   00003F   8983         MOV     DPH,R1
   \   000041   7442         MOV     A,#0x42
   \   000043   8066         SJMP    ??DataRep_8
     64                  break;
     65                case 0x0C:
     66                  SendData[num] = 67;
   \                     ??DataRep_3:
   \   000045   8882         MOV     DPL,R0
   \   000047   8983         MOV     DPH,R1
   \   000049   7443         MOV     A,#0x43
   \   00004B   805E         SJMP    ??DataRep_8
     67                  break;
     68                case 0x0D:
     69                  SendData[num] = 68;
   \                     ??DataRep_4:
   \   00004D   8882         MOV     DPL,R0
   \   00004F   8983         MOV     DPH,R1
   \   000051   7444         MOV     A,#0x44
   \   000053   8056         SJMP    ??DataRep_8
     70                  break;
     71                case 0x0E:
     72                  SendData[num] = 69;
   \                     ??DataRep_5:
   \   000055   8882         MOV     DPL,R0
   \   000057   8983         MOV     DPH,R1
   \   000059   7445         MOV     A,#0x45
   \   00005B   804E         SJMP    ??DataRep_8
     73                  break; 
     74                case 0x0F:
     75                  SendData[num] = 70;
   \                     ??DataRep_6:
   \   00005D   8882         MOV     DPL,R0
   \   00005F   8983         MOV     DPH,R1
   \   000061   7446         MOV     A,#0x46
   \   000063   8046         SJMP    ??DataRep_8
     76                  break; 
     77                default:
     78                  if(flag)
   \                     ??DataRep_7:
   \   000065   74..         MOV     A,#ucArray_ID & 0xff
   \   000067   2A           ADD     A,R2
   \   000068   F582         MOV     DPL,A
   \   00006A   74..         MOV     A,#(ucArray_ID >> 8) & 0xff
   \   00006C   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   00006F   EE           MOV     A,R6
   \   000070   6030         JZ      ??DataRep_9
     79                  {
     80                    SendData[num] = (ucArray_ID[(num/2)]>>4)+0x30;
   \                     ??DataRep_10:
   \   000072   EA           MOV     A,R2
   \   000073   C4           SWAP    A
   \   000074   540F         ANL     A,#0xf
   \   000076   802D         SJMP    ??DataRep_11
     81                  }
     82                  else
     83                  {
     84                    SendData[num] = (ucArray_ID[(num/2)]&0x0f)+0x30;
     85                  }     
     86                break;
     87              } 
     88            }
     89            else
     90            {
     91              switch(data)
   \                     ??DataRep_0:
   \   000078   74..         MOV     A,#SendBuf & 0xff
   \   00007A   28           ADD     A,R0
   \   00007B   F8           MOV     R0,A
   \   00007C   74..         MOV     A,#(SendBuf >> 8) & 0xff
   \   00007E   3400         ADDC    A,#0x0
   \   000080   F9           MOV     R1,A
   \   000081   ED           MOV     A,R5
   \   000082   24F6         ADD     A,#-0xa
   \   000084   60AF         JZ      ??DataRep_1
   \   000086   14           DEC     A
   \   000087   60B4         JZ      ??DataRep_2
   \   000089   14           DEC     A
   \   00008A   60B9         JZ      ??DataRep_3
   \   00008C   14           DEC     A
   \   00008D   60BE         JZ      ??DataRep_4
   \   00008F   14           DEC     A
   \   000090   60C3         JZ      ??DataRep_5
   \   000092   14           DEC     A
   \   000093   60C8         JZ      ??DataRep_6
     92              {
     93                case 0x0A:
     94                  SendBuf[num] = 65;
     95                  break;
     96                case 0x0B:
     97                  SendBuf[num] = 66;
     98                  break;
     99                case 0x0C:
    100                  SendBuf[num] = 67;
    101                  break;
    102                case 0x0D:
    103                  SendBuf[num] = 68;
    104                  break;
    105                case 0x0E:
    106                  SendBuf[num] = 69;
    107                  break; 
    108                case 0x0F:
    109                  SendBuf[num] = 70;
    110                  break; 
    111                default:
    112                  if(flag)
   \   000095   74..         MOV     A,#date1 & 0xff
   \   000097   2A           ADD     A,R2
   \   000098   F582         MOV     DPL,A
   \   00009A   74..         MOV     A,#(date1 >> 8) & 0xff
   \   00009C   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   00009F   EE           MOV     A,R6
   \   0000A0   70D0         JNZ     ??DataRep_10
    113                  {
    114                    SendBuf[num] = (date1[(num/2)]>>4)+0x30;
    115                  }
    116                  else
    117                  {
    118                    SendBuf[num] = (date1[(num/2)]&0x0f)+0x30;
   \                     ??DataRep_9:
   \   0000A2   740F         MOV     A,#0xf
   \   0000A4   5A           ANL     A,R2
   \                     ??DataRep_11:
   \   0000A5   2430         ADD     A,#0x30
   \   0000A7   8882         MOV     DPL,R0
   \   0000A9   8983         MOV     DPH,R1
   \                     ??DataRep_8:
   \   0000AB   F0           MOVX    @DPTR,A
    119                  }     
    120                break;
    121              }
    122            }
    123          }
   \   0000AC   02....       LJMP    ??Subroutine30_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   E0           MOVX    A,@DPTR
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine30_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_47:
   \   000003   FA           MOV     R2,A
   \   000004   22           RET
    124          //==========================================================
    125          //	函数名称：	IC_Card_Search
    126          //
    127          //	函数功能：	读IC卡
    128          //
    129          //	入口参数：	无
    130          //
    131          //	返回参数：	无
    132          //
    133          //	说明：		
    134          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    135          uint8* RFID_GetCardID(void)
   \                     RFID_GetCardID:
    136          {    
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    137              RC522_Init();
   \   000005                ; Setup parameters for call to function RC522_Init
   \   000005   12....       LCALL   ??RC522_Init?relay
    138              ucStatusReturn = PcdRequest ( PICC_REQALL, ucArray_ID );
   \   000008                ; Setup parameters for call to function PcdRequest
   \   000008   12....       LCALL   ?Subroutine15 & 0xFFFF
    139          
    140              if ((ucStatusReturn == MI_OK ))
   \                     ??CrossCallReturnLabel_17:
   \   00000B   7053         JNZ     ??RFID_GetCardID_0
    141              {
    142                if (PcdAnticoll(ucArray_ID) == MI_OK)
   \   00000D                ; Setup parameters for call to function PcdAnticoll
   \   00000D   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   000010   7048         JNZ     ??RFID_GetCardID_1
    143                {
    144                  printf("get IC Card\r\n");
   \   000012                ; Setup parameters for call to function printf
   \   000012   7A..         MOV     R2,#`?<Constant "get IC Card\\r\\n">` & 0xff
   \   000014   7B..         MOV     R3,#(`?<Constant "get IC Card\\r\\n">` >> 8) & 0xff
   \   000016   12....       LCALL   ??printf?relay
    145                  printf("UUID=0x%x%x%x%x\r\n",ucArray_ID[0],ucArray_ID[1],ucArray_ID[2],ucArray_ID[3]);
   \   000019                ; Setup parameters for call to function printf
   \   000019   90....       MOV     DPTR,#ucArray_ID + 3
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F5..         MOV     ?V0 + 0,A
   \   00001F   75..00       MOV     ?V0 + 1,#0x0
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   90....       MOV     DPTR,#ucArray_ID + 2
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F5..         MOV     ?V0 + 0,A
   \   00002D   78..         MOV     R0,#?V0 + 0
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   90....       MOV     DPTR,#ucArray_ID + 1
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F5..         MOV     ?V0 + 0,A
   \   000038   78..         MOV     R0,#?V0 + 0
   \   00003A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003D   90....       MOV     DPTR,#ucArray_ID
   \   000040   E0           MOVX    A,@DPTR
   \   000041   F5..         MOV     ?V0 + 0,A
   \   000043   78..         MOV     R0,#?V0 + 0
   \   000045   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000048   7A..         MOV     R2,#`?<Constant "UUID=0x%x%x%x%x\\r\\n">` & 0xff
   \   00004A   7B..         MOV     R3,#(`?<Constant "UUID=0x%x%x%x%x\\r\\n">` >> 8) & 0xff
   \   00004C   12....       LCALL   ??printf?relay
   \   00004F   7408         MOV     A,#0x8
   \   000051   12....       LCALL   ?DEALLOC_XSTACK8
    146                  return &ucArray_ID[0];
   \   000054   7A..         MOV     R2,#ucArray_ID & 0xff
   \   000056   7B..         MOV     R3,#(ucArray_ID >> 8) & 0xff
   \   000058   8011         SJMP    ??RFID_GetCardID_2
    147                }
    148                else
    149                {
    150                  printf("read UUID failure\r\n");
   \                     ??RFID_GetCardID_1:
   \   00005A                ; Setup parameters for call to function printf
   \   00005A   7A..         MOV     R2,#`?<Constant "read UUID failure\\r\\n">` & 0xff
   \   00005C   7B..         MOV     R3,#(`?<Constant "read UUID failure\\r\\n">` >> 8) & 0xff
   \   00005E   8004         SJMP    ??RFID_GetCardID_3
    151                  return (uint8*)0;
    152                }
    153              }
    154              else
    155              {
    156                printf("lost IC Card\r\n");
   \                     ??RFID_GetCardID_0:
   \   000060                ; Setup parameters for call to function printf
   \   000060   7A..         MOV     R2,#`?<Constant "lost IC Card\\r\\n">` & 0xff
   \   000062   7B..         MOV     R3,#(`?<Constant "lost IC Card\\r\\n">` >> 8) & 0xff
   \                     ??RFID_GetCardID_3:
   \   000064   12....       LCALL   ??printf?relay
    157                return (uint8*)0;
   \   000067   7A00         MOV     R2,#0x0
   \   000069   7B00         MOV     R3,#0x0
    158              }
   \                     ??RFID_GetCardID_2:
   \   00006B   80..         SJMP    ??Subroutine29_0
    159          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine29_0:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   7A..         MOV     R2,#ucArray_ID & 0xff
   \   000002   7B..         MOV     R3,#(ucArray_ID >> 8) & 0xff
   \   000004   12....       LCALL   ??PcdAnticoll?relay
   \   000007   E9           MOV     A,R1
   \   000008   6426         XRL     A,#0x26
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   7A..         MOV     R2,#ucArray_ID & 0xff
   \   000002   7B..         MOV     R3,#(ucArray_ID >> 8) & 0xff
   \   000004   7952         MOV     R1,#0x52
   \   000006   12....       LCALL   ??PcdRequest?relay
   \   000009   E9           MOV     A,R1
   \   00000A   90....       MOV     DPTR,#ucStatusReturn
   \   00000D   F0           MOVX    @DPTR,A
   \   00000E   6426         XRL     A,#0x26
   \   000010   22           RET
    160          //==========================================================
    161          //	函数名称：	IC_Card_Search
    162          //
    163          //	函数功能：	读IC卡
    164          //
    165          //	入口参数：	无
    166          //
    167          //	返回参数：	无
    168          //
    169          //	说明：		
    170          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    171          void IC_Card_Search ( void )
   \                     IC_Card_Search:
    172          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    173              SendData[8] = 0;
   \   000005   90....       MOV     DPTR,#SendData + 8
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
    174              SendBuf[32] = 0;
   \   00000A   90....       MOV     DPTR,#SendBuf + 32
   \   00000D   F0           MOVX    @DPTR,A
    175              ucStatusReturn = PcdRequest ( PICC_REQALL, ucArray_ID );//若失败再次寻卡
   \   00000E                ; Setup parameters for call to function PcdRequest
   \   00000E   12....       LCALL   ?Subroutine15 & 0xFFFF
    176              
    177              if ((ucStatusReturn == MI_OK )&&(IC_Card_Exist == 0))
   \                     ??CrossCallReturnLabel_18:
   \   000011   6003         JZ      $+5
   \   000013   02....       LJMP    ??IC_Card_Search_0 & 0xFFFF
   \   000016   90....       MOV     DPTR,#IC_Card_Exist
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   6003         JZ      $+5
   \   00001C   02....       LJMP    ??IC_Card_Search_1 & 0xFFFF
    178              {
    179                  if (PcdAnticoll(ucArray_ID) == MI_OK)  //防冲撞（当有多张卡进入读写器操作范围时，防冲突机制会从其中选择一张进行操作）
   \   00001F                ; Setup parameters for call to function PcdAnticoll
   \   00001F   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   000022   6003         JZ      $+5
   \   000024   02....       LJMP    ??IC_Card_Search_0 & 0xFFFF
    180                  {               
    181                      if (PcdSelect(ucArray_ID) == MI_OK)//选择ucArray_ID的卡
   \   000027                ; Setup parameters for call to function PcdSelect
   \   000027   7A..         MOV     R2,#ucArray_ID & 0xff
   \   000029   7B..         MOV     R3,#(ucArray_ID >> 8) & 0xff
   \   00002B   12....       LCALL   ??PcdSelect?relay
   \   00002E   E9           MOV     A,R1
   \   00002F   6426         XRL     A,#0x26
   \   000031   6003         JZ      $+5
   \   000033   02....       LJMP    ??IC_Card_Search_0 & 0xFFFF
    182                      {
    183                          IC_Card_Exist = 1;
   \   000036   90....       MOV     DPTR,#IC_Card_Exist
   \   000039   7401         MOV     A,#0x1
   \   00003B   F0           MOVX    @DPTR,A
    184                          if (PcdAuthState(0x61,0x5,pk,ucArray_ID) == MI_OK)//申请对卡的授权  
   \   00003C                ; Setup parameters for call to function PcdAuthState
   \   00003C   75....       MOV     ?V0 + 0,#ucArray_ID & 0xff
   \   00003F   75....       MOV     ?V0 + 1,#(ucArray_ID >> 8) & 0xff
   \   000042   78..         MOV     R0,#?V0 + 0
   \   000044   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000047   7C..         MOV     R4,#pk & 0xff
   \   000049   7D..         MOV     R5,#(pk >> 8) & 0xff
   \   00004B   7A05         MOV     R2,#0x5
   \   00004D   7961         MOV     R1,#0x61
   \   00004F   12....       LCALL   ??PcdAuthState?relay
   \   000052   7402         MOV     A,#0x2
   \   000054   12....       LCALL   ?DEALLOC_XSTACK8
   \   000057   E9           MOV     A,R1
   \   000058   6426         XRL     A,#0x26
   \   00005A   6003         JZ      $+5
   \   00005C   02....       LJMP    ??IC_Card_Search_0 & 0xFFFF
    185                          {
    186                              if (PcdRead(0x5,date1) == MI_OK )
   \   00005F                ; Setup parameters for call to function PcdRead
   \   00005F   7A..         MOV     R2,#date1 & 0xff
   \   000061   7B..         MOV     R3,#(date1 >> 8) & 0xff
   \   000063   7905         MOV     R1,#0x5
   \   000065   12....       LCALL   ??PcdRead?relay
   \   000068   E9           MOV     A,R1
   \   000069   6426         XRL     A,#0x26
   \   00006B   7073         JNZ     ??IC_Card_Search_0
    187                              {   
    188                                  for(i = 0;i < 8;i ++)
   \   00006D   90....       MOV     DPTR,#i
   \   000070   E4           CLR     A
   \   000071   F0           MOVX    @DPTR,A
   \   000072   8005         SJMP    ??IC_Card_Search_2
    189                                  {
    190                                    if(i%2==0)
   \                     ??IC_Card_Search_3:
   \   000074   E0           MOVX    A,@DPTR
   \   000075   A2E0         MOV     C,0xE0 /* A   */.0
   \   000077   400B         JC      ??IC_Card_Search_4
    191                                    {
    192                                       DataRep((ucArray_ID[(i/2)]>>4),i,1,1);
   \                     ??IC_Card_Search_2:
   \   000079                ; Setup parameters for call to function DataRep
   \   000079   7C01         MOV     R4,#0x1
   \   00007B   7B01         MOV     R3,#0x1
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   12....       LCALL   ?Subroutine7 & 0xFFFF
    193                                    }
   \                     ??CrossCallReturnLabel_2:
   \   000081   C4           SWAP    A
   \   000082   8007         SJMP    ??CrossCallReturnLabel_3
    194                                    else
    195                                    {
    196                                      DataRep((ucArray_ID[(i/2)]&0x0f),i,0,1);
   \                     ??IC_Card_Search_4:
   \   000084                ; Setup parameters for call to function DataRep
   \   000084   7C01         MOV     R4,#0x1
   \   000086   7B00         MOV     R3,#0x0
   \   000088   12....       LCALL   ?Subroutine7 & 0xFFFF
    197                                    }                         
    198                                  }
   \                     ??CrossCallReturnLabel_3:
   \   00008B   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   00008E   9408         SUBB    A,#0x8
   \   000090   40E2         JC      ??IC_Card_Search_3
    199                                  
    200                                  
    201                                  for(i = 0;i < 32;i ++)
   \   000092   E4           CLR     A
   \   000093   F0           MOVX    @DPTR,A
   \   000094   8005         SJMP    ??IC_Card_Search_5
    202                                  {
    203                                    if(i%2==0)
   \                     ??IC_Card_Search_6:
   \   000096   E0           MOVX    A,@DPTR
   \   000097   A2E0         MOV     C,0xE0 /* A   */.0
   \   000099   400B         JC      ??IC_Card_Search_7
    204                                    {
    205                                       DataRep((date1[(i/2)]>>4),i,1,0);
   \                     ??IC_Card_Search_5:
   \   00009B                ; Setup parameters for call to function DataRep
   \   00009B   7C00         MOV     R4,#0x0
   \   00009D   7B01         MOV     R3,#0x1
   \   00009F   E0           MOVX    A,@DPTR
   \   0000A0   12....       LCALL   ?Subroutine8 & 0xFFFF
    206                                    }
   \                     ??CrossCallReturnLabel_4:
   \   0000A3   C4           SWAP    A
   \   0000A4   8007         SJMP    ??CrossCallReturnLabel_5
    207                                    else
    208                                    {
    209                                      DataRep((date1[(i/2)]&0x0f),i,0,0);
   \                     ??IC_Card_Search_7:
   \   0000A6                ; Setup parameters for call to function DataRep
   \   0000A6   7C00         MOV     R4,#0x0
   \   0000A8   7B00         MOV     R3,#0x0
   \   0000AA   12....       LCALL   ?Subroutine8 & 0xFFFF
    210                                    }                         
    211                                  }
   \                     ??CrossCallReturnLabel_5:
   \   0000AD   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   0000B0   9420         SUBB    A,#0x20
   \   0000B2   40E2         JC      ??IC_Card_Search_6
    212                                  OLED_P8x16Str(41,2,"0x");
   \   0000B4                ; Setup parameters for call to function OLED_P8x16Str
   \   0000B4   7C..         MOV     R4,#`?<Constant "0x">` & 0xff
   \   0000B6   7D..         MOV     R5,#(`?<Constant "0x">` >> 8) & 0xff
   \   0000B8   7A02         MOV     R2,#0x2
   \   0000BA   7929         MOV     R1,#0x29
   \   0000BC   12....       LCALL   ??OLED_P8x16Str?relay
    213                                  OLED_P8x16Str(58,2,SendData);
   \   0000BF                ; Setup parameters for call to function OLED_P8x16Str
   \   0000BF   7C..         MOV     R4,#SendData & 0xff
   \   0000C1   7D..         MOV     R5,#(SendData >> 8) & 0xff
   \   0000C3   7A02         MOV     R2,#0x2
   \   0000C5   793A         MOV     R1,#0x3a
   \   0000C7   12....       LCALL   ??OLED_P8x16Str?relay
    214                                  OLED_P6x8Str(1,6,"0x");
   \   0000CA                ; Setup parameters for call to function OLED_P6x8Str
   \   0000CA   7C..         MOV     R4,#`?<Constant "0x">` & 0xff
   \   0000CC   7D..         MOV     R5,#(`?<Constant "0x">` >> 8) & 0xff
   \   0000CE   7A06         MOV     R2,#0x6
   \   0000D0   7901         MOV     R1,#0x1
   \   0000D2   12....       LCALL   ??OLED_P6x8Str?relay
    215                                  OLED_P6x8Str(15,6,SendBuf);
   \   0000D5                ; Setup parameters for call to function OLED_P6x8Str
   \   0000D5   7C..         MOV     R4,#SendBuf & 0xff
   \   0000D7   7D..         MOV     R5,#(SendBuf >> 8) & 0xff
   \   0000D9   7A06         MOV     R2,#0x6
   \   0000DB   790F         MOV     R1,#0xf
   \   0000DD   12....       LCALL   ??OLED_P6x8Str?relay
    216                              }
    217                          }
    218                      }
    219                  }
    220              }
    221              
    222              if(ucStatusReturn != MI_OK)//无卡
   \                     ??IC_Card_Search_0:
   \   0000E0   90....       MOV     DPTR,#ucStatusReturn
   \   0000E3   E0           MOVX    A,@DPTR
   \   0000E4   6426         XRL     A,#0x26
   \   0000E6   6005         JZ      ??IC_Card_Search_1
    223              {
    224                  IC_Card_Exist = 0;
   \   0000E8   90....       MOV     DPTR,#IC_Card_Exist
   \   0000EB   E4           CLR     A
   \   0000EC   F0           MOVX    @DPTR,A
    225              }
    226          }
   \                     ??IC_Card_Search_1:
   \   0000ED   02....       LJMP    ??Subroutine29_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   540F         ANL     A,#0xf
   \   000002   F9           MOV     R1,A
   \   000003   12....       LCALL   ??DataRep?relay
   \   000006   90....       MOV     DPTR,#i
   \   000009   E0           MOVX    A,@DPTR
   \   00000A   04           INC     A
   \   00000B   F0           MOVX    @DPTR,A
   \   00000C   C3           CLR     C
   \   00000D   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   FA           MOV     R2,A
   \   000001   C3           CLR     C
   \   000002   13           RRC     A
   \   000003   F8           MOV     R0,A
   \   000004   74..         MOV     A,#date1 & 0xff
   \   000006   28           ADD     A,R0
   \   000007   F582         MOV     DPL,A
   \   000009   74..         MOV     A,#(date1 >> 8) & 0xff
   \   00000B   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_46:
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   FA           MOV     R2,A
   \   000001   C3           CLR     C
   \   000002   13           RRC     A
   \   000003   F8           MOV     R0,A
   \   000004   74..         MOV     A,#ucArray_ID & 0xff
   \   000006   28           ADD     A,R0
   \   000007   F582         MOV     DPL,A
   \   000009   74..         MOV     A,#(ucArray_ID >> 8) & 0xff
   \   00000B   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_45:
   \   00000E   22           RET
    227          //==========================================================
    228          //	函数名称：	IC_Card_Write
    229          //
    230          //	函数功能：	向IC卡里写数据
    231          //
    232          //	入口参数：	无
    233          //
    234          //	返回参数：	无
    235          //
    236          //	说明：		
    237          //==========================================================

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    238          uint8 cStatus;
   \                     cStatus:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    239          uint8 IC_Card_Write(uint8 *p)
   \                     IC_Card_Write:
    240          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    241              if (PcdAnticoll(ucArray_ID) == MI_OK)  //防冲撞（当有多张卡进入读写器操作范围时，防冲突机制会从其中选择一张进行操作）
   \   000009                ; Setup parameters for call to function PcdAnticoll
   \   000009   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   00000C   7036         JNZ     ??CrossCallReturnLabel_25
    242              {               
    243                  if (PcdSelect(ucArray_ID) == MI_OK)//选择ucArray_ID的卡
   \   00000E                ; Setup parameters for call to function PcdSelect
   \   00000E   7A..         MOV     R2,#ucArray_ID & 0xff
   \   000010   7B..         MOV     R3,#(ucArray_ID >> 8) & 0xff
   \   000012   12....       LCALL   ??PcdSelect?relay
   \   000015   E9           MOV     A,R1
   \   000016   6426         XRL     A,#0x26
   \   000018   702A         JNZ     ??CrossCallReturnLabel_25
    244                  {
    245                      if (PcdAuthState(0x61,0x5,pk,ucArray_ID) == MI_OK)//申请对卡的授权  
   \   00001A                ; Setup parameters for call to function PcdAuthState
   \   00001A   75....       MOV     ?V0 + 0,#ucArray_ID & 0xff
   \   00001D   75....       MOV     ?V0 + 1,#(ucArray_ID >> 8) & 0xff
   \   000020   78..         MOV     R0,#?V0 + 0
   \   000022   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000025   7C..         MOV     R4,#pk & 0xff
   \   000027   7D..         MOV     R5,#(pk >> 8) & 0xff
   \   000029   7A05         MOV     R2,#0x5
   \   00002B   7961         MOV     R1,#0x61
   \   00002D   12....       LCALL   ??PcdAuthState?relay
   \   000030   7402         MOV     A,#0x2
   \   000032   12....       LCALL   ?DEALLOC_XSTACK8
   \   000035   E9           MOV     A,R1
   \   000036   6426         XRL     A,#0x26
   \   000038   700A         JNZ     ??CrossCallReturnLabel_25
    246                      {
    247                          cStatus = PcdWrite(0x5,p);
   \   00003A                ; Setup parameters for call to function PcdWrite
   \   00003A   12....       LCALL   ?Subroutine18 & 0xFFFF
    248                          if(cStatus == MI_ERR)
   \                     ??CrossCallReturnLabel_24:
   \   00003D   64BB         XRL     A,#0xbb
   \   00003F   7003         JNZ     ??CrossCallReturnLabel_25
    249                          {//如果写失败在写一次
    250                              cStatus = PcdWrite(0x5,p);
   \   000041                ; Setup parameters for call to function PcdWrite
   \   000041   12....       LCALL   ?Subroutine18 & 0xFFFF
    251                          }
    252                      }
    253                  }
    254              }
    255              return cStatus;
   \                     ??CrossCallReturnLabel_25:
   \   000044   90....       MOV     DPTR,#cStatus
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F9           MOV     R1,A
   \   000049   02....       LJMP    ??Subroutine29_0 & 0xFFFF
    256          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   EE           MOV     A,R6
   \   000001   FA           MOV     R2,A
   \   000002   EF           MOV     A,R7
   \   000003   FB           MOV     R3,A
   \   000004   7905         MOV     R1,#0x5
   \   000006   12....       LCALL   ??PcdWrite?relay
   \   000009   E9           MOV     A,R1
   \   00000A   90....       MOV     DPTR,#cStatus
   \   00000D   F0           MOVX    @DPTR,A
   \   00000E   22           RET
    257          //==========================================================
    258          //	函数名称：	IC_Card_Read
    259          //
    260          //	函数功能：	从IC卡里计出数据
    261          //
    262          //	入口参数：	无
    263          //
    264          //	返回参数：	无
    265          //
    266          //	说明：		
    267          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    268          void IC_Card_Read(uint8 *p)
   \                     IC_Card_Read:
    269          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    270               PcdRead(0X5,p);
   \   000004                ; Setup parameters for call to function PcdRead
   \   000004   7905         MOV     R1,#0x5
   \   000006   12....       LCALL   ??PcdRead?relay
    271          }
   \   000009   02....       LJMP    ?Subroutine0 & 0xFFFF
    272          //==========================================================
    273          //	函数名称：	RC522_SPI_Config
    274          //
    275          //	函数功能：	RC522 SPI初始化
    276          //
    277          //	入口参数：	无
    278          //
    279          //	返回参数：	无
    280          //
    281          //	说明：		
    282          //==========================================================
    283          static void RC522_SPI_Config ( void )
    284          {     
    285            P1SEL &= ~0xF2;     //设置P1.1、P1.4、P1.5、P1.6、P1.7为普通IO口  
    286            P1DIR |= 0x72;      //P1.1、P1.4、P1.5、P1.6定义为输出   
    287            
    288            P1DIR &= ~0x80;     //按键接在P1.7口上，设P1.7为输入模式 
    289            P1INP &= ~0x80;     //打开P1.7上拉电阻
    290          }
    291          
    292          //==========================================================
    293          //	函数名称：	SPI_RC522_SendByte
    294          //
    295          //	函数功能：	向RC522发送1 Byte 数据
    296          //
    297          //	入口参数：	byte，要发送的数据
    298          //
    299          //	返回参数：	RC522返回的数据
    300          //
    301          //	说明：		
    302          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    303          void SPI_RC522_SendByte ( unsigned char byte )
   \                     SPI_RC522_SendByte:
    304          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
    305              unsigned char counter;
    306          		
    307              for(counter=0;counter<8;counter++)
   \   000007   7E08         MOV     R6,#0x8
    308              {     
    309                  if ( byte & 0x80 )
   \                     ??SPI_RC522_SendByte_0:
   \   000009   EF           MOV     A,R7
   \   00000A   A2E7         MOV     C,0xE0 /* A   */.7
   \   00000C   5006         JNC     ??SPI_RC522_SendByte_1
    310                  {
    311                    macRC522_MOSI_1 ();
   \   00000E   D296         SETB    0x90.6
   \   000010   D296         SETB    0x90.6
   \   000012   8004         SJMP    ??SPI_RC522_SendByte_2
    312                  }		    
    313                  else
    314                  {
    315                    macRC522_MOSI_0 ();
   \                     ??SPI_RC522_SendByte_1:
   \   000014   C296         CLR     0x90.6
   \   000016   C296         CLR     0x90.6
    316                  }		    
    317          
    318          //			Delay_us ( 3 );
    319                  macRC522_DELAY();
   \                     ??SPI_RC522_SendByte_2:
   \   000018                ; Setup parameters for call to function delay_us
   \   000018   90....       MOV     DPTR,#__Constant_c8
   \   00001B   12....       LCALL   ?XLOAD_R2345
   \   00001E   12....       LCALL   ??delay_us?relay
    320          
    321                  macRC522_SCK_0 ();
   \   000021   C295         CLR     0x90.5
   \   000023   C295         CLR     0x90.5
    322          
    323          //			Delay_us ( 1 );
    324          //			Delay_us ( 3 );
    325                  macRC522_DELAY();
   \   000025                ; Setup parameters for call to function delay_us
   \   000025   90....       MOV     DPTR,#__Constant_c8
   \   000028   12....       LCALL   ?XLOAD_R2345
   \   00002B   12....       LCALL   ?Subroutine21 & 0xFFFF
    326                   
    327                  macRC522_SCK_1();
    328          
    329          //			Delay_us ( 3 );
    330                  macRC522_DELAY();
   \                     ??CrossCallReturnLabel_30:
   \   00002E   12....       LCALL   ?XLOAD_R2345
   \   000031   12....       LCALL   ??delay_us?relay
    331                   
    332                  byte <<= 1; 
   \   000034   EF           MOV     A,R7
   \   000035   C3           CLR     C
   \   000036   33           RLC     A
   \   000037   FF           MOV     R7,A
    333          			
    334              } 
   \   000038   1E           DEC     R6
   \   000039   EE           MOV     A,R6
   \   00003A   70CD         JNZ     ??SPI_RC522_SendByte_0
    335          }
   \   00003C   80..         SJMP    ??Subroutine30_0
   \   00003E                REQUIRE _A_P1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   12....       LCALL   ??delay_us?relay
   \   000003   D295         SETB    0x90.5
   \   000005   D295         SETB    0x90.5
   \   000007                ; Setup parameters for call to function delay_us
   \   000007                ; Setup parameters for call to function delay_us
   \   000007   90....       MOV     DPTR,#__Constant_c8
   \   00000A   22           RET
    336          
    337          //==========================================================
    338          //	函数名称：	SPI_RC522_ReadByte
    339          //
    340          //	函数功能：	从RC522发送1 Byte 数据
    341          //
    342          //	入口参数：	无
    343          //
    344          //	返回参数：	RC522返回的数据
    345          //
    346          //	说明：		
    347          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    348          unsigned char SPI_RC522_ReadByte ( void )
   \                     SPI_RC522_ReadByte:
    349          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    350          	unsigned char counter;
    351          	unsigned char SPI_Data;
    352          
    353          
    354          	for(counter=0;counter<8;counter++)
   \   000005   7F08         MOV     R7,#0x8
    355          	{
    356                      SPI_Data <<= 1;
   \                     ??SPI_RC522_ReadByte_0:
   \   000007   EE           MOV     A,R6
   \   000008   C3           CLR     C
   \   000009   33           RLC     A
   \   00000A   FE           MOV     R6,A
    357          
    358                      macRC522_SCK_0 ();
   \   00000B   C295         CLR     0x90.5
   \   00000D   C295         CLR     0x90.5
    359          
    360          //			Delay_us ( 3 );
    361                      macRC522_DELAY();
   \   00000F                ; Setup parameters for call to function delay_us
   \   00000F   90....       MOV     DPTR,#__Constant_c8
   \   000012   12....       LCALL   ?XLOAD_R2345
   \   000015   12....       LCALL   ??delay_us?relay
    362              
    363                      if ( macRC522_MISO_GET() == 1)
   \   000018   A297         MOV     C,0x90.7
   \   00001A   5004         JNC     ??SPI_RC522_ReadByte_1
    364                         SPI_Data |= 0x01;
   \   00001C   EE           MOV     A,R6
   \   00001D   D2E0         SETB    0xE0 /* A   */.0
   \   00001F   FE           MOV     R6,A
    365          
    366          //			Delay_us ( 2 );
    367          //			Delay_us ( 3 );
    368                      macRC522_DELAY();
   \                     ??SPI_RC522_ReadByte_1:
   \   000020                ; Setup parameters for call to function delay_us
   \   000020   90....       MOV     DPTR,#__Constant_c8
   \   000023   12....       LCALL   ?XLOAD_R2345
   \   000026   12....       LCALL   ?Subroutine21 & 0xFFFF
    369          
    370                      macRC522_SCK_1 ();
    371          
    372          //			Delay_us ( 3 );
    373                      macRC522_DELAY();
    374          			
    375          	}
   \                     ??CrossCallReturnLabel_31:
   \   000029   12....       LCALL   ?XLOAD_R2345
   \   00002C   12....       LCALL   ??delay_us?relay
   \   00002F   1F           DEC     R7
   \   000030   EF           MOV     A,R7
   \   000031   70D4         JNZ     ??SPI_RC522_ReadByte_0
    376          	
    377          	return SPI_Data;
   \   000033   EE           MOV     A,R6
   \   000034   F9           MOV     R1,A
   \   000035   80..         SJMP    ??Subroutine30_0
   \   000037                REQUIRE _A_P1
    378          	
    379          }
    380          
    381          //==========================================================
    382          //	函数名称：	ReadRawRC
    383          //
    384          //	函数功能：	读RC522寄存器
    385          //
    386          //	入口参数：	ucAddress，寄存器地址
    387          //
    388          //	返回参数：	寄存器的当前值
    389          //
    390          //	说明：		
    391          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    392          unsigned char ReadRawRC ( unsigned char ucAddress )
   \                     ReadRawRC:
    393          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    394                unsigned char ucAddr, ucReturn;
    395                
    396                ucAddr = ( ( ucAddress << 1 ) & 0x7E ) | 0x80;
    397                
    398                macRC522_CS_Enable();
   \   000006   C294         CLR     0x90.4
   \   000008   C294         CLR     0x90.4
    399                
    400                SPI_RC522_SendByte ( ucAddr );
   \   00000A                ; Setup parameters for call to function SPI_RC522_SendByte
   \   00000A   C3           CLR     C
   \   00000B   33           RLC     A
   \   00000C   4480         ORL     A,#0x80
   \   00000E   F9           MOV     R1,A
   \   00000F   12....       LCALL   ??SPI_RC522_SendByte?relay
    401                
    402                ucReturn = SPI_RC522_ReadByte ();
   \   000012                ; Setup parameters for call to function SPI_RC522_ReadByte
   \   000012   12....       LCALL   ??SPI_RC522_ReadByte?relay
    403                
    404                macRC522_CS_Disable();
   \   000015                REQUIRE ?Subroutine5
   \   000015                REQUIRE _A_P1
   \   000015                ; // Fall through to label ?Subroutine5
    405                
    406                return ucReturn;
    407          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   D294         SETB    0x90.4
   \   000002   D294         SETB    0x90.4
   \   000004   80..         SJMP    ??Subroutine30_0
    408          //==========================================================
    409          //	函数名称：	WriteRawRC
    410          //
    411          //	函数功能：	写RC522寄存器
    412          //
    413          //	入口参数：	ucAddress，寄存器地址
    414          //              ucValue，写入寄存器的值
    415          //
    416          //	返回参数：	无
    417          //
    418          //	说明：		
    419          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    420          void WriteRawRC ( unsigned char ucAddress, unsigned char ucValue )
   \                     WriteRawRC:
    421          {  
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
    422          	unsigned char ucAddr;
    423          	
    424          	ucAddr = ( ucAddress << 1 ) & 0x7E;
    425          	
    426          	macRC522_CS_Enable();
   \   000009   C294         CLR     0x90.4
   \   00000B   C294         CLR     0x90.4
    427          	
    428          	SPI_RC522_SendByte ( ucAddr );
   \   00000D                ; Setup parameters for call to function SPI_RC522_SendByte
   \   00000D   EF           MOV     A,R7
   \   00000E   C3           CLR     C
   \   00000F   33           RLC     A
   \   000010   547E         ANL     A,#0x7e
   \   000012   F9           MOV     R1,A
   \   000013   12....       LCALL   ??SPI_RC522_SendByte?relay
    429          	
    430          	SPI_RC522_SendByte ( ucValue );
   \   000016                ; Setup parameters for call to function SPI_RC522_SendByte
   \   000016   EE           MOV     A,R6
   \   000017   F9           MOV     R1,A
   \   000018   12....       LCALL   ??SPI_RC522_SendByte?relay
    431          	
    432          	macRC522_CS_Disable();	
   \   00001B   80..         SJMP    ?Subroutine5
   \   00001D                REQUIRE _A_P1
    433          
    434          }
    435          //==========================================================
    436          //	函数名称：	SetBitMask
    437          //
    438          //	函数功能：	对RC522寄存器置位
    439          //
    440          //	入口参数：	ucReg，寄存器地址
    441          //              ucMask，置位值
    442          //
    443          //	返回参数：	无
    444          //
    445          //	说明：		
    446          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   FA           MOV     R2,A
   \   000001   EE           MOV     A,R6
   \   000002   F9           MOV     R1,A
   \   000003   12....       LCALL   ??WriteRawRC?relay
   \   000006                REQUIRE ??Subroutine30_0
   \   000006                ; // Fall through to label ??Subroutine30_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    447          void SetBitMask ( unsigned char ucReg, unsigned char ucMask )  
   \                     SetBitMask:
    448          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   \   000008   12....       LCALL   ?Subroutine23 & 0xFFFF
    449              unsigned char ucTemp;
    450          	
    451              ucTemp = ReadRawRC ( ucReg );
    452          	
    453              WriteRawRC ( ucReg, ucTemp | ucMask );         // set bit mask
   \                     ??CrossCallReturnLabel_49:
   \   00000B   4F           ORL     A,R7
   \   00000C   80..         SJMP    ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   FF           MOV     R7,A
   \   000001                ; Setup parameters for call to function WriteRawRC
   \   000001                ; Setup parameters for call to function ReadRawRC
   \   000001                ; Setup parameters for call to function ReadRawRC
   \   000001                REQUIRE ??Subroutine32_0
   \   000001                ; // Fall through to label ??Subroutine32_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine32_0:
   \   000000   12....       LCALL   ??ReadRawRC?relay
   \   000003   E9           MOV     A,R1
   \   000004   22           RET
    454          }
    455          
    456          //==========================================================
    457          //	函数名称：	ClearBitMask
    458          //
    459          //	函数功能：	对RC522寄存器清位
    460          //
    461          //	入口参数：	ucReg，寄存器地址
    462          //              ucMask，清位值
    463          //
    464          //	返回参数：	无
    465          //
    466          //	说明：		
    467          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    468          void ClearBitMask ( unsigned char ucReg, unsigned char ucMask )  
   \                     ClearBitMask:
    469          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    470              unsigned char ucTemp;
    471          		
    472              ucTemp = ReadRawRC ( ucReg );
    473          	
    474              WriteRawRC ( ucReg, ucTemp & ( ~ ucMask) );  // clear bit mask
   \   000007                ; Setup parameters for call to function WriteRawRC
   \   000007   EA           MOV     A,R2
   \   000008   F4           CPL     A
   \   000009   12....       LCALL   ?Subroutine23 & 0xFFFF
   \                     ??CrossCallReturnLabel_50:
   \   00000C   5F           ANL     A,R7
   \   00000D   80..         SJMP    ?Subroutine1
    475          }
    476          
    477          //==========================================================
    478          //	函数名称：	PcdAntennaOn
    479          //
    480          //	函数功能：	开启天线 
    481          //
    482          //	入口参数：	无
    483          //
    484          //	返回参数：	无
    485          //
    486          //	说明：		
    487          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    488          void PcdAntennaOn ( void )
   \                     PcdAntennaOn:
    489          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    490              unsigned char uc;
    491          	
    492              uc = ReadRawRC ( TxControlReg );
    493          	
    494              if ( ! ( uc & 0x03 ) )
   \   000004                ; Setup parameters for call to function ReadRawRC
   \   000004   7914         MOV     R1,#0x14
   \   000006   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_51:
   \   000009   5403         ANL     A,#0x3
   \   00000B   7007         JNZ     ??PcdAntennaOn_0
    495          	SetBitMask(TxControlReg, 0x03);	
   \   00000D                ; Setup parameters for call to function SetBitMask
   \   00000D   7A03         MOV     R2,#0x3
   \   00000F   7914         MOV     R1,#0x14
   \   000011   12....       LCALL   ??SetBitMask?relay
    496          }
   \                     ??PcdAntennaOn_0:
   \   000014                REQUIRE ?Subroutine0
   \   000014                ; // Fall through to label ?Subroutine0
    497          
    498          //==========================================================
    499          //	函数名称：	PcdAntennaOff
    500          //
    501          //	函数功能：	关闭天线
    502          //
    503          //	入口参数：	无
    504          //
    505          //	返回参数：	无
    506          //
    507          //	说明：		
    508          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    509          void PcdAntennaOff ( void )
   \                     PcdAntennaOff:
    510          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    511            ClearBitMask ( TxControlReg, 0x03 );
   \   000004                ; Setup parameters for call to function ClearBitMask
   \   000004   7A03         MOV     R2,#0x3
   \   000006   7914         MOV     R1,#0x14
   \   000008   12....       LCALL   ??ClearBitMask?relay
    512          }
   \   00000B   80..         SJMP    ?Subroutine0
    513          
    514          //==========================================================
    515          //	函数名称：	RC522_InitStatus
    516          //
    517          //	函数功能：	获取RC522是否正常复位
    518          //
    519          //	入口参数：	无
    520          //
    521          //	返回参数：	无
    522          //
    523          //	说明：		
    524          //==========================================================

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    525          uint8 InitStatus = 0;
   \                     InitStatus:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    526          uint8 RC522_InitStatus(void) 
   \                     RC522_InitStatus:
    527          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    528            return InitStatus;
   \   000004   90....       MOV     DPTR,#InitStatus
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F9           MOV     R1,A
   \   000009   80..         SJMP    ?Subroutine0
    529          }
    530          //==========================================================
    531          //	函数名称：	PcdReset
    532          //
    533          //	函数功能：	复位RC522 
    534          //
    535          //	入口参数：	无
    536          //
    537          //	返回参数：	无
    538          //
    539          //	说明：		
    540          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    541          uint8  PcdReset ( void )
   \                     PcdReset:
    542          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    543                  uint8 count=0;
    544          	macRC522_Reset_Disable();
   \   000005   D291         SETB    0x90.1
   \   000007   D291         SETB    0x90.1
    545          	
    546          	delay_us ( 1 );
   \   000009                ; Setup parameters for call to function delay_us
   \   000009   90....       MOV     DPTR,#__Constant_1
   \   00000C   12....       LCALL   ?XLOAD_R2345
   \   00000F   12....       LCALL   ??delay_us?relay
    547          	
    548          	macRC522_Reset_Enable();
   \   000012   C291         CLR     0x90.1
   \   000014   C291         CLR     0x90.1
    549          	
    550          	delay_us ( 1 );
   \   000016                ; Setup parameters for call to function delay_us
   \   000016   90....       MOV     DPTR,#__Constant_1
   \   000019   12....       LCALL   ?XLOAD_R2345
   \   00001C   12....       LCALL   ??delay_us?relay
    551          	
    552          	macRC522_Reset_Disable();
   \   00001F   D291         SETB    0x90.1
   \   000021   D291         SETB    0x90.1
    553          	
    554          	delay_us ( 1 );
   \   000023                ; Setup parameters for call to function delay_us
   \   000023   90....       MOV     DPTR,#__Constant_1
   \   000026   12....       LCALL   ?XLOAD_R2345
   \   000029   12....       LCALL   ??delay_us?relay
    555          	
    556          	WriteRawRC ( CommandReg, 0x0f );
   \   00002C                ; Setup parameters for call to function WriteRawRC
   \   00002C   7A0F         MOV     R2,#0xf
   \   00002E   7901         MOV     R1,#0x1
   \   000030   12....       LCALL   ??WriteRawRC?relay
   \   000033   7E06         MOV     R6,#0x6
   \   000035   8009         SJMP    ??PcdReset_0
    557          	
    558          	while ( (ReadRawRC ( CommandReg ) & 0x10 ))
    559                  {
    560                    if((++count) < 6)
    561                    {
    562                      delay_ms(100);
   \                     ??PcdReset_1:
   \   000037                ; Setup parameters for call to function delay_ms
   \   000037   90....       MOV     DPTR,#__Constant_64
   \   00003A   12....       LCALL   ?XLOAD_R2345
   \   00003D   12....       LCALL   ??delay_ms?relay
    563                    }
   \                     ??PcdReset_0:
   \   000040                ; Setup parameters for call to function ReadRawRC
   \   000040   7901         MOV     R1,#0x1
   \   000042   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_52:
   \   000045   A2E4         MOV     C,0xE0 /* A   */.4
   \   000047   5004         JNC     ??PcdReset_2
   \   000049   1E           DEC     R6
   \   00004A   EE           MOV     A,R6
   \   00004B   70EA         JNZ     ??PcdReset_1
    564                    else
    565                    {
    566                      break;
    567                    }
    568                  }
    569                  delay_us ( 1 );
   \                     ??PcdReset_2:
   \   00004D                ; Setup parameters for call to function delay_us
   \   00004D   90....       MOV     DPTR,#__Constant_1
   \   000050   12....       LCALL   ?XLOAD_R2345
   \   000053   12....       LCALL   ??delay_us?relay
    570                  
    571                  WriteRawRC ( ModeReg, 0x3D );           //定义发送和接收常用模式 和Mifare卡通讯，CRC初始值0x6363
   \   000056                ; Setup parameters for call to function WriteRawRC
   \   000056   7A3D         MOV     R2,#0x3d
   \   000058   7911         MOV     R1,#0x11
   \   00005A   12....       LCALL   ?Subroutine19 & 0xFFFF
    572                  
    573                  WriteRawRC ( TReloadRegL, 30 );         //16位定时器低位    
    574                  WriteRawRC ( TReloadRegH, 0 );	        //16位定时器高位
    575                  
    576                  WriteRawRC ( TModeReg, 0x8D );	        //定义内部定时器的设置
    577                  
    578                  WriteRawRC ( TPrescalerReg, 0x3E );	//设置定时器分频系数
    579                  
    580                  WriteRawRC ( TxAutoReg, 0x40 );	        //调制发送信号为100%ASK	
   \                     ??CrossCallReturnLabel_26:
   \   00005D                ; Setup parameters for call to function WriteRawRC
   \   00005D   7A40         MOV     R2,#0x40
   \   00005F   7915         MOV     R1,#0x15
   \   000061   12....       LCALL   ??WriteRawRC?relay
    581                  InitStatus = 1;
   \   000064   90....       MOV     DPTR,#InitStatus
   \   000067   7401         MOV     A,#0x1
   \   000069   F0           MOVX    @DPTR,A
    582                  delay_us ( 100 ); 
   \   00006A                ; Setup parameters for call to function delay_us
   \   00006A   90....       MOV     DPTR,#__Constant_64
   \   00006D   12....       LCALL   ?XLOAD_R2345
   \   000070   12....       LCALL   ??delay_us?relay
    583                  return InitStatus;
   \   000073   90....       MOV     DPTR,#InitStatus
   \   000076   E0           MOVX    A,@DPTR
   \   000077   F9           MOV     R1,A
   \   000078   02....       LJMP    ??Subroutine30_0 & 0xFFFF
   \   00007B                REQUIRE _A_P1
    584          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   12....       LCALL   ??WriteRawRC?relay
   \   000003                ; Setup parameters for call to function WriteRawRC
   \   000003                ; Setup parameters for call to function WriteRawRC
   \   000003   7A1E         MOV     R2,#0x1e
   \   000005   792D         MOV     R1,#0x2d
   \   000007   12....       LCALL   ??WriteRawRC?relay
   \   00000A                ; Setup parameters for call to function WriteRawRC
   \   00000A                ; Setup parameters for call to function WriteRawRC
   \   00000A   7A00         MOV     R2,#0x0
   \   00000C   792C         MOV     R1,#0x2c
   \   00000E   12....       LCALL   ??WriteRawRC?relay
   \   000011                ; Setup parameters for call to function WriteRawRC
   \   000011                ; Setup parameters for call to function WriteRawRC
   \   000011   7A8D         MOV     R2,#-0x73
   \   000013   792A         MOV     R1,#0x2a
   \   000015   12....       LCALL   ??WriteRawRC?relay
   \   000018                ; Setup parameters for call to function WriteRawRC
   \   000018                ; Setup parameters for call to function WriteRawRC
   \   000018   7A3E         MOV     R2,#0x3e
   \   00001A   792B         MOV     R1,#0x2b
   \   00001C   12....       LCALL   ??WriteRawRC?relay
   \   00001F   22           RET
    585          
    586          //==========================================================
    587          //	函数名称：	M500PcdConfigISOType
    588          //
    589          //	函数功能：	设置RC522的工作方式
    590          //
    591          //	入口参数：	ucType，工作方式
    592          //
    593          //	返回参数：	无
    594          //
    595          //	说明：		
    596          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    597          void M500PcdConfigISOType ( unsigned char ucType )
   \                     M500PcdConfigISOType:
    598          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    599            if ( ucType == 'A')                     //ISO14443_A
   \   000007   7441         MOV     A,#0x41
   \   000009   6E           XRL     A,R6
   \   00000A   7028         JNZ     ??M500PcdConfigISOType_0
    600            {
    601                  ClearBitMask ( Status2Reg, 0x08 );
   \   00000C                ; Setup parameters for call to function ClearBitMask
   \   00000C   7A08         MOV     R2,#0x8
   \   00000E   7908         MOV     R1,#0x8
   \   000010   12....       LCALL   ??ClearBitMask?relay
    602          
    603                  WriteRawRC ( ModeReg, 0x3D );//3F
   \   000013                ; Setup parameters for call to function WriteRawRC
   \   000013   7A3D         MOV     R2,#0x3d
   \   000015   7911         MOV     R1,#0x11
   \   000017   12....       LCALL   ??WriteRawRC?relay
    604          
    605                  WriteRawRC ( RxSelReg, 0x86 );//84
   \   00001A                ; Setup parameters for call to function WriteRawRC
   \   00001A   7A86         MOV     R2,#-0x7a
   \   00001C   7917         MOV     R1,#0x17
   \   00001E   12....       LCALL   ??WriteRawRC?relay
    606          
    607                  WriteRawRC( RFCfgReg, 0x7F );   //4F
   \   000021                ; Setup parameters for call to function WriteRawRC
   \   000021   7A7F         MOV     R2,#0x7f
   \   000023   7926         MOV     R1,#0x26
   \   000025   12....       LCALL   ?Subroutine19 & 0xFFFF
    608          
    609                  WriteRawRC( TReloadRegL, 30 );//tmoLength);// TReloadVal = 'h6a =tmoLength(dec) 
    610          
    611                  WriteRawRC ( TReloadRegH, 0 );
    612          
    613                  WriteRawRC ( TModeReg, 0x8D );
    614          
    615                  WriteRawRC ( TPrescalerReg, 0x3E );
    616          
    617                  delay_us ( 2 );
   \                     ??CrossCallReturnLabel_27:
   \   000028                ; Setup parameters for call to function delay_us
   \   000028   90....       MOV     DPTR,#__Constant_2
   \   00002B   12....       LCALL   ?XLOAD_R2345
   \   00002E   12....       LCALL   ??delay_us?relay
    618          
    619                  PcdAntennaOn ();//开天线	
   \   000031                ; Setup parameters for call to function PcdAntennaOn
   \   000031   12....       LCALL   ??PcdAntennaOn?relay
    620             } 
    621          }
   \                     ??M500PcdConfigISOType_0:
   \   000034   02....       LJMP    ??Subroutine30_0 & 0xFFFF
    622          
    623          //==========================================================
    624          //	函数名称：	PcdComMF522
    625          //
    626          //	函数功能：	通过RC522和ISO14443卡通讯
    627          //
    628          //	入口参数：	ucCommand，RC522命令字
    629          //              pInData，通过RC522发送到卡片的数据
    630          //              ucInLenByte，发送数据的字节长度
    631          //              pOutData，接收到的卡片返回数据
    632          //              pOutLenBit，返回数据的位长度
    633          //
    634          //	返回参数：	状态值 = MI_OK，成功
    635          //
    636          //	说明：		
    637          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    638          char PcdComMF522 ( unsigned char ucCommand, unsigned char * pInData, unsigned char ucInLenByte, unsigned char * pOutData, int * pOutLenBit )		
   \                     PcdComMF522:
    639          {
   \   000000   74EA         MOV     A,#-0x16
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 22
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   8A..         MOV     ?V0 + 10,R2
   \   000009   8B..         MOV     ?V0 + 11,R3
   \   00000B   8C..         MOV     ?V0 + 4,R4
   \   00000D   7416         MOV     A,#0x16
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   E0           MOVX    A,@DPTR
   \   000013   F5..         MOV     ?V0 + 12,A
   \   000015   A3           INC     DPTR
   \   000016   E0           MOVX    A,@DPTR
   \   000017   F5..         MOV     ?V0 + 13,A
   \   000019   7418         MOV     A,#0x18
   \   00001B   12....       LCALL   ?XSTACK_DISP0_8
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F5..         MOV     ?V0 + 0,A
   \   000021   A3           INC     DPTR
   \   000022   E0           MOVX    A,@DPTR
   \   000023   F5..         MOV     ?V0 + 1,A
    640              char cStatus = MI_ERR;
   \   000025   75..BB       MOV     ?V0 + 3,#-0x45
    641              unsigned char ucIrqEn   = 0x00;
   \   000028   75..00       MOV     ?V0 + 5,#0x0
    642              unsigned char ucWaitFor = 0x00;
   \   00002B   75..00       MOV     ?V0 + 6,#0x0
    643              unsigned char ucLastBits;
    644              unsigned char ucN;
    645              int ul;
    646          	
    647          	
    648              switch ( ucCommand )
   \   00002E   E9           MOV     A,R1
   \   00002F   24F4         ADD     A,#-0xc
   \   000031   600C         JZ      ??PcdComMF522_0
   \   000033   24FE         ADD     A,#-0x2
   \   000035   700E         JNZ     ??PcdComMF522_1
    649              {
    650                 case PCD_AUTHENT:		//Mifare认证
    651                    ucIrqEn   = 0x12;		//允许错误中断请求ErrIEn  允许空闲中断IdleIEn
   \   000037   75..12       MOV     ?V0 + 5,#0x12
    652                    ucWaitFor = 0x10;		//认证寻卡等待时候 查询空闲中断标志位
   \   00003A   75..10       MOV     ?V0 + 6,#0x10
    653                    break;
   \   00003D   8006         SJMP    ??PcdComMF522_1
    654          			 
    655                 case PCD_TRANSCEIVE:		//接收发送 发送接收
    656                    ucIrqEn   = 0x77;		//允许TxIEn RxIEn IdleIEn LoAlertIEn ErrIEn TimerIEn
   \                     ??PcdComMF522_0:
   \   00003F   75..77       MOV     ?V0 + 5,#0x77
    657                    ucWaitFor = 0x30;		//寻卡等待时候 查询接收中断标志位与 空闲中断标志位
   \   000042   75..30       MOV     ?V0 + 6,#0x30
    658                    break;
    659          			 
    660                 default:
    661                   break;
    662          			 
    663              }
    664             
    665              WriteRawRC ( ComIEnReg, ucIrqEn | 0x80 );		//IRqInv置位管脚IRQ与Status1Reg的IRq位的值相反 
   \                     ??PcdComMF522_1:
   \   000045                ; Setup parameters for call to function WriteRawRC
   \   000045   7480         MOV     A,#-0x80
   \   000047   45..         ORL     A,?V0 + 5
   \   000049   FA           MOV     R2,A
   \   00004A   7902         MOV     R1,#0x2
   \   00004C   12....       LCALL   ??WriteRawRC?relay
    666              ClearBitMask ( ComIrqReg, 0x80 );			//Set1该位清零时，CommIRqReg的屏蔽位清零
   \   00004F                ; Setup parameters for call to function ClearBitMask
   \   00004F   7A80         MOV     R2,#-0x80
   \   000051   7904         MOV     R1,#0x4
   \   000053   12....       LCALL   ?Subroutine20 & 0xFFFF
    667              WriteRawRC ( CommandReg, PCD_IDLE );		//写空闲命令
    668              SetBitMask ( FIFOLevelReg, 0x80 );			//置位FlushBuffer清除内部FIFO的读和写指针以及ErrReg的BufferOvfl标志位被清除
    669              
    670              for ( ul = 0; ul < ucInLenByte; ul ++ )
   \                     ??CrossCallReturnLabel_28:
   \   000056   7E00         MOV     R6,#0x0
   \   000058   7F00         MOV     R7,#0x0
   \   00005A   8019         SJMP    ??PcdComMF522_2
    671          		  WriteRawRC ( FIFODataReg, pInData [ ul ] );    		//写数据进FIFOdata
   \                     ??PcdComMF522_3:
   \   00005C                ; Setup parameters for call to function WriteRawRC
   \   00005C   E5..         MOV     A,?V0 + 10
   \   00005E   2E           ADD     A,R6
   \   00005F   F582         MOV     DPL,A
   \   000061   E5..         MOV     A,?V0 + 11
   \   000063   3F           ADDC    A,R7
   \   000064   F583         MOV     DPH,A
   \   000066   E0           MOVX    A,@DPTR
   \   000067   FA           MOV     R2,A
   \   000068   7909         MOV     R1,#0x9
   \   00006A   12....       LCALL   ??WriteRawRC?relay
   \   00006D   EE           MOV     A,R6
   \   00006E   2401         ADD     A,#0x1
   \   000070   0E           INC     R6
   \   000071   EF           MOV     A,R7
   \   000072   3400         ADDC    A,#0x0
   \   000074   FF           MOV     R7,A
   \                     ??PcdComMF522_2:
   \   000075   85....       MOV     ?V0 + 8,?V0 + 4
   \   000078   C3           CLR     C
   \   000079   EE           MOV     A,R6
   \   00007A   95..         SUBB    A,?V0 + 8
   \   00007C   EF           MOV     A,R7
   \   00007D   9400         SUBB    A,#0x0
   \   00007F   A2D2         MOV     C,0xD0 /* PSW */.2
   \   000081   65D0         XRL     A,PSW
   \   000083   33           RLC     A
   \   000084   40D6         JC      ??PcdComMF522_3
    672          			
    673              WriteRawRC ( CommandReg, ucCommand );					//写命令
   \   000086                ; Setup parameters for call to function WriteRawRC
   \   000086   AA..         MOV     R2,?V0 + 2
   \   000088   7901         MOV     R1,#0x1
   \   00008A   12....       LCALL   ??WriteRawRC?relay
    674             
    675              
    676              if ( ucCommand == PCD_TRANSCEIVE )
   \   00008D   740C         MOV     A,#0xc
   \   00008F   65..         XRL     A,?V0 + 2
   \   000091   7007         JNZ     ??PcdComMF522_4
    677          			SetBitMask(BitFramingReg,0x80);  				//StartSend置位启动数据发送 该位与收发命令使用时才有效
   \   000093                ; Setup parameters for call to function SetBitMask
   \   000093   7A80         MOV     R2,#-0x80
   \   000095   790D         MOV     R1,#0xd
   \   000097   12....       LCALL   ??SetBitMask?relay
    678              
    679              ul = 1000;//根据时钟频率调整，操作M1卡最大等待时间25ms
   \                     ??PcdComMF522_4:
   \   00009A   7EE8         MOV     R6,#-0x18
   \   00009C   7F03         MOV     R7,#0x3
    680          		
    681              do 														//认证 与寻卡等待时间	
    682              {
    683                   ucN = ReadRawRC ( ComIrqReg );							//查询事件中断
   \                     ??PcdComMF522_5:
   \   00009E                ; Setup parameters for call to function ReadRawRC
   \   00009E   7904         MOV     R1,#0x4
   \   0000A0   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_53:
   \   0000A3   F5..         MOV     ?V0 + 8,A
    684                   ul --;
    685              } while ( ( ul != 0 ) && ( ! ( ucN & 0x01 ) ) && ( ! ( ucN & ucWaitFor ) ) );		//退出条件i=0,定时器中断，与写空闲命令
   \   0000A5   EE           MOV     A,R6
   \   0000A6   24FF         ADD     A,#-0x1
   \   0000A8   1E           DEC     R6
   \   0000A9   EF           MOV     A,R7
   \   0000AA   34FF         ADDC    A,#-0x1
   \   0000AC   FF           MOV     R7,A
   \   0000AD   EE           MOV     A,R6
   \   0000AE   4F           ORL     A,R7
   \   0000AF   6009         JZ      ??PcdComMF522_6
   \   0000B1   E9           MOV     A,R1
   \   0000B2   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000B4   4004         JC      ??PcdComMF522_6
   \   0000B6   55..         ANL     A,?V0 + 6
   \   0000B8   60E4         JZ      ??PcdComMF522_5
    686          		
    687              ClearBitMask ( BitFramingReg, 0x80 );					//清理允许StartSend位
   \                     ??PcdComMF522_6:
   \   0000BA                ; Setup parameters for call to function ClearBitMask
   \   0000BA   7A80         MOV     R2,#-0x80
   \   0000BC   790D         MOV     R1,#0xd
   \   0000BE   12....       LCALL   ??ClearBitMask?relay
    688          		
    689              if ( ul != 0 )
   \   0000C1   EE           MOV     A,R6
   \   0000C2   4F           ORL     A,R7
   \   0000C3   7003         JNZ     $+5
   \   0000C5   02....       LJMP    ??PcdComMF522_7 & 0xFFFF
    690              {
    691                if ( ! ( ReadRawRC ( ErrorReg ) & 0x1B ) )			//读错误标志寄存器BufferOfI CollErr ParityErr ProtocolErr
   \   0000C8                ; Setup parameters for call to function ReadRawRC
   \   0000C8   7906         MOV     R1,#0x6
   \   0000CA   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_54:
   \   0000CD   541B         ANL     A,#0x1b
   \   0000CF   6003         JZ      $+5
   \   0000D1   02....       LJMP    ??PcdComMF522_7 & 0xFFFF
    692                {
    693                    cStatus = MI_OK;
   \   0000D4   75..26       MOV     ?V0 + 3,#0x26
    694                    
    695                    if ( ucN & ucIrqEn & 0x01 )					//是否发生定时器中断
   \   0000D7   E5..         MOV     A,?V0 + 5
   \   0000D9   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000DB   C0D0         PUSH    PSW
   \   0000DD   E5..         MOV     A,?V0 + 8
   \   0000DF   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000E1   92F0         MOV     B.0,C
   \   0000E3   12....       LCALL   ?POP_BIT_ISP
   \   0000E6   1581         DEC     SP
   \   0000E8   82F0         ANL     C,B.0
   \   0000EA   5003         JNC     ??PcdComMF522_8
    696                      cStatus = MI_NOTAGERR;   
   \   0000EC   75..CC       MOV     ?V0 + 3,#-0x34
    697                            
    698                    if ( ucCommand == PCD_TRANSCEIVE )
   \                     ??PcdComMF522_8:
   \   0000EF   740C         MOV     A,#0xc
   \   0000F1   65..         XRL     A,?V0 + 2
   \   0000F3   6003         JZ      $+5
   \   0000F5   02....       LJMP    ??PcdComMF522_7 & 0xFFFF
    699                    {
    700                        ucN = ReadRawRC ( FIFOLevelReg );			//读FIFO中保存的字节数
   \   0000F8                ; Setup parameters for call to function ReadRawRC
   \   0000F8   790A         MOV     R1,#0xa
   \   0000FA   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_55:
   \   0000FD   F5..         MOV     ?V0 + 8,A
    701                        
    702                        ucLastBits = ReadRawRC ( ControlReg ) & 0x07;	//最后接收到得字节的有效位数
   \   0000FF                ; Setup parameters for call to function ReadRawRC
   \   0000FF   790C         MOV     R1,#0xc
   \   000101   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_56:
   \   000104   5407         ANL     A,#0x7
   \   000106   F5..         MOV     ?V0 + 10,A
    703                        
    704                        if ( ucLastBits )
   \   000108   85..82       MOV     DPL,?V0 + 8
   \   00010B   8582..       MOV     ?V0 + 6,DPL
   \   00010E   75..00       MOV     ?V0 + 7,#0x0
   \   000111   6028         JZ      ??PcdComMF522_9
    705                                * pOutLenBit = ( ucN - 1 ) * 8 + ucLastBits;   	//N个字节数减去1（最后一个字节）+最后一位的位数 读取到的数据总位数
   \   000113   E5..         MOV     A,?V0 + 6
   \   000115   24FF         ADD     A,#-0x1
   \   000117   F5..         MOV     ?V0 + 6,A
   \   000119   E4           CLR     A
   \   00011A   34FF         ADDC    A,#-0x1
   \   00011C   F5..         MOV     ?V0 + 7,A
   \   00011E   7403         MOV     A,#0x3
   \   000120   78..         MOV     R0,#?V0 + 6
   \   000122   12....       LCALL   ?S_SHL
   \   000125   E5..         MOV     A,?V0 + 6
   \   000127   25..         ADD     A,?V0 + 10
   \   000129   F8           MOV     R0,A
   \   00012A   E5..         MOV     A,?V0 + 7
   \   00012C   3400         ADDC    A,#0x0
   \   00012E   F9           MOV     R1,A
   \   00012F   85..82       MOV     DPL,?V0 + 0
   \   000132   85..83       MOV     DPH,?V0 + 1
   \   000135   E8           MOV     A,R0
   \   000136   F0           MOVX    @DPTR,A
   \   000137   A3           INC     DPTR
   \   000138   E9           MOV     A,R1
   \   000139   8013         SJMP    ??PcdComMF522_10
    706                        else
    707                                * pOutLenBit = ucN * 8;   					//最后接收到的字节整个字节有效
   \                     ??PcdComMF522_9:
   \   00013B   7403         MOV     A,#0x3
   \   00013D   78..         MOV     R0,#?V0 + 6
   \   00013F   12....       LCALL   ?S_SHL
   \   000142   85..82       MOV     DPL,?V0 + 0
   \   000145   85..83       MOV     DPH,?V0 + 1
   \   000148   E5..         MOV     A,?V0 + 6
   \   00014A   F0           MOVX    @DPTR,A
   \   00014B   A3           INC     DPTR
   \   00014C   E5..         MOV     A,?V0 + 7
   \                     ??PcdComMF522_10:
   \   00014E   F0           MOVX    @DPTR,A
    708                        
    709                        if ( ucN == 0 )		
   \   00014F   E5..         MOV     A,?V0 + 8
   \   000151   7005         JNZ     ??PcdComMF522_11
    710                            ucN = 1;    
   \   000153   75..01       MOV     ?V0 + 8,#0x1
   \   000156   8008         SJMP    ??PcdComMF522_12
    711                        
    712                        if ( ucN > MAXRLEN )
   \                     ??PcdComMF522_11:
   \   000158   C3           CLR     C
   \   000159   9413         SUBB    A,#0x13
   \   00015B   4003         JC      ??PcdComMF522_12
    713                                ucN = MAXRLEN;   
   \   00015D   75..12       MOV     ?V0 + 8,#0x12
    714                        
    715                        for ( ul = 0; ul < ucN; ul ++ )
   \                     ??PcdComMF522_12:
   \   000160   7E00         MOV     R6,#0x0
   \   000162   7F00         MOV     R7,#0x0
   \   000164   8019         SJMP    ??PcdComMF522_13
    716                          pOutData [ ul ] = ReadRawRC ( FIFODataReg );   
   \                     ??PcdComMF522_14:
   \   000166                ; Setup parameters for call to function ReadRawRC
   \   000166   7909         MOV     R1,#0x9
   \   000168   12....       LCALL   ??ReadRawRC?relay
   \   00016B   E5..         MOV     A,?V0 + 12
   \   00016D   2E           ADD     A,R6
   \   00016E   F582         MOV     DPL,A
   \   000170   E5..         MOV     A,?V0 + 13
   \   000172   3F           ADDC    A,R7
   \   000173   F583         MOV     DPH,A
   \   000175   E9           MOV     A,R1
   \   000176   F0           MOVX    @DPTR,A
   \   000177   EE           MOV     A,R6
   \   000178   2401         ADD     A,#0x1
   \   00017A   0E           INC     R6
   \   00017B   EF           MOV     A,R7
   \   00017C   3400         ADDC    A,#0x0
   \   00017E   FF           MOV     R7,A
   \                     ??PcdComMF522_13:
   \   00017F   85....       MOV     ?V0 + 0,?V0 + 8
   \   000182   C3           CLR     C
   \   000183   EE           MOV     A,R6
   \   000184   95..         SUBB    A,?V0 + 0
   \   000186   EF           MOV     A,R7
   \   000187   9400         SUBB    A,#0x0
   \   000189   A2D2         MOV     C,0xD0 /* PSW */.2
   \   00018B   65D0         XRL     A,PSW
   \   00018D   33           RLC     A
   \   00018E   40D6         JC      ??PcdComMF522_14
    717                            
    718                      }		
    719                }
    720          			
    721                else
    722                cStatus = MI_ERR;   
    723              }
    724             
    725             SetBitMask ( ControlReg, 0x80 );           // stop timer now
   \                     ??PcdComMF522_7:
   \   000190                ; Setup parameters for call to function SetBitMask
   \   000190   7A80         MOV     R2,#-0x80
   \   000192   790C         MOV     R1,#0xc
   \   000194   12....       LCALL   ??SetBitMask?relay
    726             WriteRawRC ( CommandReg, PCD_IDLE ); 
   \   000197                ; Setup parameters for call to function WriteRawRC
   \   000197   7A00         MOV     R2,#0x0
   \   000199   7901         MOV     R1,#0x1
   \   00019B   12....       LCALL   ??WriteRawRC?relay
    727          	
    728             return cStatus;
   \   00019E   A9..         MOV     R1,?V0 + 3
   \   0001A0   7F0E         MOV     R7,#0xe
   \   0001A2   02....       LJMP    ?BANKED_LEAVE_XDATA
    729          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   12....       LCALL   ??ClearBitMask?relay
   \   000003                ; Setup parameters for call to function WriteRawRC
   \   000003                ; Setup parameters for call to function WriteRawRC
   \   000003   7A00         MOV     R2,#0x0
   \   000005   7901         MOV     R1,#0x1
   \   000007   12....       LCALL   ??WriteRawRC?relay
   \   00000A                ; Setup parameters for call to function SetBitMask
   \   00000A                ; Setup parameters for call to function SetBitMask
   \   00000A   7A80         MOV     R2,#-0x80
   \   00000C   790A         MOV     R1,#0xa
   \   00000E   12....       LCALL   ??SetBitMask?relay
   \   000011   22           RET
    730          
    731          //==========================================================
    732          //	函数名称：	PcdRequest
    733          //
    734          //	函数功能：	寻卡
    735          //
    736          //	入口参数：	ucReq_code，寻卡方式
    737          //                     = 0x52，寻感应区内所有符合14443A标准的卡
    738          //                     = 0x26，寻未进入休眠状态的卡
    739          //              pTagType，卡片类型代码
    740          //                   = 0x4400，Mifare_UltraLight
    741          //                   = 0x0400，Mifare_One(S50)
    742          //                   = 0x0200，Mifare_One(S70)
    743          //                   = 0x0800，Mifare_Pro(X))
    744          //                   = 0x4403，Mifare_DESFire
    745          //
    746          //	返回参数：	状态值 = MI_OK，成功
    747          //
    748          //	说明：		
    749          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    750          char PcdRequest ( unsigned char ucReq_code, unsigned char * pTagType)
   \                     PcdRequest:
    751          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   89..         MOV     ?V0 + 2,R1
   \   00000C   EA           MOV     A,R2
   \   00000D   FE           MOV     R6,A
   \   00000E   EB           MOV     A,R3
   \   00000F   FF           MOV     R7,A
    752             char cStatus;  
    753             unsigned char ucComMF522Buf [ MAXRLEN ]; 
    754             int ulLen;
    755          
    756             ClearBitMask ( Status2Reg, 0x08 );	//清理指示MIFARECyptol单元接通以及所有卡的数据通信被加密的情况
   \   000010                ; Setup parameters for call to function ClearBitMask
   \   000010   7A08         MOV     R2,#0x8
   \   000012   7908         MOV     R1,#0x8
   \   000014   12....       LCALL   ??ClearBitMask?relay
    757             WriteRawRC ( BitFramingReg, 0x07 );	//	发送的最后一个字节的 七位
   \   000017                ; Setup parameters for call to function WriteRawRC
   \   000017   7A07         MOV     R2,#0x7
   \   000019   790D         MOV     R1,#0xd
   \   00001B   12....       LCALL   ??WriteRawRC?relay
    758             SetBitMask ( TxControlReg, 0x03 );	//TX1,TX2管脚的输出信号传递经发送调制的13.56的能量载波信号
   \   00001E                ; Setup parameters for call to function SetBitMask
   \   00001E   7A03         MOV     R2,#0x3
   \   000020   7914         MOV     R1,#0x14
   \   000022   12....       LCALL   ??SetBitMask?relay
    759          
    760             ucComMF522Buf [ 0 ] = ucReq_code;		//存入 卡片命令字
   \   000025   7402         MOV     A,#0x2
   \   000027   12....       LCALL   ?XSTACK_DISP0_8
   \   00002A   E5..         MOV     A,?V0 + 2
   \   00002C   12....       LCALL   ?Subroutine13 & 0xFFFF
    761          
    762             cStatus = PcdComMF522 ( PCD_TRANSCEIVE,	ucComMF522Buf, 1, ucComMF522Buf, & ulLen );	//寻卡  
   \                     ??CrossCallReturnLabel_13:
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   7404         MOV     A,#0x4
   \   000034   12....       LCALL   ?XSTACK_DISP0_8
   \   000037   8582..       MOV     ?V0 + 0,DPL
   \   00003A   8583..       MOV     ?V0 + 1,DPH
   \   00003D   78..         MOV     R0,#?V0 + 0
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000042   7C01         MOV     R4,#0x1
   \   000044   7406         MOV     A,#0x6
   \   000046   12....       LCALL   ?XSTACK_DISP0_8
   \   000049   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_59:
   \   00004C   12....       LCALL   ?DEALLOC_XSTACK8
    763           
    764             if ( ( cStatus == MI_OK ) && ( ulLen == 0x10 ) )	//寻卡成功返回卡类型 
   \   00004F   7426         MOV     A,#0x26
   \   000051   69           XRL     A,R1
   \   000052   7028         JNZ     ??PcdRequest_0
   \   000054   85..82       MOV     DPL,?XSP + 0
   \   000057   85..83       MOV     DPH,?XSP + 1
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   6410         XRL     A,#0x10
   \   00005D   7002         JNZ     ??PcdRequest_1
   \   00005F   A3           INC     DPTR
   \   000060   E0           MOVX    A,@DPTR
   \                     ??PcdRequest_1:
   \   000061   7019         JNZ     ??PcdRequest_0
    765             {    
    766                 * pTagType = ucComMF522Buf [ 0 ];
   \   000063   7402         MOV     A,#0x2
   \   000065   12....       LCALL   ?XSTACK_DISP0_8
   \   000068   E0           MOVX    A,@DPTR
   \   000069   8E82         MOV     DPL,R6
   \   00006B   8F83         MOV     DPH,R7
   \   00006D   F0           MOVX    @DPTR,A
    767                 * ( pTagType + 1 ) = ucComMF522Buf [ 1 ];
   \   00006E   7403         MOV     A,#0x3
   \   000070   12....       LCALL   ?XSTACK_DISP0_8
   \   000073   E0           MOVX    A,@DPTR
   \   000074   8E82         MOV     DPL,R6
   \   000076   8F83         MOV     DPH,R7
   \   000078   A3           INC     DPTR
   \   000079   F0           MOVX    @DPTR,A
   \   00007A   8002         SJMP    ??PcdRequest_2
    768             }
    769             else
    770             {
    771               cStatus = MI_ERR;
   \                     ??PcdRequest_0:
   \   00007C   79BB         MOV     R1,#-0x45
    772             }
    773          	 
    774             return cStatus; 
   \                     ??PcdRequest_2:
   \   00007E                REQUIRE ?Subroutine3
   \   00007E                ; // Fall through to label ?Subroutine3
    775          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   7414         MOV     A,#0x14
   \   000002   12....       LCALL   ?DEALLOC_XSTACK8
   \   000005   7F03         MOV     R7,#0x3
   \   000007   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function PcdComMF522
   \   000001                ; Setup parameters for call to function PcdComMF522
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   8582..       MOV     ?V0 + 0,DPL
   \   00000A   8583..       MOV     ?V0 + 1,DPH
   \   00000D   78..         MOV     R0,#?V0 + 0
   \   00000F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   AA82         MOV     R2,DPL
   \   000002   AB83         MOV     R3,DPH
   \   000004   790C         MOV     R1,#0xc
   \   000006                REQUIRE ??Subroutine33_0
   \   000006                ; // Fall through to label ??Subroutine33_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine33_0:
   \   000000   12....       LCALL   ??PcdComMF522?relay
   \   000003   7404         MOV     A,#0x4
   \   000005   22           RET
    776          
    777          //==========================================================
    778          //	函数名称：	PcdAnticoll
    779          //
    780          //	函数功能：	防冲撞
    781          //
    782          //	入口参数：	pSnr，卡片序列号，4字节
    783          //
    784          //	返回参数：	状态值 = MI_OK，成功
    785          //
    786          //	说明：		
    787          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    788          char PcdAnticoll ( unsigned char * pSnr )
   \                     PcdAnticoll:
    789          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    790              char cStatus;
    791              unsigned char uc, ucSnr_check = 0;
   \   00000E   75..00       MOV     ?V0 + 2,#0x0
    792              unsigned char ucComMF522Buf [ MAXRLEN ]; 
    793          	int ulLen;
    794              
    795          
    796              ClearBitMask ( Status2Reg, 0x08 );		//清MFCryptol On位 只有成功执行MFAuthent命令后，该位才能置位
   \   000011                ; Setup parameters for call to function ClearBitMask
   \   000011   7A08         MOV     R2,#0x8
   \   000013   7908         MOV     R1,#0x8
   \   000015   12....       LCALL   ??ClearBitMask?relay
    797              WriteRawRC ( BitFramingReg, 0x00);		//清理寄存器 停止收发
   \   000018                ; Setup parameters for call to function WriteRawRC
   \   000018   7A00         MOV     R2,#0x0
   \   00001A   790D         MOV     R1,#0xd
   \   00001C   12....       LCALL   ??WriteRawRC?relay
    798              ClearBitMask ( CollReg, 0x80 );			//清ValuesAfterColl所有接收的位在冲突后被清除
   \   00001F                ; Setup parameters for call to function ClearBitMask
   \   00001F   7A80         MOV     R2,#-0x80
   \   000021   790E         MOV     R1,#0xe
   \   000023   12....       LCALL   ??ClearBitMask?relay
    799             
    800              ucComMF522Buf [ 0 ] = 0x93;	//卡片防冲突命令
   \   000026   7402         MOV     A,#0x2
   \   000028   12....       LCALL   ?XSTACK_DISP0_8
   \   00002B   7493         MOV     A,#-0x6d
   \   00002D   F0           MOVX    @DPTR,A
    801              ucComMF522Buf [ 1 ] = 0x20;
   \   00002E   7403         MOV     A,#0x3
   \   000030   12....       LCALL   ?XSTACK_DISP0_8
   \   000033   7420         MOV     A,#0x20
   \   000035   12....       LCALL   ?Subroutine13 & 0xFFFF
    802             
    803              cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 2, ucComMF522Buf, & ulLen);//与卡片通信
   \                     ??CrossCallReturnLabel_14:
   \   000038   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003B   7404         MOV     A,#0x4
   \   00003D   12....       LCALL   ?XSTACK_DISP0_8
   \   000040   8582..       MOV     ?V0 + 0,DPL
   \   000043   8583..       MOV     ?V0 + 1,DPH
   \   000046   78..         MOV     R0,#?V0 + 0
   \   000048   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00004B   7C02         MOV     R4,#0x2
   \   00004D   7406         MOV     A,#0x6
   \   00004F   12....       LCALL   ?XSTACK_DISP0_8
   \   000052   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_60:
   \   000055   12....       LCALL   ?DEALLOC_XSTACK8
   \   000058   E9           MOV     A,R1
   \   000059   F5..         MOV     ?V0 + 0,A
    804          	
    805              if ( cStatus == MI_OK)		//通信成功
   \   00005B   7426         MOV     A,#0x26
   \   00005D   65..         XRL     A,?V0 + 0
   \   00005F   7041         JNZ     ??PcdAnticoll_0
    806              {
    807                for ( uc = 0; uc < 4; uc ++ )
   \   000061   75..00       MOV     ?V0 + 4,#0x0
    808                {
    809                  * ( pSnr + uc )  = ucComMF522Buf [ uc ];			//读出UID
   \                     ??PcdAnticoll_1:
   \   000064   85..82       MOV     DPL,?V0 + 4
   \   000067   AA82         MOV     R2,DPL
   \   000069   7402         MOV     A,#0x2
   \   00006B   12....       LCALL   ?XSTACK_DISP0_8
   \   00006E   E582         MOV     A,DPL
   \   000070   2A           ADD     A,R2
   \   000071   F8           MOV     R0,A
   \   000072   E583         MOV     A,DPH
   \   000074   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   000077   C0E0         PUSH    A
   \   000079   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   00007C   D0E0         POP     A
   \   00007E   F0           MOVX    @DPTR,A
    810                  ucSnr_check ^= ucComMF522Buf [ uc ];
   \   00007F   8882         MOV     DPL,R0
   \   000081   8983         MOV     DPH,R1
   \   000083   E0           MOVX    A,@DPTR
   \   000084   62..         XRL     ?V0 + 2,A
    811                }
   \   000086   05..         INC     ?V0 + 4
   \   000088   E5..         MOV     A,?V0 + 4
   \   00008A   C3           CLR     C
   \   00008B   9404         SUBB    A,#0x4
   \   00008D   40D5         JC      ??PcdAnticoll_1
    812          			
    813                if ( ucSnr_check != ucComMF522Buf [ uc ] )
   \   00008F   7402         MOV     A,#0x2
   \   000091   12....       LCALL   ?XSTACK_DISP0_8
   \   000094   E582         MOV     A,DPL
   \   000096   25..         ADD     A,?V0 + 4
   \   000098   12....       LCALL   ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_43:
   \   00009B   65..         XRL     A,?V0 + 2
   \   00009D   6003         JZ      ??PcdAnticoll_0
    814                {
    815                  cStatus = MI_ERR; 
   \   00009F   75..BB       MOV     ?V0 + 0,#-0x45
    816                }
    817          				 
    818              }
    819              
    820              SetBitMask ( CollReg, 0x80 );
   \                     ??PcdAnticoll_0:
   \   0000A2                ; Setup parameters for call to function SetBitMask
   \   0000A2   7A80         MOV     R2,#-0x80
   \   0000A4   790E         MOV     R1,#0xe
   \   0000A6   12....       LCALL   ??SetBitMask?relay
    821          		
    822          		
    823              return cStatus;
   \   0000A9   A9..         MOV     R1,?V0 + 0
   \   0000AB   7414         MOV     A,#0x14
   \   0000AD   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B0                REQUIRE ?Subroutine4
   \   0000B0                ; // Fall through to label ?Subroutine4
    824          		
    825          		
    826          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7F06         MOV     R7,#0x6
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   F582         MOV     DPL,A
   \   000002   E583         MOV     A,DPH
   \   000004                REQUIRE ??Subroutine31_0
   \   000004                ; // Fall through to label ??Subroutine31_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine31_0:
   \   000000   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_48:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F9           MOV     R1,A
   \   000003   8882         MOV     DPL,R0
   \   000005   8983         MOV     DPH,R1
   \   000007   E0           MOVX    A,@DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   EE           MOV     A,R6
   \   000001   2A           ADD     A,R2
   \   000002   F582         MOV     DPL,A
   \   000004   EF           MOV     A,R7
   \   000005   3400         ADDC    A,#0x0
   \   000007   F583         MOV     DPH,A
   \   000009   22           RET
    827          
    828          //==========================================================
    829          //	函数名称：	CalulateCRC
    830          //
    831          //	函数功能：	用RC522计算CRC16
    832          //
    833          //	入口参数：	pIndata，计算CRC16的数组
    834          //              ucLen，计算CRC16的数组字节长度
    835          //              pOutData，存放计算结果存放的首地址
    836          //
    837          //	返回参数：	无
    838          //
    839          //	说明：		
    840          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    841          void CalulateCRC ( unsigned char * pIndata, unsigned char ucLen, unsigned char * pOutData )
   \                     CalulateCRC:
    842          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   89..         MOV     ?V0 + 5,R1
   \   00000B   8C..         MOV     ?V0 + 0,R4
   \   00000D   8D..         MOV     ?V0 + 1,R5
    843              unsigned char uc, ucN;
    844          	
    845          	
    846              ClearBitMask(DivIrqReg,0x04);
   \   00000F                ; Setup parameters for call to function ClearBitMask
   \   00000F   7A04         MOV     R2,#0x4
   \   000011   7905         MOV     R1,#0x5
   \   000013   12....       LCALL   ?Subroutine20 & 0xFFFF
    847          	
    848              WriteRawRC(CommandReg,PCD_IDLE);
    849          	
    850              SetBitMask(FIFOLevelReg,0x80);
    851          	
    852              for ( uc = 0; uc < ucLen; uc ++)
   \                     ??CrossCallReturnLabel_29:
   \   000016   75..00       MOV     ?V0 + 4,#0x0
   \   000019   8013         SJMP    ??CalulateCRC_0
    853          	    WriteRawRC ( FIFODataReg, * ( pIndata + uc ) );   
   \                     ??CalulateCRC_1:
   \   00001B                ; Setup parameters for call to function WriteRawRC
   \   00001B   85....       MOV     ?V0 + 2,?V0 + 4
   \   00001E   EE           MOV     A,R6
   \   00001F   25..         ADD     A,?V0 + 2
   \   000021   F582         MOV     DPL,A
   \   000023   EF           MOV     A,R7
   \   000024   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_8:
   \   000027   7909         MOV     R1,#0x9
   \   000029   12....       LCALL   ??WriteRawRC?relay
   \   00002C   05..         INC     ?V0 + 4
   \                     ??CalulateCRC_0:
   \   00002E   E5..         MOV     A,?V0 + 4
   \   000030   C3           CLR     C
   \   000031   95..         SUBB    A,?V0 + 5
   \   000033   40E6         JC      ??CalulateCRC_1
    854          
    855              WriteRawRC ( CommandReg, PCD_CALCCRC );
   \   000035                ; Setup parameters for call to function WriteRawRC
   \   000035   7A03         MOV     R2,#0x3
   \   000037   7901         MOV     R1,#0x1
   \   000039   12....       LCALL   ??WriteRawRC?relay
    856          	
    857              uc = 0xFF;
   \   00003C   75..FF       MOV     ?V0 + 4,#-0x1
    858          	
    859              do 
    860              {
    861                  ucN = ReadRawRC ( DivIrqReg );
   \                     ??CalulateCRC_2:
   \   00003F                ; Setup parameters for call to function ReadRawRC
   \   00003F   7905         MOV     R1,#0x5
   \   000041   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_57:
   \   000044   F8           MOV     R0,A
    862                  uc --;
    863              } while ( ( uc != 0 ) && ! ( ucN & 0x04 ) );
   \   000045   15..         DEC     ?V0 + 4
   \   000047   E5..         MOV     A,?V0 + 4
   \   000049   6005         JZ      ??CalulateCRC_3
   \   00004B   E8           MOV     A,R0
   \   00004C   A2E2         MOV     C,0xE0 /* A   */.2
   \   00004E   50EF         JNC     ??CalulateCRC_2
    864          		
    865              pOutData [ 0 ] = ReadRawRC ( CRCResultRegL );
   \                     ??CalulateCRC_3:
   \   000050                ; Setup parameters for call to function ReadRawRC
   \   000050   7922         MOV     R1,#0x22
   \   000052   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   000055   F0           MOVX    @DPTR,A
    866              pOutData [ 1 ] = ReadRawRC ( CRCResultRegM );
   \   000056                ; Setup parameters for call to function ReadRawRC
   \   000056   7921         MOV     R1,#0x21
   \   000058   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   00005B   A3           INC     DPTR
   \   00005C   F0           MOVX    @DPTR,A
    867          		
    868          		
    869          }
   \   00005D   80..         SJMP    ?Subroutine4

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   12....       LCALL   ??ReadRawRC?relay
   \   000003   E9           MOV     A,R1
   \   000004   85..82       MOV     DPL,?V0 + 0
   \   000007   85..83       MOV     DPH,?V0 + 1
   \   00000A   22           RET
    870          
    871          //==========================================================
    872          //	函数名称：	PcdSelect
    873          //
    874          //	函数功能：	选定卡片
    875          //
    876          //	入口参数：	pSnr，卡片序列号，4字节
    877          //
    878          //	返回参数：	状态值 = MI_OK，成功
    879          //
    880          //	说明：		
    881          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7414         MOV     A,#0x14
   \   000002   12....       LCALL   ?DEALLOC_XSTACK8
   \   000005                REQUIRE ??Subroutine29_0
   \   000005                ; // Fall through to label ??Subroutine29_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    882          char PcdSelect ( unsigned char * pSnr )
   \                     PcdSelect:
    883          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    884              char ucN;
    885              unsigned char uc;
    886          	  unsigned char ucComMF522Buf [ MAXRLEN ]; 
    887              int  ulLen;
    888              
    889              
    890              ucComMF522Buf [ 0 ] = PICC_ANTICOLL1;
   \   00000A   7402         MOV     A,#0x2
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   7493         MOV     A,#-0x6d
   \   000011   F0           MOVX    @DPTR,A
    891              ucComMF522Buf [ 1 ] = 0x70;
   \   000012   7403         MOV     A,#0x3
   \   000014   12....       LCALL   ?XSTACK_DISP0_8
   \   000017   7470         MOV     A,#0x70
   \   000019   F0           MOVX    @DPTR,A
    892              ucComMF522Buf [ 6 ] = 0;
   \   00001A   7408         MOV     A,#0x8
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E4           CLR     A
   \   000020   F0           MOVX    @DPTR,A
    893          	
    894              for ( uc = 0; uc < 4; uc ++ )
   \   000021   FE           MOV     R6,A
    895              {
    896              	ucComMF522Buf [ uc + 2 ] = * ( pSnr + uc );
   \                     ??PcdSelect_0:
   \   000022   8E82         MOV     DPL,R6
   \   000024   AC82         MOV     R4,DPL
   \   000026   EA           MOV     A,R2
   \   000027   2C           ADD     A,R4
   \   000028   F8           MOV     R0,A
   \   000029   EB           MOV     A,R3
   \   00002A   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   00002D   C0E0         PUSH    A
   \   00002F   7402         MOV     A,#0x2
   \   000031   12....       LCALL   ?XSTACK_DISP0_8
   \   000034   E582         MOV     A,DPL
   \   000036   2C           ADD     A,R4
   \   000037   F582         MOV     DPL,A
   \   000039   E583         MOV     A,DPH
   \   00003B   3400         ADDC    A,#0x0
   \   00003D   F583         MOV     DPH,A
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   D0E0         POP     A
   \   000043   F0           MOVX    @DPTR,A
    897              	ucComMF522Buf [ 6 ] ^= * ( pSnr + uc );
   \   000044   8882         MOV     DPL,R0
   \   000046   8983         MOV     DPH,R1
   \   000048   E0           MOVX    A,@DPTR
   \   000049   F8           MOV     R0,A
   \   00004A   7408         MOV     A,#0x8
   \   00004C   12....       LCALL   ?XSTACK_DISP0_8
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   68           XRL     A,R0
   \   000051   F0           MOVX    @DPTR,A
    898              }
   \   000052   0E           INC     R6
   \   000053   EE           MOV     A,R6
   \   000054   C3           CLR     C
   \   000055   9404         SUBB    A,#0x4
   \   000057   40C9         JC      ??PcdSelect_0
    899          		
    900              CalulateCRC ( ucComMF522Buf, 7, & ucComMF522Buf [ 7 ] );
   \   000059                ; Setup parameters for call to function CalulateCRC
   \   000059   7409         MOV     A,#0x9
   \   00005B   12....       LCALL   ?XSTACK_DISP0_8
   \   00005E   AC82         MOV     R4,DPL
   \   000060   AD83         MOV     R5,DPH
   \   000062   7907         MOV     R1,#0x7
   \   000064   7402         MOV     A,#0x2
   \   000066   12....       LCALL   ?XSTACK_DISP0_8
   \   000069   AA82         MOV     R2,DPL
   \   00006B   AB83         MOV     R3,DPH
   \   00006D   12....       LCALL   ??CalulateCRC?relay
    901            
    902              ClearBitMask ( Status2Reg, 0x08 );
   \   000070                ; Setup parameters for call to function ClearBitMask
   \   000070   7A08         MOV     R2,#0x8
   \   000072   7908         MOV     R1,#0x8
   \   000074   12....       LCALL   ??ClearBitMask?relay
    903          
    904              ucN = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 9, ucComMF522Buf, & ulLen );
   \   000077                ; Setup parameters for call to function PcdComMF522
   \   000077   85..82       MOV     DPL,?XSP + 0
   \   00007A   85..83       MOV     DPH,?XSP + 1
   \   00007D   8582..       MOV     ?V0 + 0,DPL
   \   000080   8583..       MOV     ?V0 + 1,DPH
   \   000083   78..         MOV     R0,#?V0 + 0
   \   000085   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000088   7404         MOV     A,#0x4
   \   00008A   12....       LCALL   ?XSTACK_DISP0_8
   \   00008D   8582..       MOV     ?V0 + 0,DPL
   \   000090   8583..       MOV     ?V0 + 1,DPH
   \   000093   78..         MOV     R0,#?V0 + 0
   \   000095   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000098   7C09         MOV     R4,#0x9
   \   00009A   7406         MOV     A,#0x6
   \   00009C   12....       LCALL   ?XSTACK_DISP0_8
   \   00009F   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_61:
   \   0000A2   12....       LCALL   ?DEALLOC_XSTACK8
    905              
    906              if ( ( ucN == MI_OK ) && ( ulLen == 0x18 ) )
   \   0000A5   7426         MOV     A,#0x26
   \   0000A7   69           XRL     A,R1
   \   0000A8   700F         JNZ     ??PcdSelect_1
   \   0000AA   85..82       MOV     DPL,?XSP + 0
   \   0000AD   85..83       MOV     DPH,?XSP + 1
   \   0000B0   E0           MOVX    A,@DPTR
   \   0000B1   6418         XRL     A,#0x18
   \   0000B3   7002         JNZ     ??PcdSelect_2
   \   0000B5   A3           INC     DPTR
   \   0000B6   E0           MOVX    A,@DPTR
   \                     ??PcdSelect_2:
   \   0000B7   6002         JZ      ??PcdSelect_3
    907                ucN = MI_OK;  
    908              else
    909                ucN = MI_ERR;    
   \                     ??PcdSelect_1:
   \   0000B9   79BB         MOV     R1,#-0x45
    910          
    911          		
    912              return ucN;
   \                     ??PcdSelect_3:
   \   0000BB   02....       LJMP    ?Subroutine2 & 0xFFFF
    913          		
    914          		
    915          }
    916          
    917          //==========================================================
    918          //	函数名称：	PcdAuthState
    919          //
    920          //	函数功能：	验证卡片密码
    921          //
    922          //	入口参数：	ucAuth_mode，密码验证模式
    923          //                     = 0x60，验证A密钥
    924          //                     = 0x61，验证B密钥
    925          //         unsigned char ucAddr，块地址
    926          //         pKey，密码
    927          //         pSnr，卡片序列号，4字节
    928          //
    929          //	返回参数：	 状态值 = MI_OK，成功
    930          //
    931          //	说明：		
    932          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    933          char PcdAuthState ( unsigned char ucAuth_mode, unsigned char ucAddr, unsigned char * pKey, unsigned char * pSnr )
   \                     PcdAuthState:
    934          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   \   00000C   741E         MOV     A,#0x1e
   \   00000E   12....       LCALL   ?XSTACK_DISP0_8
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F8           MOV     R0,A
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F9           MOV     R1,A
    935              char cStatus;
    936          	  unsigned char uc, ucComMF522Buf [ MAXRLEN ];
    937              int ulLen;
    938              
    939          	
    940              ucComMF522Buf [ 0 ] = ucAuth_mode;
   \   000016   7402         MOV     A,#0x2
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   EE           MOV     A,R6
   \   00001C   F0           MOVX    @DPTR,A
    941              ucComMF522Buf [ 1 ] = ucAddr;
   \   00001D   7403         MOV     A,#0x3
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   EA           MOV     A,R2
   \   000023   F0           MOVX    @DPTR,A
    942          	
    943              for ( uc = 0; uc < 6; uc ++ )
   \   000024   75..00       MOV     ?V0 + 0,#0x0
    944          	    ucComMF522Buf [ uc + 2 ] = * ( pKey + uc );   
   \                     ??PcdAuthState_0:
   \   000027   85..82       MOV     DPL,?V0 + 0
   \   00002A   AA82         MOV     R2,DPL
   \   00002C   EC           MOV     A,R4
   \   00002D   2A           ADD     A,R2
   \   00002E   F582         MOV     DPL,A
   \   000030   ED           MOV     A,R5
   \   000031   12....       LCALL   ??Subroutine31_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_40:
   \   000034   C0E0         PUSH    A
   \   000036   7402         MOV     A,#0x2
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   00003E   D0E0         POP     A
   \   000040   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   000043   40E2         JC      ??PcdAuthState_0
    945          	
    946              for ( uc = 0; uc < 6; uc ++ )
   \   000045   75..00       MOV     ?V0 + 0,#0x0
    947          	    ucComMF522Buf [ uc + 8 ] = * ( pSnr + uc );   
   \                     ??PcdAuthState_1:
   \   000048   85..82       MOV     DPL,?V0 + 0
   \   00004B   AA82         MOV     R2,DPL
   \   00004D   E8           MOV     A,R0
   \   00004E   2A           ADD     A,R2
   \   00004F   F582         MOV     DPL,A
   \   000051   E9           MOV     A,R1
   \   000052   12....       LCALL   ??Subroutine31_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_41:
   \   000055   C0E0         PUSH    A
   \   000057   7402         MOV     A,#0x2
   \   000059   12....       LCALL   ?XSTACK_DISP0_8
   \   00005C   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   00005F   A3           INC     DPTR
   \   000060   A3           INC     DPTR
   \   000061   A3           INC     DPTR
   \   000062   A3           INC     DPTR
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   D0E0         POP     A
   \   000067   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   00006A   40DC         JC      ??PcdAuthState_1
    948          
    949              cStatus = PcdComMF522 ( PCD_AUTHENT, ucComMF522Buf, 12, ucComMF522Buf, & ulLen );
   \   00006C                ; Setup parameters for call to function PcdComMF522
   \   00006C   85..82       MOV     DPL,?XSP + 0
   \   00006F   85..83       MOV     DPH,?XSP + 1
   \   000072   8582..       MOV     ?V0 + 0,DPL
   \   000075   8583..       MOV     ?V0 + 1,DPH
   \   000078   78..         MOV     R0,#?V0 + 0
   \   00007A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00007D   7404         MOV     A,#0x4
   \   00007F   12....       LCALL   ?XSTACK_DISP0_8
   \   000082   8582..       MOV     ?V0 + 0,DPL
   \   000085   8583..       MOV     ?V0 + 1,DPH
   \   000088   78..         MOV     R0,#?V0 + 0
   \   00008A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008D   7C0C         MOV     R4,#0xc
   \   00008F   7406         MOV     A,#0x6
   \   000091   12....       LCALL   ?XSTACK_DISP0_8
   \   000094   AA82         MOV     R2,DPL
   \   000096   AB83         MOV     R3,DPH
   \   000098   790E         MOV     R1,#0xe
   \   00009A   12....       LCALL   ??Subroutine33_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_66:
   \   00009D   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A0   E9           MOV     A,R1
   \   0000A1   F5..         MOV     ?V0 + 0,A
    950          	
    951              if ( ( cStatus != MI_OK ) || ( ! ( ReadRawRC ( Status2Reg ) & 0x08 ) ) )
   \   0000A3   7426         MOV     A,#0x26
   \   0000A5   65..         XRL     A,?V0 + 0
   \   0000A7   7009         JNZ     ??PcdAuthState_2
   \   0000A9                ; Setup parameters for call to function ReadRawRC
   \   0000A9   7908         MOV     R1,#0x8
   \   0000AB   12....       LCALL   ??Subroutine32_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_58:
   \   0000AE   A2E3         MOV     C,0xE0 /* A   */.3
   \   0000B0   4003         JC      ??PcdAuthState_3
    952                cStatus = MI_ERR;   
   \                     ??PcdAuthState_2:
   \   0000B2   75..BB       MOV     ?V0 + 0,#-0x45
    953              
    954          		
    955              return cStatus;
   \                     ??PcdAuthState_3:
   \   0000B5   A9..         MOV     R1,?V0 + 0
   \   0000B7   02....       LJMP    ?Subroutine2 & 0xFFFF
    956          		
    957          		
    958          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   05..         INC     ?V0 + 0
   \   000003   E5..         MOV     A,?V0 + 0
   \   000005   C3           CLR     C
   \   000006   9406         SUBB    A,#0x6
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   E582         MOV     A,DPL
   \   000002   2A           ADD     A,R2
   \   000003   F582         MOV     DPL,A
   \   000005   E583         MOV     A,DPH
   \   000007   3400         ADDC    A,#0x0
   \   000009   F583         MOV     DPH,A
   \   00000B   A3           INC     DPTR
   \   00000C   A3           INC     DPTR
   \   00000D   22           RET
    959          
    960          //==========================================================
    961          //	函数名称：	PcdWrite
    962          //
    963          //	函数功能：	写数据到M1卡一块
    964          //
    965          //	入口参数：	unsigned char ucAddr，块地址
    966          //              pData，写入的数据，16字节
    967          //
    968          //	返回参数：	状态值 = MI_OK，成功
    969          //
    970          //	说明：		
    971          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    972          char PcdWrite ( unsigned char ucAddr, unsigned char * pData )
   \                     PcdWrite:
    973          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    974              char cStatus;
    975          	  unsigned char uc, ucComMF522Buf [ MAXRLEN ];
    976              int ulLen;
    977               
    978              
    979              ucComMF522Buf [ 0 ] = PICC_WRITE;
   \   00000E   7402         MOV     A,#0x2
   \   000010   12....       LCALL   ?XSTACK_DISP0_8
   \   000013   74A0         MOV     A,#-0x60
   \   000015   F0           MOVX    @DPTR,A
    980              ucComMF522Buf [ 1 ] = ucAddr;
   \   000016   7403         MOV     A,#0x3
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   E9           MOV     A,R1
   \   00001C   F0           MOVX    @DPTR,A
    981          	
    982              CalulateCRC ( ucComMF522Buf, 2, & ucComMF522Buf [ 2 ] );
   \   00001D                ; Setup parameters for call to function CalulateCRC
   \   00001D   7404         MOV     A,#0x4
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   AC82         MOV     R4,DPL
   \   000024   AD83         MOV     R5,DPH
   \   000026   7902         MOV     R1,#0x2
   \   000028   E9           MOV     A,R1
   \   000029   12....       LCALL   ?XSTACK_DISP0_8
   \   00002C   12....       LCALL   ?Subroutine25 & 0xFFFF
    983           
    984              cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 4, ucComMF522Buf, & ulLen );
    985          
    986              if ( ( cStatus != MI_OK ) || ( ulLen != 4 ) || ( ( ucComMF522Buf [ 0 ] & 0x0F ) != 0x0A ) )
   \                     ??CrossCallReturnLabel_34:
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   7404         MOV     A,#0x4
   \   000034   12....       LCALL   ?XSTACK_DISP0_8
   \   000037   8582..       MOV     ?V0 + 2,DPL
   \   00003A   8583..       MOV     ?V0 + 3,DPH
   \   00003D   78..         MOV     R0,#?V0 + 2
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000042   7C04         MOV     R4,#0x4
   \   000044   7406         MOV     A,#0x6
   \   000046   12....       LCALL   ?XSTACK_DISP0_8
   \   000049   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_62:
   \   00004C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004F   E9           MOV     A,R1
   \   000050   6426         XRL     A,#0x26
   \   000052   701B         JNZ     ??PcdWrite_0
   \   000054   85..82       MOV     DPL,?XSP + 0
   \   000057   85..83       MOV     DPH,?XSP + 1
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   6404         XRL     A,#0x4
   \   00005D   7002         JNZ     ??PcdWrite_1
   \   00005F   A3           INC     DPTR
   \   000060   E0           MOVX    A,@DPTR
   \                     ??PcdWrite_1:
   \   000061   700C         JNZ     ??PcdWrite_0
   \   000063   7402         MOV     A,#0x2
   \   000065   12....       LCALL   ?XSTACK_DISP0_8
   \   000068   E0           MOVX    A,@DPTR
   \   000069   540F         ANL     A,#0xf
   \   00006B   640A         XRL     A,#0xa
   \   00006D   6005         JZ      ??PcdWrite_2
    987                cStatus = MI_ERR;   
   \                     ??PcdWrite_0:
   \   00006F   79BB         MOV     R1,#-0x45
   \   000071   02....       LJMP    ??PcdWrite_3 & 0xFFFF
    988                  
    989              if ( cStatus == MI_OK )
    990              {
    991          			//memcpy(ucComMF522Buf, pData, 16);
    992                for ( uc = 0; uc < 16; uc ++ )
   \                     ??PcdWrite_2:
   \   000074   7A00         MOV     R2,#0x0
    993          			  ucComMF522Buf [ uc ] = * ( pData + uc );  
   \                     ??PcdWrite_4:
   \   000076   8A82         MOV     DPL,R2
   \   000078   A882         MOV     R0,DPL
   \   00007A   EE           MOV     A,R6
   \   00007B   28           ADD     A,R0
   \   00007C   F582         MOV     DPL,A
   \   00007E   EF           MOV     A,R7
   \   00007F   12....       LCALL   ??Subroutine31_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_42:
   \   000082   C0E0         PUSH    A
   \   000084   7402         MOV     A,#0x2
   \   000086   12....       LCALL   ?XSTACK_DISP0_8
   \   000089   E582         MOV     A,DPL
   \   00008B   28           ADD     A,R0
   \   00008C   F582         MOV     DPL,A
   \   00008E   E583         MOV     A,DPH
   \   000090   3400         ADDC    A,#0x0
   \   000092   F583         MOV     DPH,A
   \   000094   D0E0         POP     A
   \   000096   F0           MOVX    @DPTR,A
   \   000097   0A           INC     R2
   \   000098   EA           MOV     A,R2
   \   000099   C3           CLR     C
   \   00009A   9410         SUBB    A,#0x10
   \   00009C   40D8         JC      ??PcdWrite_4
    994          			
    995                CalulateCRC ( ucComMF522Buf, 16, & ucComMF522Buf [ 16 ] );
   \   00009E                ; Setup parameters for call to function CalulateCRC
   \   00009E   7412         MOV     A,#0x12
   \   0000A0   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A3   AC82         MOV     R4,DPL
   \   0000A5   AD83         MOV     R5,DPH
   \   0000A7   7910         MOV     R1,#0x10
   \   0000A9   7402         MOV     A,#0x2
   \   0000AB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AE   12....       LCALL   ?Subroutine25 & 0xFFFF
    996          
    997                cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 18, ucComMF522Buf, & ulLen );
   \                     ??CrossCallReturnLabel_35:
   \   0000B1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B4   7404         MOV     A,#0x4
   \   0000B6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B9   8582..       MOV     ?V0 + 2,DPL
   \   0000BC   8583..       MOV     ?V0 + 3,DPH
   \   0000BF   78..         MOV     R0,#?V0 + 2
   \   0000C1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C4   7C12         MOV     R4,#0x12
   \   0000C6   7406         MOV     A,#0x6
   \   0000C8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000CB   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_63:
   \   0000CE   12....       LCALL   ?DEALLOC_XSTACK8
    998          			
    999          			if ( ( cStatus != MI_OK ) || ( ulLen != 4 ) || ( ( ucComMF522Buf [ 0 ] & 0x0F ) != 0x0A ) )
   \   0000D1   7426         MOV     A,#0x26
   \   0000D3   69           XRL     A,R1
   \   0000D4   7099         JNZ     ??PcdWrite_0
   \   0000D6   85..82       MOV     DPL,?XSP + 0
   \   0000D9   85..83       MOV     DPH,?XSP + 1
   \   0000DC   E0           MOVX    A,@DPTR
   \   0000DD   6404         XRL     A,#0x4
   \   0000DF   7002         JNZ     ??PcdWrite_5
   \   0000E1   A3           INC     DPTR
   \   0000E2   E0           MOVX    A,@DPTR
   \                     ??PcdWrite_5:
   \   0000E3   708A         JNZ     ??PcdWrite_0
   \   0000E5   7402         MOV     A,#0x2
   \   0000E7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EA   E0           MOVX    A,@DPTR
   \   0000EB   540F         ANL     A,#0xf
   \   0000ED   640A         XRL     A,#0xa
   \   0000EF   6003         JZ      $+5
   \   0000F1   02....       LJMP    ??PcdWrite_0 & 0xFFFF
   1000                  cStatus = MI_ERR;   
   1001          			
   1002              } 
   1003          		
   1004          		
   1005              return cStatus;
   \                     ??PcdWrite_3:
   \   0000F4   7414         MOV     A,#0x14
   \   0000F6   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000F9   7F04         MOV     R7,#0x4
   \   0000FB   02....       LJMP    ?BANKED_LEAVE_XDATA
   1006          			
   1007          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_38:
   \   000003   8582..       MOV     ?V0 + 2,DPL
   \   000006   8583..       MOV     ?V0 + 3,DPH
   \   000009   78..         MOV     R0,#?V0 + 2
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   AA82         MOV     R2,DPL
   \   000002   AB83         MOV     R3,DPH
   \   000004   12....       LCALL   ??CalulateCRC?relay
   \   000007                ; Setup parameters for call to function PcdComMF522
   \   000007                ; Setup parameters for call to function PcdComMF522
   \   000007                ; Setup parameters for call to function PcdComMF522
   \   000007                ; Setup parameters for call to function PcdComMF522
   \   000007   85..82       MOV     DPL,?XSP + 0
   \   00000A   85..83       MOV     DPH,?XSP + 1
   \   00000D   22           RET
   1008          
   1009          //==========================================================
   1010          //	函数名称：	PcdRead
   1011          //
   1012          //	函数功能：	读取M1卡一块数据
   1013          //
   1014          //	入口参数：	unsigned char ucAddr，块地址
   1015          //               pData，读出的数据，16字节
   1016          //
   1017          //	返回参数：	状态值 = MI_OK，成功
   1018          //
   1019          //	说明：		
   1020          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1021          char PcdRead ( unsigned char ucAddr, unsigned char * pData )
   \                     PcdRead:
   1022          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1023              char cStatus;
   1024          	  unsigned char uc, ucComMF522Buf [ MAXRLEN ]; 
   1025              int ulLen;
   1026              
   1027          
   1028              ucComMF522Buf [ 0 ] = PICC_READ;
   \   00000E   7402         MOV     A,#0x2
   \   000010   12....       LCALL   ?XSTACK_DISP0_8
   \   000013   7430         MOV     A,#0x30
   \   000015   F0           MOVX    @DPTR,A
   1029              ucComMF522Buf [ 1 ] = ucAddr;
   \   000016   7403         MOV     A,#0x3
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   E9           MOV     A,R1
   \   00001C   F0           MOVX    @DPTR,A
   1030          	
   1031              CalulateCRC ( ucComMF522Buf, 2, & ucComMF522Buf [ 2 ] );
   \   00001D                ; Setup parameters for call to function CalulateCRC
   \   00001D   7404         MOV     A,#0x4
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   AC82         MOV     R4,DPL
   \   000024   AD83         MOV     R5,DPH
   \   000026   7902         MOV     R1,#0x2
   \   000028   E9           MOV     A,R1
   \   000029   12....       LCALL   ?XSTACK_DISP0_8
   \   00002C   12....       LCALL   ?Subroutine26 & 0xFFFF
   1032             
   1033              cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 4, ucComMF522Buf, & ulLen );
   \                     ??CrossCallReturnLabel_36:
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   7404         MOV     A,#0x4
   \   000034   12....       LCALL   ?XSTACK_DISP0_8
   \   000037   8582..       MOV     ?V0 + 0,DPL
   \   00003A   8583..       MOV     ?V0 + 1,DPH
   \   00003D   78..         MOV     R0,#?V0 + 0
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000042   7C04         MOV     R4,#0x4
   \   000044   7406         MOV     A,#0x6
   \   000046   12....       LCALL   ?XSTACK_DISP0_8
   \   000049   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_64:
   \   00004C   12....       LCALL   ?DEALLOC_XSTACK8
   1034          	
   1035              if ( ( cStatus == MI_OK ) && ( ulLen == 0x90 ) )
   \   00004F   7426         MOV     A,#0x26
   \   000051   69           XRL     A,R1
   \   000052   7031         JNZ     ??PcdRead_0
   \   000054   85..82       MOV     DPL,?XSP + 0
   \   000057   85..83       MOV     DPH,?XSP + 1
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   6490         XRL     A,#0x90
   \   00005D   7002         JNZ     ??PcdRead_1
   \   00005F   A3           INC     DPTR
   \   000060   E0           MOVX    A,@DPTR
   \                     ??PcdRead_1:
   \   000061   7022         JNZ     ??PcdRead_0
   1036              {
   1037          			for ( uc = 0; uc < 16; uc ++ )
   \   000063   7800         MOV     R0,#0x0
   1038                  * ( pData + uc ) = ucComMF522Buf [ uc ];   
   \                     ??PcdRead_2:
   \   000065   8882         MOV     DPL,R0
   \   000067   AA82         MOV     R2,DPL
   \   000069   7402         MOV     A,#0x2
   \   00006B   12....       LCALL   ?XSTACK_DISP0_8
   \   00006E   E582         MOV     A,DPL
   \   000070   2A           ADD     A,R2
   \   000071   12....       LCALL   ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_44:
   \   000074   C0E0         PUSH    A
   \   000076   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000079   D0E0         POP     A
   \   00007B   F0           MOVX    @DPTR,A
   \   00007C   08           INC     R0
   \   00007D   E8           MOV     A,R0
   \   00007E   C3           CLR     C
   \   00007F   9410         SUBB    A,#0x10
   \   000081   5004         JNC     ??PcdRead_3
   \   000083   80E0         SJMP    ??PcdRead_2
   1039              }
   1040          		
   1041              else
   1042                cStatus = MI_ERR;   
   \                     ??PcdRead_0:
   \   000085   79BB         MOV     R1,#-0x45
   1043              
   1044          		
   1045              return cStatus;
   \                     ??PcdRead_3:
   \   000087   02....       LJMP    ?Subroutine3 & 0xFFFF
   1046          		
   1047          		
   1048          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_39:
   \   000003   8582..       MOV     ?V0 + 0,DPL
   \   000006   8583..       MOV     ?V0 + 1,DPH
   \   000009   78..         MOV     R0,#?V0 + 0
   \   00000B   22           RET
   1049          
   1050          //==========================================================
   1051          //	函数名称：	PcdHalt
   1052          //
   1053          //	函数功能：	命令卡片进入休眠状态
   1054          //
   1055          //	入口参数：	无
   1056          //
   1057          //	返回参数：	状态值 = MI_OK，成功
   1058          //
   1059          //	说明：		
   1060          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1061          char PcdHalt( void )
   \                     PcdHalt:
   1062          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1063          	unsigned char ucComMF522Buf [ MAXRLEN ]; 
   1064          	int  ulLen;
   1065            
   1066          
   1067            ucComMF522Buf [ 0 ] = PICC_HALT;
   \   00000A   7402         MOV     A,#0x2
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   7450         MOV     A,#0x50
   \   000011   F0           MOVX    @DPTR,A
   1068            ucComMF522Buf [ 1 ] = 0;
   \   000012   7403         MOV     A,#0x3
   \   000014   12....       LCALL   ?XSTACK_DISP0_8
   \   000017   E4           CLR     A
   \   000018   F0           MOVX    @DPTR,A
   1069          	
   1070            CalulateCRC ( ucComMF522Buf, 2, & ucComMF522Buf [ 2 ] );
   \   000019                ; Setup parameters for call to function CalulateCRC
   \   000019   7404         MOV     A,#0x4
   \   00001B   12....       LCALL   ?XSTACK_DISP0_8
   \   00001E   AC82         MOV     R4,DPL
   \   000020   AD83         MOV     R5,DPH
   \   000022   7902         MOV     R1,#0x2
   \   000024   E9           MOV     A,R1
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   12....       LCALL   ?Subroutine26 & 0xFFFF
   1071           	PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 4, ucComMF522Buf, & ulLen );
   \                     ??CrossCallReturnLabel_37:
   \   00002B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002E   7404         MOV     A,#0x4
   \   000030   12....       LCALL   ?XSTACK_DISP0_8
   \   000033   8582..       MOV     ?V0 + 0,DPL
   \   000036   8583..       MOV     ?V0 + 1,DPH
   \   000039   78..         MOV     R0,#?V0 + 0
   \   00003B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003E   7C04         MOV     R4,#0x4
   \   000040   7406         MOV     A,#0x6
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_65:
   \   000048   12....       LCALL   ?DEALLOC_XSTACK8
   1072          
   1073            return MI_OK;
   \   00004B   7926         MOV     R1,#0x26
   \   00004D   02....       LJMP    ?Subroutine2 & 0xFFFF
   1074          	
   1075          }
   1076          
   1077          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1078          void IC_CMT ( unsigned char * UID, unsigned char * KEY, unsigned char RW, unsigned char * Dat )
   \                     IC_CMT:
   1079          {
   \   000000   74F3         MOV     A,#-0xd
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 13
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 2,R2
   \   00000C   8B..         MOV     ?V0 + 3,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 4,R1
   \   000014   7411         MOV     A,#0x11
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 0,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 1,A
   1080            unsigned char ucArray_ID [ 4 ] = { 0 };//先后存放IC卡的类型和UID(IC卡序列号)
   \   000020   85..82       MOV     DPL,?XSP + 0
   \   000023   85..83       MOV     DPH,?XSP + 1
   \   000026   AC82         MOV     R4,DPL
   \   000028   AD83         MOV     R5,DPH
   \   00002A   7583..       MOV     DPH,#(`?<Constant {0}>` >> 8) & 0xff
   \   00002D   7582..       MOV     DPL,#`?<Constant {0}>` & 0xff
   \   000030   7404         MOV     A,#0x4
   \   000032   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
   1081            
   1082          	
   1083            PcdRequest ( 0x52, ucArray_ID );//寻卡
   \   000035                ; Setup parameters for call to function PcdRequest
   \   000035   85..82       MOV     DPL,?XSP + 0
   \   000038   85..83       MOV     DPH,?XSP + 1
   \   00003B   AA82         MOV     R2,DPL
   \   00003D   AB83         MOV     R3,DPH
   \   00003F   7952         MOV     R1,#0x52
   \   000041   12....       LCALL   ??PcdRequest?relay
   1084          
   1085            PcdAnticoll ( ucArray_ID );//防冲撞
   \   000044                ; Setup parameters for call to function PcdAnticoll
   \   000044   85..82       MOV     DPL,?XSP + 0
   \   000047   85..83       MOV     DPH,?XSP + 1
   \   00004A   AA82         MOV     R2,DPL
   \   00004C   AB83         MOV     R3,DPH
   \   00004E   12....       LCALL   ??PcdAnticoll?relay
   1086            
   1087            PcdSelect ( UID );//选定卡
   \   000051                ; Setup parameters for call to function PcdSelect
   \   000051   AA..         MOV     R2,?V0 + 2
   \   000053   AB..         MOV     R3,?V0 + 3
   \   000055   12....       LCALL   ??PcdSelect?relay
   1088            
   1089            PcdAuthState ( 0x60, 0x10, KEY, UID );//校验
   \   000058                ; Setup parameters for call to function PcdAuthState
   \   000058   78..         MOV     R0,#?V0 + 2
   \   00005A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005D   EE           MOV     A,R6
   \   00005E   FC           MOV     R4,A
   \   00005F   EF           MOV     A,R7
   \   000060   FD           MOV     R5,A
   \   000061   7A10         MOV     R2,#0x10
   \   000063   7960         MOV     R1,#0x60
   \   000065   12....       LCALL   ??PcdAuthState?relay
   \   000068   7402         MOV     A,#0x2
   \   00006A   12....       LCALL   ?DEALLOC_XSTACK8
   1090          	
   1091          
   1092          	if ( RW )//读写选择，1是读，0是写
   \   00006D   E5..         MOV     A,?V0 + 4
   \   00006F   AA..         MOV     R2,?V0 + 0
   \   000071   AB..         MOV     R3,?V0 + 1
   \   000073   7910         MOV     R1,#0x10
   \   000075   6005         JZ      ??IC_CMT_0
   1093              PcdRead ( 0x10, Dat );
   \   000077                ; Setup parameters for call to function PcdRead
   \   000077   12....       LCALL   ??PcdRead?relay
   \   00007A   8003         SJMP    ??IC_CMT_1
   1094             
   1095             else 
   1096               PcdWrite ( 0x10, Dat );
   \                     ??IC_CMT_0:
   \   00007C                ; Setup parameters for call to function PcdWrite
   \   00007C   12....       LCALL   ??PcdWrite?relay
   1097             
   1098          	 
   1099             PcdHalt ();
   \                     ??IC_CMT_1:
   \   00007F                ; Setup parameters for call to function PcdHalt
   \   00007F   12....       LCALL   ??PcdHalt?relay
   1100          	 
   1101          	 
   1102          }
   \   000082   7404         MOV     A,#0x4
   \   000084   12....       LCALL   ?DEALLOC_XSTACK8
   \   000087   7F05         MOV     R7,#0x5
   \   000089   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for pk>`:
   \   000000   FF           DB 255
   \   000001   FF           DB 255
   \   000002   FF           DB 255
   \   000003   FF           DB 255
   \   000004   FF           DB 255
   \   000005   FF           DB 255

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??RC522_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    RC522_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??DataRep?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    DataRep

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??RFID_GetCardID?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    RFID_GetCardID

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??IC_Card_Search?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    IC_Card_Search

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??IC_Card_Write?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    IC_Card_Write

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??IC_Card_Read?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    IC_Card_Read

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SPI_RC522_SendByte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SPI_RC522_SendByte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SPI_RC522_ReadByte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SPI_RC522_ReadByte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ReadRawRC?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ReadRawRC

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??WriteRawRC?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    WriteRawRC

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SetBitMask?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SetBitMask

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ClearBitMask?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ClearBitMask

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdAntennaOn?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdAntennaOn

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdAntennaOff?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdAntennaOff

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??RC522_InitStatus?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    RC522_InitStatus

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??M500PcdConfigISOType?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    M500PcdConfigISOType

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdComMF522?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdComMF522

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdAnticoll?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdAnticoll

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??CalulateCRC?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    CalulateCRC

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdSelect?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdSelect

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdAuthState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdAuthState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdWrite?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdWrite

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdRead?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdRead

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PcdHalt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PcdHalt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??IC_CMT?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    IC_CMT

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "get IC Card\\r\\n">`:
   \   000000   67657420     DB "get IC Card\015\012"
   \            49432043
   \            6172640D
   \            0A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "UUID=0x%x%x%x%x\\r\\n">`:
   \   000000   55554944     DB "UUID=0x%x%x%x%x\015\012"
   \            3D307825
   \            78257825
   \            7825780D
   \            0A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "read UUID failure\\r\\n">`:
   \   000000   72656164     DB "read UUID failure\015\012"
   \            20555549
   \            44206661
   \            696C7572
   \            650D0A00

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "lost IC Card\\r\\n">`:
   \   000000   6C6F7374     DB "lost IC Card\015\012"
   \            20494320
   \            43617264
   \            0D0A00  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "0x">`:
   \   000000   307800       DB "0x"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {0}>`:
   \   000000   00           DB 0
   \   000001   000000       DB 0, 0, 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_c8:
   \   000000   C8000000     DD 200

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1:
   \   000000   01000000     DD 1

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_64:
   \   000000   64000000     DD 100

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_2:
   \   000000   02000000     DD 2
   1103          
   1104          

   Maximum stack usage in bytes:

     Function                  ISTACK PSTACK XSTACK
     --------                  ------ ------ ------
     CalulateCRC                   1      0     46
       -> ClearBitMask             0      0     28
       -> WriteRawRC               0      0     28
       -> SetBitMask               0      0     28
       -> WriteRawRC               0      0     28
       -> WriteRawRC               0      0     28
       -> ReadRawRC                0      0     28
       -> ReadRawRC                0      0     28
       -> ReadRawRC                0      0     28
     ClearBitMask                  0      0     43
       -> ReadRawRC                0      0     18
       -> WriteRawRC               0      0     18
     DataRep                       1      0     19
     IC_CMT                        2      0     21
       -> PcdRequest               0      0     34
       -> PcdAnticoll              0      0     34
       -> PcdSelect                0      0     34
       -> PcdAuthState             0      0     38
       -> PcdRead                  0      0     34
       -> PcdWrite                 0      0     34
       -> PcdHalt                  0      0     34
     IC_Card_Read                  2      0      0
       -> PcdRead                  4      0      0
     IC_Card_Search                0      0     12
       -> PcdRequest               0      0     20
       -> PcdAnticoll              0      0     20
       -> PcdSelect                0      0     20
       -> PcdAuthState             0      0     24
       -> PcdRead                  0      0     20
       -> DataRep                  0      0     20
       -> DataRep                  0      0     20
       -> DataRep                  0      0     20
       -> DataRep                  0      0     20
       -> OLED_P8x16Str            0      0     20
       -> OLED_P8x16Str            0      0     20
       -> OLED_P6x8Str             0      0     20
       -> OLED_P6x8Str             0      0     20
     IC_Card_Write                 0      0     12
       -> PcdAnticoll              0      0     20
       -> PcdSelect                0      0     20
       -> PcdAuthState             0      0     24
       -> PcdWrite                 0      0     20
       -> PcdWrite                 0      0     20
     M500PcdConfigISOType          0      0      9
       -> ClearBitMask             0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> delay_us                 0      0     18
       -> PcdAntennaOn             0      0     18
     PcdAntennaOff                 2      0      0
       -> ClearBitMask             4      0      0
     PcdAntennaOn                  2      0      9
       -> ReadRawRC                4      0      0
       -> SetBitMask               4      0      0
     PcdAnticoll                   1      0     55
       -> ClearBitMask             0      0     68
       -> WriteRawRC               0      0     68
       -> ClearBitMask             0      0     68
       -> PcdComMF522              0      0     76
       -> SetBitMask               0      0     68
     PcdAuthState                  1      0     53
       -> PcdComMF522              0      0     68
       -> ReadRawRC                0      0     60
     PcdComMF522                   1      0     60
       -> WriteRawRC               0      0     44
       -> ClearBitMask             0      0     44
       -> WriteRawRC               0      0     44
       -> SetBitMask               0      0     44
       -> WriteRawRC               0      0     44
       -> WriteRawRC               0      0     44
       -> SetBitMask               0      0     44
       -> ReadRawRC                0      0     44
       -> ClearBitMask             0      0     44
       -> ReadRawRC                0      0     44
       -> ReadRawRC                0      0     44
       -> ReadRawRC                0      0     44
       -> ReadRawRC                0      0     44
       -> SetBitMask               0      0     44
       -> WriteRawRC               0      0     44
     PcdHalt                       0      0     51
       -> CalulateCRC              0      0     60
       -> PcdComMF522              0      0     68
     PcdRead                       1      0     52
       -> CalulateCRC              0      0     62
       -> PcdComMF522              0      0     70
     PcdRequest                    1      0     52
       -> ClearBitMask             0      0     62
       -> WriteRawRC               0      0     62
       -> SetBitMask               0      0     62
       -> PcdComMF522              0      0     70
     PcdReset                      0      0      9
       -> delay_us                 0      0     18
       -> delay_us                 0      0     18
       -> delay_us                 0      0     18
       -> WriteRawRC               0      0     18
       -> delay_ms                 0      0     18
       -> ReadRawRC                0      0     18
       -> delay_us                 0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> WriteRawRC               0      0     18
       -> delay_us                 0      0     18
     PcdSelect                     1      0     51
       -> CalulateCRC              0      0     60
       -> ClearBitMask             0      0     60
       -> PcdComMF522              0      0     68
     PcdWrite                      1      0     53
       -> CalulateCRC              0      0     64
       -> PcdComMF522              0      0     72
       -> CalulateCRC              0      0     64
       -> PcdComMF522              0      0     72
     RC522_Init                    2      0     10
       -> PcdReset                 4      0      0
       -> M500PcdConfigISOType     4      0      0
     RC522_InitStatus              2      0      0
     RFID_GetCardID                0      0     18
       -> RC522_Init               0      0     20
       -> PcdRequest               0      0     20
       -> PcdAnticoll              0      0     20
       -> printf                   0      0     20
       -> printf                   0      0     36
       -> printf                   0      0     20
       -> printf                   0      0     20
     ReadRawRC                     0      0     39
       -> SPI_RC522_SendByte       0      0     18
       -> SPI_RC522_ReadByte       0      0     18
     SPI_RC522_ReadByte            0      0     18
       -> delay_us                 0      0     18
       -> delay_us                 0      0     18
       -> delay_us                 0      0     18
     SPI_RC522_SendByte            0      0     18
       -> delay_us                 0      0     18
       -> delay_us                 0      0     18
       -> delay_us                 0      0     18
     SetBitMask                    0      0     43
       -> ReadRawRC                0      0     18
       -> WriteRawRC               0      0     18
     WriteRawRC                    0      0     43
       -> SPI_RC522_SendByte       0      0     18
       -> SPI_RC522_SendByte       0      0     18


   Segment part sizes:

     Function/Label                      Bytes
     --------------                      -----
     _A_P1                                  1
     P1SEL                                  1
     P1INP                                  1
     P1DIR                                  1
     icd                                    2
     i                                      1
     IC_Card_Exist                          1
     pk                                     6
     ucArray_ID                            16
     SendBuf                               33
     SendData                               9
     ucStatusReturn                         1
     date1                                 16
     RC522_Init                            35
     ?Subroutine0                           7
     DataRep                              175
     ?Subroutine27                          6
     ??Subroutine30_0                       5
     ?Subroutine9                           5
     RFID_GetCardID                       109
     ??Subroutine29_0                       5
     ?Subroutine16                         11
     ?Subroutine15                         17
     IC_Card_Search                       240
     ?Subroutine14                         14
     ?Subroutine8                          15
     ?Subroutine7                          15
     cStatus                                1
     IC_Card_Write                         76
     ?Subroutine18                         15
     IC_Card_Read                          12
     SPI_RC522_SendByte                    62
     ?Subroutine21                         11
     SPI_RC522_ReadByte                    55
     ReadRawRC                             21
     ?Subroutine5                           6
     WriteRawRC                            29
     ?Subroutine1                           6
     SetBitMask                            14
     ?Subroutine23                          1
     ??Subroutine32_0                       5
     ClearBitMask                          15
     PcdAntennaOn                          20
     PcdAntennaOff                         13
     InitStatus                             1
     RC522_InitStatus                      11
     PcdReset                             123
     ?Subroutine19                         32
     M500PcdConfigISOType                  55
     PcdComMF522                          421
     ?Subroutine20                         18
     PcdRequest                           126
     ?Subroutine3                          10
     ?Subroutine13                         16
     ?Subroutine24                          6
     ??Subroutine33_0                       6
     PcdAnticoll                          176
     ?Subroutine4                           5
     ?Subroutine10                          4
     ??Subroutine31_0                       4
     ?Subroutine11                          9
     ?Subroutine12                         10
     CalulateCRC                           95
     ?Subroutine22                         11
     ?Subroutine2                           5
     PcdSelect                            190
     PcdAuthState                         186
     ?Subroutine17                          9
     ?Subroutine6                          14
     PcdWrite                             254
     ?Subroutine25                         12
     ?Subroutine28                         14
     PcdRead                              138
     ?Subroutine26                         12
     PcdHalt                               80
     IC_CMT                               140
     ?<Initializer for pk>                  6
     ??RC522_Init?relay                     6
     ??DataRep?relay                        6
     ??RFID_GetCardID?relay                 6
     ??IC_Card_Search?relay                 6
     ??IC_Card_Write?relay                  6
     ??IC_Card_Read?relay                   6
     ??SPI_RC522_SendByte?relay             6
     ??SPI_RC522_ReadByte?relay             6
     ??ReadRawRC?relay                      6
     ??WriteRawRC?relay                     6
     ??SetBitMask?relay                     6
     ??ClearBitMask?relay                   6
     ??PcdAntennaOn?relay                   6
     ??PcdAntennaOff?relay                  6
     ??RC522_InitStatus?relay               6
     ??PcdReset?relay                       6
     ??M500PcdConfigISOType?relay           6
     ??PcdComMF522?relay                    6
     ??PcdRequest?relay                     6
     ??PcdAnticoll?relay                    6
     ??CalulateCRC?relay                    6
     ??PcdSelect?relay                      6
     ??PcdAuthState?relay                   6
     ??PcdWrite?relay                       6
     ??PcdRead?relay                        6
     ??PcdHalt?relay                        6
     ??IC_CMT?relay                         6
     ?<Constant "get IC Card\r\n">         14
     ?<Constant "UUID=0x%x%x%x%x\r\n">     18
     ?<Constant "read UUID failure\r\n">   20
     ?<Constant "lost IC Card\r\n">        15
     ?<Constant "0x">                       3
     ?<Constant {0}>                        4
     __Constant_c8                          4
     __Constant_1                           4
     __Constant_64                          4
     __Constant_2                           4

 
 3 212 bytes in segment BANKED_CODE
   162 bytes in segment BANK_RELAYS
     4 bytes in segment SFR_AN
     6 bytes in segment XDATA_I
     6 bytes in segment XDATA_ID
    90 bytes in segment XDATA_ROM_C
    81 bytes in segment XDATA_Z
 
 3 380 bytes of CODE  memory
    74 bytes of CONST memory (+ 16 bytes shared)
     0 bytes of DATA  memory (+  4 bytes shared)
    87 bytes of XDATA memory

Errors: none
Warnings: none
