///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V8.10.3.10338/W32 for 8051        26/Feb/2019  22:28:12 /
// Copyright 2004-2011 IAR Systems AB.                                        /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data_rom                                          /
//    Dptr setup         =  1,16                                              /
//    Source file        =  D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Components\HARDWARE\RC522.c                 /
//    Command line       =  -f D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\b /
//                          roadcast\Projects\zstack\Samples\SampleApp\CC2530 /
//                          DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg           /
//                          (-DCPU32MHZ -DROOT=__near_func -DBLINK_LEDS) -f   /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\Tools\CC2530DB\f8wConfig.cfg             /
//                          (-DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR     /
//                          -DDEFAULT_CHANLIST=0x00000800                     /
//                          -DZDAPP_CONFIG_PAN_ID=0xFF11                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3   /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40          /
//                          -DNWK_MAX_BINDING_ENTRIES=4                       /
//                          -DMAX_BINDING_CLUSTER_IDS=4                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DMAC_MAX_FRAME_SIZE=116       /
//                          "-DCONST=const __code" -DGENERIC=__generic        /
//                          -DRFD_RCVC_ALWAYS_ON=TRUE -DPOLL_RATE=1000        /
//                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)  /
//                          -DREJOIN_POLL_RATE=440 D:\ZigBee\KJXY-ZigBee\usef /
//                          ul_code\ZigBee-Ext\broadcast\Components\HARDWARE\ /
//                          RC522.c -D NWK_AUTO_POLL -D ZTOOL_P1 -D           /
//                          MT_SYS_FUNC -D MT_ZDO_FUNC -D                     /
//                          LCD_SUPPORTED=DEBUG -lC                           /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          EndDeviceEB-TeHu\List\ -lA                        /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          EndDeviceEB-TeHu\List\ --diag_suppress            /
//                          Pe001,Pa010 -o D:\ZigBee\KJXY-ZigBee\useful_code\ /
//                          ZigBee-Ext\broadcast\Projects\zstack\Samples\Samp /
//                          leApp\CC2530DB\EndDeviceEB-TeHu\Obj\ -e           /
//                          --no_unroll --no_inline --no_tbaa --debug         /
//                          --core=plain --dptr=16,1 --data_model=large       /
//                          --code_model=banked --calling_convention=xdata_re /
//                          entrant --place_constants=data_rom                /
//                          --nr_virtual_regs 16 -I                           /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                           -I D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\ /
//                          broadcast\Projects\zstack\Samples\SampleApp\CC253 /
//                          0DB\..\SOURCE\ -I D:\ZigBee\KJXY-ZigBee\useful_co /
//                          de\ZigBee-Ext\broadcast\Projects\zstack\Samples\S /
//                          ampleApp\CC2530DB\..\..\..\ZMAIN\TI2530DB\ -I     /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\MT\ -I                  /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\HAL\INCLUDE\ -I         /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\HAL\TARGET\CC2530EB\    /
//                          -I D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\b /
//                          roadcast\Projects\zstack\Samples\SampleApp\CC2530 /
//                          DB\..\..\..\..\..\COMPONENTS\OSAL\MCU\CCSOC\ -I   /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\OSAL\INCLUDE\ -I        /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\STACK\AF\ -I            /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\STACK\NWK\ -I           /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\STACK\SEC\ -I           /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\STACK\SAPI\ -I          /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\STACK\SYS\ -I           /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\STACK\ZDO\ -I           /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\ZMAC\F8W\ -I            /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\ZMAC\ -I                /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\SERVICES\SADDR\ -I      /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\SERVICES\SDATA\ -I      /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\MAC\INCLUDE\ -I         /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\MAC\HIGH_LEVEL\ -I      /
//                          D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          ..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\    /
//                          -I D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\b /
//                          roadcast\Projects\zstack\Samples\SampleApp\CC2530 /
//                          DB\..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\ /
//                          SINGLE_CHIP\ -I D:\ZigBee\KJXY-ZigBee\useful_code /
//                          \ZigBee-Ext\broadcast\Projects\zstack\Samples\Sam /
//                          pleApp\CC2530DB\..\..\..\..\..\COMPONENTS\HARDWAR /
//                          E\ -I D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ex /
//                          t\broadcast\Projects\zstack\Samples\SampleApp\CC2 /
//                          530DB\..\..\..\..\..\COMPONENTS\HARDWARE\MPU6050\ /
//                           -I D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\ /
//                          broadcast\Projects\zstack\Samples\SampleApp\CC253 /
//                          0DB\..\..\..\..\..\COMPONENTS\HARDWARE\MPU6050\eM /
//                          PL\ -Om                                           /
//    List file          =  D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broa /
//                          dcast\Projects\zstack\Samples\SampleApp\CC2530DB\ /
//                          EndDeviceEB-TeHu\List\RC522.s51                   /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME RC522

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?MOVE_LONG8_XDATA_XDATA
        EXTERN ?POP_BIT_ISP
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?S_SHL
        EXTERN ?V0
        EXTERN ?XLOAD_R2345
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN __INIT_XDATA_I
        EXTERN __INIT_XDATA_Z

        PUBLIC ??CalulateCRC?relay
        FUNCTION ??CalulateCRC?relay,0203H
        PUBLIC ??ClearBitMask?relay
        FUNCTION ??ClearBitMask?relay,0203H
        PUBLIC ??DataRep?relay
        FUNCTION ??DataRep?relay,0203H
        PUBLIC ??IC_CMT?relay
        FUNCTION ??IC_CMT?relay,0203H
        PUBLIC ??IC_Card_Read?relay
        FUNCTION ??IC_Card_Read?relay,0203H
        PUBLIC ??IC_Card_Search?relay
        FUNCTION ??IC_Card_Search?relay,0203H
        PUBLIC ??IC_Card_Write?relay
        FUNCTION ??IC_Card_Write?relay,0203H
        PUBLIC ??M500PcdConfigISOType?relay
        FUNCTION ??M500PcdConfigISOType?relay,0203H
        PUBLIC ??PcdAntennaOff?relay
        FUNCTION ??PcdAntennaOff?relay,0203H
        PUBLIC ??PcdAntennaOn?relay
        FUNCTION ??PcdAntennaOn?relay,0203H
        PUBLIC ??PcdAnticoll?relay
        FUNCTION ??PcdAnticoll?relay,0203H
        PUBLIC ??PcdAuthState?relay
        FUNCTION ??PcdAuthState?relay,0203H
        PUBLIC ??PcdComMF522?relay
        FUNCTION ??PcdComMF522?relay,0203H
        PUBLIC ??PcdHalt?relay
        FUNCTION ??PcdHalt?relay,0203H
        PUBLIC ??PcdRead?relay
        FUNCTION ??PcdRead?relay,0203H
        PUBLIC ??PcdRequest?relay
        FUNCTION ??PcdRequest?relay,0203H
        PUBLIC ??PcdReset?relay
        FUNCTION ??PcdReset?relay,0203H
        PUBLIC ??PcdSelect?relay
        FUNCTION ??PcdSelect?relay,0203H
        PUBLIC ??PcdWrite?relay
        FUNCTION ??PcdWrite?relay,0203H
        PUBLIC ??RC522_Init?relay
        FUNCTION ??RC522_Init?relay,0203H
        PUBLIC ??RC522_InitStatus?relay
        FUNCTION ??RC522_InitStatus?relay,0203H
        FUNCTION ??RC522_SPI_Config?relay,0203H
        PUBLIC ??RFID_GetCardID?relay
        FUNCTION ??RFID_GetCardID?relay,0203H
        PUBLIC ??ReadRawRC?relay
        FUNCTION ??ReadRawRC?relay,0203H
        PUBLIC ??SPI_RC522_ReadByte?relay
        FUNCTION ??SPI_RC522_ReadByte?relay,0203H
        PUBLIC ??SPI_RC522_SendByte?relay
        FUNCTION ??SPI_RC522_SendByte?relay,0203H
        PUBLIC ??SetBitMask?relay
        FUNCTION ??SetBitMask?relay,0203H
        PUBLIC ??WriteRawRC?relay
        FUNCTION ??WriteRawRC?relay,0203H
        PUBLIC CalulateCRC
        FUNCTION CalulateCRC,021203H
        ARGFRAME XSTACK, 32, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 14, STACK
        PUBLIC ClearBitMask
        FUNCTION ClearBitMask,021203H
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC DataRep
        FUNCTION DataRep,0203H
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 10, STACK
        PUBLIC IC_CMT
        FUNCTION IC_CMT,021203H
        ARGFRAME XSTACK, 2, STACK
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 19, STACK
        PUBLIC IC_Card_Exist
        PUBLIC IC_Card_Read
        FUNCTION IC_Card_Read,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC IC_Card_Search
        FUNCTION IC_Card_Search,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        PUBLIC IC_Card_Write
        FUNCTION IC_Card_Write,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        PUBLIC InitStatus
        PUBLIC M500PcdConfigISOType
        FUNCTION M500PcdConfigISOType,021203H
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBWEAK P1DIR
        PUBWEAK P1INP
        PUBWEAK P1SEL
        PUBLIC PcdAntennaOff
        FUNCTION PcdAntennaOff,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC PcdAntennaOn
        FUNCTION PcdAntennaOn,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC PcdAnticoll
        FUNCTION PcdAnticoll,021203H
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 35, STACK
        PUBLIC PcdAuthState
        FUNCTION PcdAuthState,021203H
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 34, STACK
        PUBLIC PcdComMF522
        FUNCTION PcdComMF522,021203H
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC PcdHalt
        FUNCTION PcdHalt,021203H
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 34, STACK
        PUBLIC PcdRead
        FUNCTION PcdRead,021203H
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 35, STACK
        PUBLIC PcdRequest
        FUNCTION PcdRequest,021203H
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 35, STACK
        PUBLIC PcdReset
        FUNCTION PcdReset,021203H
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC PcdSelect
        FUNCTION PcdSelect,021203H
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 34, STACK
        PUBLIC PcdWrite
        FUNCTION PcdWrite,021203H
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 36, STACK
        PUBLIC RC522_Init
        FUNCTION RC522_Init,021203H
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC RC522_InitStatus
        FUNCTION RC522_InitStatus,0203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        FUNCTION RC522_SPI_Config,0203H
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUBLIC RFID_GetCardID
        FUNCTION RFID_GetCardID,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        PUBLIC ReadRawRC
        FUNCTION ReadRawRC,021203H
        ARGFRAME XSTACK, 30, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC SPI_RC522_ReadByte
        FUNCTION SPI_RC522_ReadByte,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC SPI_RC522_SendByte
        FUNCTION SPI_RC522_SendByte,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC SendBuf
        PUBLIC SendData
        PUBLIC SetBitMask
        FUNCTION SetBitMask,021203H
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC WriteRawRC
        FUNCTION WriteRawRC,021203H
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBWEAK _A_P1
        PUBWEAK __Constant_1
        PUBWEAK __Constant_2
        PUBWEAK __Constant_64
        PUBWEAK __Constant_c8
        PUBLIC cStatus
        PUBLIC date1
        PUBLIC i
        PUBLIC icd
        PUBLIC pk
        PUBLIC ucArray_ID
        PUBLIC ucStatusReturn
        
        CFI Names cfiNames0
        CFI StackFrame CFA_SP SP IDATA
        CFI StackFrame CFA_PSP16 PSP16 XDATA
        CFI StackFrame CFA_XSP16 XSP16 XDATA
        CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
        CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
        CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
        CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
        CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
        CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
        CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
        CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
        CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
        CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
        CFI VirtualResource ?RET:24
        CFI Resource ?BRET_EXT:8
        CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
        CFI ResourceParts PSP16 PSPH, PSPL
        CFI ResourceParts XSP16 XSPH, XSPL
        CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
        CFI EndNames cfiNames0
        
        CFI Common cfiCommon0 Using cfiNames0
        CFI CodeAlign 1
        CFI DataAlign -1
        CFI ReturnAddress ?RET CODE
        CFI CFA_DOVERLAY Used
        CFI CFA_IOVERLAY Used
        CFI CFA_SP SP+-3
        CFI CFA_PSP16 PSP16+0
        CFI CFA_XSP16 XSP16+0
        CFI `PSW.CY` SameValue
        CFI `B.BR0` SameValue
        CFI `B.BR1` SameValue
        CFI `B.BR2` SameValue
        CFI `B.BR3` SameValue
        CFI `B.BR4` SameValue
        CFI `B.BR5` SameValue
        CFI `B.BR6` SameValue
        CFI `B.BR7` SameValue
        CFI `VB.BR8` SameValue
        CFI `VB.BR9` SameValue
        CFI `VB.BR10` SameValue
        CFI `VB.BR11` SameValue
        CFI `VB.BR12` SameValue
        CFI `VB.BR13` SameValue
        CFI `VB.BR14` SameValue
        CFI `VB.BR15` SameValue
        CFI VB SameValue
        CFI B Undefined
        CFI A Undefined
        CFI PSW SameValue
        CFI DPL0 SameValue
        CFI DPH0 SameValue
        CFI R0 Undefined
        CFI R1 Undefined
        CFI R2 Undefined
        CFI R3 Undefined
        CFI R4 Undefined
        CFI R5 Undefined
        CFI R6 SameValue
        CFI R7 SameValue
        CFI V0 SameValue
        CFI V1 SameValue
        CFI V2 SameValue
        CFI V3 SameValue
        CFI V4 SameValue
        CFI V5 SameValue
        CFI V6 SameValue
        CFI V7 SameValue
        CFI V8 SameValue
        CFI V9 SameValue
        CFI V10 SameValue
        CFI V11 SameValue
        CFI V12 SameValue
        CFI V13 SameValue
        CFI V14 SameValue
        CFI V15 SameValue
        CFI PSPH Undefined
        CFI PSPL Undefined
        CFI XSPH Undefined
        CFI XSPL Undefined
        CFI ?RET Concat
        CFI ?BRET_EXT Frame(CFA_SP, 3)
        CFI ?RET_HIGH Frame(CFA_SP, 2)
        CFI ?RET_LOW Frame(CFA_SP, 1)
        CFI EndCommon cfiCommon0
        
printf              SYMBOL "printf"
OLED_P8x16Str       SYMBOL "OLED_P8x16Str"
OLED_P6x8Str        SYMBOL "OLED_P6x8Str"
delay_us            SYMBOL "delay_us"
delay_ms            SYMBOL "delay_ms"
??OLED_P6x8Str?relay SYMBOL "?relay", OLED_P6x8Str
??OLED_P8x16Str?relay SYMBOL "?relay", OLED_P8x16Str
??delay_ms?relay    SYMBOL "?relay", delay_ms
??delay_us?relay    SYMBOL "?relay", delay_us
??printf?relay      SYMBOL "?relay", printf
CalulateCRC         SYMBOL "CalulateCRC"
??CalulateCRC?relay SYMBOL "?relay", CalulateCRC
ClearBitMask        SYMBOL "ClearBitMask"
??ClearBitMask?relay SYMBOL "?relay", ClearBitMask
DataRep             SYMBOL "DataRep"
??DataRep?relay     SYMBOL "?relay", DataRep
IC_CMT              SYMBOL "IC_CMT"
??IC_CMT?relay      SYMBOL "?relay", IC_CMT
IC_Card_Read        SYMBOL "IC_Card_Read"
??IC_Card_Read?relay SYMBOL "?relay", IC_Card_Read
IC_Card_Search      SYMBOL "IC_Card_Search"
??IC_Card_Search?relay SYMBOL "?relay", IC_Card_Search
IC_Card_Write       SYMBOL "IC_Card_Write"
??IC_Card_Write?relay SYMBOL "?relay", IC_Card_Write
M500PcdConfigISOType SYMBOL "M500PcdConfigISOType"
??M500PcdConfigISOType?relay SYMBOL "?relay", M500PcdConfigISOType
PcdAntennaOff       SYMBOL "PcdAntennaOff"
??PcdAntennaOff?relay SYMBOL "?relay", PcdAntennaOff
PcdAntennaOn        SYMBOL "PcdAntennaOn"
??PcdAntennaOn?relay SYMBOL "?relay", PcdAntennaOn
PcdAnticoll         SYMBOL "PcdAnticoll"
??PcdAnticoll?relay SYMBOL "?relay", PcdAnticoll
PcdAuthState        SYMBOL "PcdAuthState"
??PcdAuthState?relay SYMBOL "?relay", PcdAuthState
PcdComMF522         SYMBOL "PcdComMF522"
??PcdComMF522?relay SYMBOL "?relay", PcdComMF522
PcdHalt             SYMBOL "PcdHalt"
??PcdHalt?relay     SYMBOL "?relay", PcdHalt
PcdRead             SYMBOL "PcdRead"
??PcdRead?relay     SYMBOL "?relay", PcdRead
PcdRequest          SYMBOL "PcdRequest"
??PcdRequest?relay  SYMBOL "?relay", PcdRequest
PcdReset            SYMBOL "PcdReset"
??PcdReset?relay    SYMBOL "?relay", PcdReset
PcdSelect           SYMBOL "PcdSelect"
??PcdSelect?relay   SYMBOL "?relay", PcdSelect
PcdWrite            SYMBOL "PcdWrite"
??PcdWrite?relay    SYMBOL "?relay", PcdWrite
RC522_Init          SYMBOL "RC522_Init"
??RC522_Init?relay  SYMBOL "?relay", RC522_Init
RC522_InitStatus    SYMBOL "RC522_InitStatus"
??RC522_InitStatus?relay SYMBOL "?relay", RC522_InitStatus
RFID_GetCardID      SYMBOL "RFID_GetCardID"
??RFID_GetCardID?relay SYMBOL "?relay", RFID_GetCardID
ReadRawRC           SYMBOL "ReadRawRC"
??ReadRawRC?relay   SYMBOL "?relay", ReadRawRC
SPI_RC522_ReadByte  SYMBOL "SPI_RC522_ReadByte"
??SPI_RC522_ReadByte?relay SYMBOL "?relay", SPI_RC522_ReadByte
SPI_RC522_SendByte  SYMBOL "SPI_RC522_SendByte"
??SPI_RC522_SendByte?relay SYMBOL "?relay", SPI_RC522_SendByte
SetBitMask          SYMBOL "SetBitMask"
??SetBitMask?relay  SYMBOL "?relay", SetBitMask
WriteRawRC          SYMBOL "WriteRawRC"
??WriteRawRC?relay  SYMBOL "?relay", WriteRawRC

        EXTERN printf
        FUNCTION printf,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN OLED_P8x16Str
        FUNCTION OLED_P8x16Str,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN OLED_P6x8Str
        FUNCTION OLED_P6x8Str,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN delay_us
        FUNCTION delay_us,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN delay_ms
        FUNCTION delay_ms,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ??OLED_P6x8Str?relay
        FUNCTION ??OLED_P6x8Str?relay,00H
        EXTERN ??OLED_P8x16Str?relay
        FUNCTION ??OLED_P8x16Str?relay,00H
        EXTERN ??delay_ms?relay
        FUNCTION ??delay_ms?relay,00H
        EXTERN ??delay_us?relay
        FUNCTION ??delay_us?relay,00H
        EXTERN ??printf?relay
        FUNCTION ??printf?relay,00H

// D:\ZigBee\KJXY-ZigBee\useful_code\ZigBee-Ext\broadcast\Components\HARDWARE\RC522.c
//    1 #include "RC522.h"

        ASEGN SFR_AN:DATA:NOROOT,090H
// union <unnamed> volatile __sfr _A_P1
_A_P1:
        DATA8
        DS 1

        ASEGN SFR_AN:DATA:NOROOT,0f4H
// unsigned char volatile __sfr P1SEL
P1SEL:
        DATA8
        DS 1

        ASEGN SFR_AN:DATA:NOROOT,0f6H
// unsigned char volatile __sfr P1INP
P1INP:
        DATA8
        DS 1

        ASEGN SFR_AN:DATA:NOROOT,0feH
// unsigned char volatile __sfr P1DIR
P1DIR:
        DATA8
        DS 1
//    2 #include "stdio.h"
//    3 #include "stdlib.h"
//    4 #include "string.h"
//    5 #include "OLED.h"
//    6 #include "delay.h"
//    7 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA16
//    8 int icd  = 0;
icd:
        DS 2
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//    9 uint8 i = 0;
i:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   10 uint8 IC_Card_Exist = 0;
IC_Card_Exist:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_I:XDATA:NOROOT(0)
//   11 unsigned char pk[6] ={0xff,0xff,0xff,0xff,0xff,0xff};     
pk:
        DATA8
        DS 6
        REQUIRE `?<Initializer for pk>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   12 unsigned char ucArray_ID [ 16 ] = {0,0,0,0};//先后存放IC卡的类型和UID(IC卡序列号)
ucArray_ID:
        DS 16
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   13 uint8 SendBuf[33];
SendBuf:
        DS 33
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   14 uint8 SendData[9];
SendData:
        DS 9
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   15 unsigned char ucStatusReturn;  //返回状态
ucStatusReturn:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   16 unsigned char date1[16] = {0x00};
date1:
        DS 16
        REQUIRE __INIT_XDATA_Z
//   17 static void RC522_SPI_Config( void );
//   18 
//   19 //==========================================================
//   20 //	函数名称：	RC522_Init
//   21 //
//   22 //	函数功能：	RC522初始化函数
//   23 //
//   24 //	入口参数：	无
//   25 //
//   26 //	返回参数：	无
//   27 //
//   28 //	说明：		
//   29 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//   30 void RC522_Init ( void )
RC522_Init:
        CFI Block cfiBlock0 Using cfiCommon0
        CFI Function RC522_Init
        CODE
//   31 {
        FUNCALL RC522_Init, RC522_SPI_Config
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RC522_Init, PcdReset
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RC522_Init, M500PcdConfigISOType
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//   32     RC522_SPI_Config ();
        ; Setup parameters for call to function RC522_SPI_Config
        LCALL   ??RC522_SPI_Config?relay
//   33     
//   34     macRC522_Reset_Disable();
        SETB    0x90.1
        SETB    0x90.1
//   35     
//   36     macRC522_CS_Disable();
        SETB    0x90.4
        SETB    0x90.4
//   37     
//   38     PcdReset();
        ; Setup parameters for call to function PcdReset
        LCALL   ??PcdReset?relay
//   39     M500PcdConfigISOType ( 'A' );//设置工作模式    
        ; Setup parameters for call to function M500PcdConfigISOType
        MOV     R1,#0x41
        LCALL   ??M500PcdConfigISOType?relay
//   40 }
        POP     DPH
        CFI DPH0 SameValue
        CFI CFA_SP SP+-4
        POP     DPL
        CFI DPL0 SameValue
        CFI CFA_SP SP+-3
        LJMP    ?BRET
        CFI EndBlock cfiBlock0
        REQUIRE _A_P1
//   41 
//   42 //==========================================================
//   43 //	函数名称：	DataRep()
//   44 //
//   45 //	函数功能：	显示数据装换
//   46 //
//   47 //	入口参数：	无
//   48 //
//   49 //	返回参数：	无
//   50 //
//   51 //	说明：		
//   52 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//   53 void DataRep(uint8 data,uint8 num,uint8 flag,uint8 flg)
DataRep:
        CFI Block cfiBlock1 Using cfiCommon0
        CFI Function DataRep
        CODE
//   54 {
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
        MOV     A,R1
        MOV     R5,A
//   55   if(flg)
        MOV     A,R4
        JNZ     $+5
        LJMP    ??DataRep_0 & 0xFFFF
//   56   {
//   57     switch(data)
        MOV     A,R5
        ADD     A,#-0xa
        JZ      ??DataRep_1
        DEC     A
        JZ      ??DataRep_2
        DEC     A
        JZ      ??DataRep_3
        DEC     A
        JZ      ??DataRep_4
        DEC     A
        JZ      ??DataRep_5
        DEC     A
        JZ      ??DataRep_6
        SJMP    ??DataRep_7
//   58     {
//   59       case 0x0A:
//   60         SendData[num] = 65;
??DataRep_1:
        MOV     ?V0 + 0,R2
        MOV     A,#SendData & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendData >> 8) & 0xff
??DataRep_8:
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x41
        LJMP    ??DataRep_9 & 0xFFFF
//   61         break;
//   62       case 0x0B:
//   63         SendData[num] = 66;
??DataRep_2:
        MOV     ?V0 + 0,R2
        MOV     A,#SendData & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendData >> 8) & 0xff
??DataRep_10:
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x42
        LJMP    ??DataRep_9 & 0xFFFF
//   64         break;
//   65       case 0x0C:
//   66         SendData[num] = 67;
??DataRep_3:
        MOV     ?V0 + 0,R2
        MOV     A,#SendData & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendData >> 8) & 0xff
??DataRep_11:
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x43
        LJMP    ??DataRep_9 & 0xFFFF
//   67         break;
//   68       case 0x0D:
//   69         SendData[num] = 68;
??DataRep_4:
        MOV     ?V0 + 0,R2
        MOV     A,#SendData & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendData >> 8) & 0xff
??DataRep_12:
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x44
        LJMP    ??DataRep_9 & 0xFFFF
//   70         break;
//   71       case 0x0E:
//   72         SendData[num] = 69;
??DataRep_5:
        MOV     ?V0 + 0,R2
        MOV     A,#SendData & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendData >> 8) & 0xff
??DataRep_13:
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x45
        LJMP    ??DataRep_9 & 0xFFFF
//   73         break; 
//   74       case 0x0F:
//   75         SendData[num] = 70;
??DataRep_6:
        MOV     ?V0 + 0,R2
        MOV     A,#SendData & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendData >> 8) & 0xff
??DataRep_14:
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x46
        LJMP    ??DataRep_9 & 0xFFFF
//   76         break; 
//   77       default:
//   78         if(flag)
??DataRep_7:
        MOV     A,R2
        CLR     C
        RRC     A
        MOV     R0,A
        MOV     A,#ucArray_ID & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(ucArray_ID >> 8) & 0xff
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R6,A
        MOV     DPL,R2
        MOV     R0,DPL
        MOV     A,#SendData & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(SendData >> 8) & 0xff
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,R3
        JZ      ??DataRep_15
//   79         {
//   80           SendData[num] = (ucArray_ID[(num/2)]>>4)+0x30;
??DataRep_16:
        MOV     A,R6
        SWAP    A
        ANL     A,#0xf
        LJMP    ??DataRep_17 & 0xFFFF
//   81         }
//   82         else
//   83         {
//   84           SendData[num] = (ucArray_ID[(num/2)]&0x0f)+0x30;
??DataRep_15:
        LJMP    ??DataRep_18 & 0xFFFF
//   85         }     
//   86       break;
//   87     } 
//   88   }
//   89   else
//   90   {
//   91     switch(data)
??DataRep_0:
        MOV     A,R5
        ADD     A,#-0xa
        JZ      ??DataRep_19
        DEC     A
        JZ      ??DataRep_20
        DEC     A
        JZ      ??DataRep_21
        DEC     A
        JZ      ??DataRep_22
        DEC     A
        JZ      ??DataRep_23
        DEC     A
        JZ      ??DataRep_24
        SJMP    ??DataRep_25
//   92     {
//   93       case 0x0A:
//   94         SendBuf[num] = 65;
??DataRep_19:
        MOV     ?V0 + 0,R2
        MOV     A,#SendBuf & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendBuf >> 8) & 0xff
        LJMP    ??DataRep_8 & 0xFFFF
//   95         break;
//   96       case 0x0B:
//   97         SendBuf[num] = 66;
??DataRep_20:
        MOV     ?V0 + 0,R2
        MOV     A,#SendBuf & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendBuf >> 8) & 0xff
        LJMP    ??DataRep_10 & 0xFFFF
//   98         break;
//   99       case 0x0C:
//  100         SendBuf[num] = 67;
??DataRep_21:
        MOV     ?V0 + 0,R2
        MOV     A,#SendBuf & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendBuf >> 8) & 0xff
        LJMP    ??DataRep_11 & 0xFFFF
//  101         break;
//  102       case 0x0D:
//  103         SendBuf[num] = 68;
??DataRep_22:
        MOV     ?V0 + 0,R2
        MOV     A,#SendBuf & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendBuf >> 8) & 0xff
        LJMP    ??DataRep_12 & 0xFFFF
//  104         break;
//  105       case 0x0E:
//  106         SendBuf[num] = 69;
??DataRep_23:
        MOV     ?V0 + 0,R2
        MOV     A,#SendBuf & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendBuf >> 8) & 0xff
        LJMP    ??DataRep_13 & 0xFFFF
//  107         break; 
//  108       case 0x0F:
//  109         SendBuf[num] = 70;
??DataRep_24:
        MOV     ?V0 + 0,R2
        MOV     A,#SendBuf & 0xff
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,#(SendBuf >> 8) & 0xff
        LJMP    ??DataRep_14 & 0xFFFF
//  110         break; 
//  111       default:
//  112         if(flag)
??DataRep_25:
        MOV     A,R2
        CLR     C
        RRC     A
        MOV     R0,A
        MOV     A,#date1 & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(date1 >> 8) & 0xff
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R6,A
        MOV     DPL,R2
        MOV     R0,DPL
        MOV     A,#SendBuf & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(SendBuf >> 8) & 0xff
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,R3
        JZ      $+5
        LJMP    ??DataRep_16 & 0xFFFF
//  113         {
//  114           SendBuf[num] = (date1[(num/2)]>>4)+0x30;
//  115         }
//  116         else
//  117         {
//  118           SendBuf[num] = (date1[(num/2)]&0x0f)+0x30;
??DataRep_18:
        MOV     A,#0xf
        ANL     A,R6
??DataRep_17:
        ADD     A,#0x30
??DataRep_9:
        MOVX    @DPTR,A
//  119         }     
//  120       break;
//  121     }
//  122   }
//  123 }
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock1
//  124 //==========================================================
//  125 //	函数名称：	IC_Card_Search
//  126 //
//  127 //	函数功能：	读IC卡
//  128 //
//  129 //	入口参数：	无
//  130 //
//  131 //	返回参数：	无
//  132 //
//  133 //	说明：		
//  134 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  135 uint8* RFID_GetCardID(void)
RFID_GetCardID:
        CFI Block cfiBlock2 Using cfiCommon0
        CFI Function RFID_GetCardID
        CODE
//  136 {    
        FUNCALL RFID_GetCardID, RC522_Init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RFID_GetCardID, PcdRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RFID_GetCardID, PcdAnticoll
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RFID_GetCardID, printf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RFID_GetCardID, printf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RFID_GetCardID, printf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL RFID_GetCardID, printf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
//  137     RC522_Init();
        ; Setup parameters for call to function RC522_Init
        LCALL   ??RC522_Init?relay
//  138     ucStatusReturn = PcdRequest ( PICC_REQALL, ucArray_ID );
        ; Setup parameters for call to function PcdRequest
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        MOV     R1,#0x52
        LCALL   ??PcdRequest?relay
        MOV     A,R1
        MOV     DPTR,#ucStatusReturn
        MOVX    @DPTR,A
//  139 
//  140     if ((ucStatusReturn == MI_OK ))
        MOVX    A,@DPTR
        XRL     A,#0x26
        JNZ     ??RFID_GetCardID_0
//  141     {
//  142       if (PcdAnticoll(ucArray_ID) == MI_OK)
        ; Setup parameters for call to function PcdAnticoll
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        LCALL   ??PcdAnticoll?relay
        MOV     A,R1
        XRL     A,#0x26
        JNZ     ??RFID_GetCardID_1
//  143       {
//  144         printf("get IC Card\r\n");
        ; Setup parameters for call to function printf
        MOV     R2,#`?<Constant "get IC Card\\r\\n">` & 0xff
        MOV     R3,#(`?<Constant "get IC Card\\r\\n">` >> 8) & 0xff
        LCALL   ??printf?relay
//  145         printf("UUID=0x%x%x%x%x\r\n",ucArray_ID[0],ucArray_ID[1],ucArray_ID[2],ucArray_ID[3]);
        ; Setup parameters for call to function printf
        MOV     DPTR,#ucArray_ID + 3
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     DPTR,#ucArray_ID + 2
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 14)
        MOV     DPTR,#ucArray_ID + 1
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     DPTR,#ucArray_ID
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     R2,#`?<Constant "UUID=0x%x%x%x%x\\r\\n">` & 0xff
        MOV     R3,#(`?<Constant "UUID=0x%x%x%x%x\\r\\n">` >> 8) & 0xff
        LCALL   ??printf?relay
        MOV     A,#0x8
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
//  146         return &ucArray_ID[0];
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        SJMP    ??RFID_GetCardID_2
//  147       }
//  148       else
//  149       {
//  150         printf("read UUID failure\r\n");
??RFID_GetCardID_1:
        ; Setup parameters for call to function printf
        MOV     R2,#`?<Constant "read UUID failure\\r\\n">` & 0xff
        MOV     R3,#(`?<Constant "read UUID failure\\r\\n">` >> 8) & 0xff
        SJMP    ??RFID_GetCardID_3
//  151         return (uint8*)0;
//  152       }
//  153     }
//  154     else
//  155     {
//  156       printf("lost IC Card\r\n");
??RFID_GetCardID_0:
        ; Setup parameters for call to function printf
        MOV     R2,#`?<Constant "lost IC Card\\r\\n">` & 0xff
        MOV     R3,#(`?<Constant "lost IC Card\\r\\n">` >> 8) & 0xff
??RFID_GetCardID_3:
        LCALL   ??printf?relay
//  157       return (uint8*)0;
        MOV     R2,#0x0
        MOV     R3,#0x0
??RFID_GetCardID_2:
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock2
//  158     }
//  159 }
//  160 //==========================================================
//  161 //	函数名称：	IC_Card_Search
//  162 //
//  163 //	函数功能：	读IC卡
//  164 //
//  165 //	入口参数：	无
//  166 //
//  167 //	返回参数：	无
//  168 //
//  169 //	说明：		
//  170 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  171 void IC_Card_Search ( void )
IC_Card_Search:
        CFI Block cfiBlock3 Using cfiCommon0
        CFI Function IC_Card_Search
        CODE
//  172 {
        FUNCALL IC_Card_Search, PcdRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, PcdAnticoll
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, PcdSelect
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, PcdAuthState
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, PcdRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, DataRep
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, DataRep
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, DataRep
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, DataRep
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, OLED_P8x16Str
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, OLED_P8x16Str
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, OLED_P6x8Str
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Search, OLED_P6x8Str
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
//  173     SendData[8] = 0;
        MOV     DPTR,#SendData + 8
        CLR     A
        MOVX    @DPTR,A
//  174     SendBuf[32] = 0;
        MOV     DPTR,#SendBuf + 32
        MOVX    @DPTR,A
//  175     ucStatusReturn = PcdRequest ( PICC_REQALL, ucArray_ID );//若失败再次寻卡
        ; Setup parameters for call to function PcdRequest
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        MOV     R1,#0x52
        LCALL   ??PcdRequest?relay
        MOV     A,R1
        MOV     DPTR,#ucStatusReturn
        MOVX    @DPTR,A
//  176     
//  177     if ((ucStatusReturn == MI_OK )&&(IC_Card_Exist == 0))
        MOVX    A,@DPTR
        XRL     A,#0x26
        JZ      $+5
        LJMP    ??IC_Card_Search_0 & 0xFFFF
        MOV     DPTR,#IC_Card_Exist
        MOVX    A,@DPTR
        JZ      $+5
        LJMP    ??IC_Card_Search_0 & 0xFFFF
//  178     {
//  179         if (PcdAnticoll(ucArray_ID) == MI_OK)  //防冲撞（当有多张卡进入读写器操作范围时，防冲突机制会从其中选择一张进行操作）
        ; Setup parameters for call to function PcdAnticoll
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        LCALL   ??PcdAnticoll?relay
        MOV     A,R1
        XRL     A,#0x26
        JZ      $+5
        LJMP    ??IC_Card_Search_0 & 0xFFFF
//  180         {               
//  181             if (PcdSelect(ucArray_ID) == MI_OK)//选择ucArray_ID的卡
        ; Setup parameters for call to function PcdSelect
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        LCALL   ??PcdSelect?relay
        MOV     A,R1
        XRL     A,#0x26
        JZ      $+5
        LJMP    ??IC_Card_Search_0 & 0xFFFF
//  182             {
//  183                 IC_Card_Exist = 1;
        MOV     DPTR,#IC_Card_Exist
        MOV     A,#0x1
        MOVX    @DPTR,A
//  184                 if (PcdAuthState(0x61,0x5,pk,ucArray_ID) == MI_OK)//申请对卡的授权  
        ; Setup parameters for call to function PcdAuthState
        MOV     ?V0 + 0,#ucArray_ID & 0xff
        MOV     ?V0 + 1,#(ucArray_ID >> 8) & 0xff
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     R4,#pk & 0xff
        MOV     R5,#(pk >> 8) & 0xff
        MOV     R2,#0x5
        MOV     R1,#0x61
        LCALL   ??PcdAuthState?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        MOV     A,R1
        XRL     A,#0x26
        JZ      $+5
        LJMP    ??IC_Card_Search_0 & 0xFFFF
//  185                 {
//  186                     if (PcdRead(0x5,date1) == MI_OK )
        ; Setup parameters for call to function PcdRead
        MOV     R2,#date1 & 0xff
        MOV     R3,#(date1 >> 8) & 0xff
        MOV     R1,#0x5
        LCALL   ??PcdRead?relay
        MOV     A,R1
        XRL     A,#0x26
        JZ      $+5
        LJMP    ??IC_Card_Search_0 & 0xFFFF
//  187                     {   
//  188                         for(i = 0;i < 8;i ++)
        MOV     DPTR,#i
        CLR     A
        SJMP    ??IC_Card_Search_1
//  189                         {
//  190                           if(i%2==0)
//  191                           {
//  192                              DataRep((ucArray_ID[(i/2)]>>4),i,1,1);
//  193                           }
//  194                           else
//  195                           {
//  196                             DataRep((ucArray_ID[(i/2)]&0x0f),i,0,1);
??IC_Card_Search_2:
        ; Setup parameters for call to function DataRep
        MOV     R3,#0x0
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     A,#0xf
        ANL     A,R0
??IC_Card_Search_3:
        MOV     R1,A
        LCALL   ??DataRep?relay
//  197                           }                         
        MOV     DPTR,#i
        MOVX    A,@DPTR
        INC     A
??IC_Card_Search_1:
        MOVX    @DPTR,A
        MOVX    A,@DPTR
        CLR     C
        SUBB    A,#0x8
        JNC     ??IC_Card_Search_4
        MOVX    A,@DPTR
        CLR     C
        RRC     A
        MOV     R0,A
        MOV     A,#ucArray_ID & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(ucArray_ID >> 8) & 0xff
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     DPTR,#i
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.0
        MOV     R4,#0x1
        JC      ??IC_Card_Search_2
        ; Setup parameters for call to function DataRep
        MOV     R3,#0x1
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     A,R0
        SWAP    A
        ANL     A,#0xf
        SJMP    ??IC_Card_Search_3
//  198                         }
//  199                         
//  200                         
//  201                         for(i = 0;i < 32;i ++)
??IC_Card_Search_4:
        CLR     A
        SJMP    ??IC_Card_Search_5
//  202                         {
//  203                           if(i%2==0)
//  204                           {
//  205                              DataRep((date1[(i/2)]>>4),i,1,0);
//  206                           }
//  207                           else
//  208                           {
//  209                             DataRep((date1[(i/2)]&0x0f),i,0,0);
??IC_Card_Search_6:
        ; Setup parameters for call to function DataRep
        MOV     R3,#0x0
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     A,#0xf
        ANL     A,R0
??IC_Card_Search_7:
        MOV     R1,A
        LCALL   ??DataRep?relay
//  210                           }                         
        MOV     DPTR,#i
        MOVX    A,@DPTR
        INC     A
??IC_Card_Search_5:
        MOVX    @DPTR,A
        MOVX    A,@DPTR
        CLR     C
        SUBB    A,#0x20
        JNC     ??IC_Card_Search_8
        MOVX    A,@DPTR
        CLR     C
        RRC     A
        MOV     R0,A
        MOV     A,#date1 & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(date1 >> 8) & 0xff
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     DPTR,#i
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.0
        MOV     R4,#0x0
        JC      ??IC_Card_Search_6
        ; Setup parameters for call to function DataRep
        MOV     R3,#0x1
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     A,R0
        SWAP    A
        ANL     A,#0xf
        SJMP    ??IC_Card_Search_7
//  211                         }
//  212                         OLED_P8x16Str(41,2,"0x");
??IC_Card_Search_8:
        ; Setup parameters for call to function OLED_P8x16Str
        MOV     R4,#`?<Constant "0x">` & 0xff
        MOV     R5,#(`?<Constant "0x">` >> 8) & 0xff
        MOV     R2,#0x2
        MOV     R1,#0x29
        LCALL   ??OLED_P8x16Str?relay
//  213                         OLED_P8x16Str(58,2,SendData);
        ; Setup parameters for call to function OLED_P8x16Str
        MOV     R4,#SendData & 0xff
        MOV     R5,#(SendData >> 8) & 0xff
        MOV     R2,#0x2
        MOV     R1,#0x3a
        LCALL   ??OLED_P8x16Str?relay
//  214                         OLED_P6x8Str(1,6,"0x");
        ; Setup parameters for call to function OLED_P6x8Str
        MOV     R4,#`?<Constant "0x">` & 0xff
        MOV     R5,#(`?<Constant "0x">` >> 8) & 0xff
        MOV     R2,#0x6
        MOV     R1,#0x1
        LCALL   ??OLED_P6x8Str?relay
//  215                         OLED_P6x8Str(15,6,SendBuf);
        ; Setup parameters for call to function OLED_P6x8Str
        MOV     R4,#SendBuf & 0xff
        MOV     R5,#(SendBuf >> 8) & 0xff
        MOV     R2,#0x6
        MOV     R1,#0xf
        LCALL   ??OLED_P6x8Str?relay
//  216                     }
//  217                 }
//  218             }
//  219         }
//  220     }
//  221     
//  222     if(ucStatusReturn != MI_OK)//无卡
??IC_Card_Search_0:
        MOV     DPTR,#ucStatusReturn
        MOVX    A,@DPTR
        XRL     A,#0x26
        JZ      ??IC_Card_Search_9
//  223     {
//  224         IC_Card_Exist = 0;
        MOV     DPTR,#IC_Card_Exist
        CLR     A
        MOVX    @DPTR,A
//  225     }
//  226 }
??IC_Card_Search_9:
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock3
//  227 //==========================================================
//  228 //	函数名称：	IC_Card_Write
//  229 //
//  230 //	函数功能：	向IC卡里写数据
//  231 //
//  232 //	入口参数：	无
//  233 //
//  234 //	返回参数：	无
//  235 //
//  236 //	说明：		
//  237 //==========================================================

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  238 uint8 cStatus;
cStatus:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  239 uint8 IC_Card_Write(uint8 *p)
IC_Card_Write:
        CFI Block cfiBlock4 Using cfiCommon0
        CFI Function IC_Card_Write
        CODE
//  240 {
        FUNCALL IC_Card_Write, PcdAnticoll
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Write, PcdSelect
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Write, PcdAuthState
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Write, PcdWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_Card_Write, PcdWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  241     if (PcdAnticoll(ucArray_ID) == MI_OK)  //防冲撞（当有多张卡进入读写器操作范围时，防冲突机制会从其中选择一张进行操作）
        ; Setup parameters for call to function PcdAnticoll
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        LCALL   ??PcdAnticoll?relay
        MOV     A,R1
        XRL     A,#0x26
        JNZ     ??IC_Card_Write_0
//  242     {               
//  243         if (PcdSelect(ucArray_ID) == MI_OK)//选择ucArray_ID的卡
        ; Setup parameters for call to function PcdSelect
        MOV     R2,#ucArray_ID & 0xff
        MOV     R3,#(ucArray_ID >> 8) & 0xff
        LCALL   ??PcdSelect?relay
        MOV     A,R1
        XRL     A,#0x26
        JNZ     ??IC_Card_Write_0
//  244         {
//  245             if (PcdAuthState(0x61,0x5,pk,ucArray_ID) == MI_OK)//申请对卡的授权  
        ; Setup parameters for call to function PcdAuthState
        MOV     ?V0 + 0,#ucArray_ID & 0xff
        MOV     ?V0 + 1,#(ucArray_ID >> 8) & 0xff
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     R4,#pk & 0xff
        MOV     R5,#(pk >> 8) & 0xff
        MOV     R2,#0x5
        MOV     R1,#0x61
        LCALL   ??PcdAuthState?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        MOV     A,R1
        XRL     A,#0x26
        JNZ     ??IC_Card_Write_0
//  246             {
//  247                 cStatus = PcdWrite(0x5,p);
        ; Setup parameters for call to function PcdWrite
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        MOV     R1,#0x5
        LCALL   ??PcdWrite?relay
        MOV     A,R1
        MOV     DPTR,#cStatus
        MOVX    @DPTR,A
//  248                 if(cStatus == MI_ERR)
        MOVX    A,@DPTR
        XRL     A,#0xbb
        JNZ     ??IC_Card_Write_0
//  249                 {//如果写失败在写一次
//  250                     cStatus = PcdWrite(0x5,p);
        ; Setup parameters for call to function PcdWrite
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        MOV     R1,#0x5
        LCALL   ??PcdWrite?relay
        MOV     A,R1
        MOV     DPTR,#cStatus
        MOVX    @DPTR,A
//  251                 }
//  252             }
//  253         }
//  254     }
//  255     return cStatus;
??IC_Card_Write_0:
        MOV     DPTR,#cStatus
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock4
//  256 }
//  257 //==========================================================
//  258 //	函数名称：	IC_Card_Read
//  259 //
//  260 //	函数功能：	从IC卡里计出数据
//  261 //
//  262 //	入口参数：	无
//  263 //
//  264 //	返回参数：	无
//  265 //
//  266 //	说明：		
//  267 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  268 void IC_Card_Read(uint8 *p)
IC_Card_Read:
        CFI Block cfiBlock5 Using cfiCommon0
        CFI Function IC_Card_Read
        CODE
//  269 {
        FUNCALL IC_Card_Read, PcdRead
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  270      PcdRead(0X5,p);
        ; Setup parameters for call to function PcdRead
        MOV     R1,#0x5
        LCALL   ??PcdRead?relay
//  271 }
        POP     DPH
        CFI DPH0 SameValue
        CFI CFA_SP SP+-4
        POP     DPL
        CFI DPL0 SameValue
        CFI CFA_SP SP+-3
        LJMP    ?BRET
        CFI EndBlock cfiBlock5
//  272 //==========================================================
//  273 //	函数名称：	RC522_SPI_Config
//  274 //
//  275 //	函数功能：	RC522 SPI初始化
//  276 //
//  277 //	入口参数：	无
//  278 //
//  279 //	返回参数：	无
//  280 //
//  281 //	说明：		
//  282 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  283 static void RC522_SPI_Config ( void )
RC522_SPI_Config:
        CFI Block cfiBlock6 Using cfiCommon0
        CFI Function RC522_SPI_Config
        CODE
//  284 {     
        ; Saved register size: 0
        ; Auto size: 0
//  285   P1SEL &= ~0xF2;     //设置P1.1、P1.4、P1.5、P1.6、P1.7为普通IO口  
        ANL     0xf4,#0xd
//  286   P1DIR |= 0x72;      //P1.1、P1.4、P1.5、P1.6定义为输出   
        ORL     0xfe,#0x72
//  287   
//  288   P1DIR &= ~0x80;     //按键接在P1.7口上，设P1.7为输入模式 
        ANL     0xfe,#0x7f
//  289   P1INP &= ~0x80;     //打开P1.7上拉电阻
        ANL     0xf6,#0x7f
//  290 }
        LJMP    ?BRET
        CFI EndBlock cfiBlock6
        REQUIRE P1SEL
        REQUIRE P1DIR
        REQUIRE P1INP
//  291 
//  292 //==========================================================
//  293 //	函数名称：	SPI_RC522_SendByte
//  294 //
//  295 //	函数功能：	向RC522发送1 Byte 数据
//  296 //
//  297 //	入口参数：	byte，要发送的数据
//  298 //
//  299 //	返回参数：	RC522返回的数据
//  300 //
//  301 //	说明：		
//  302 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  303 void SPI_RC522_SendByte ( unsigned char byte )
SPI_RC522_SendByte:
        CFI Block cfiBlock7 Using cfiCommon0
        CFI Function SPI_RC522_SendByte
        CODE
//  304 {
        FUNCALL SPI_RC522_SendByte, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL SPI_RC522_SendByte, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL SPI_RC522_SendByte, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R7,A
//  305     unsigned char counter;
//  306 		
//  307     for(counter=0;counter<8;counter++)
        MOV     R6,#0x0
        SJMP    ??SPI_RC522_SendByte_0
//  308     {     
//  309         if ( byte & 0x80 )
//  310         {
//  311           macRC522_MOSI_1 ();
//  312         }		    
//  313         else
//  314         {
//  315           macRC522_MOSI_0 ();
??SPI_RC522_SendByte_1:
        CLR     0x90.6
        CLR     0x90.6
//  316         }		    
//  317 
//  318 //			Delay_us ( 3 );
//  319         macRC522_DELAY();
??SPI_RC522_SendByte_2:
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_c8
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  320 
//  321         macRC522_SCK_0 ();
        CLR     0x90.5
        CLR     0x90.5
//  322 
//  323 //			Delay_us ( 1 );
//  324 //			Delay_us ( 3 );
//  325         macRC522_DELAY();
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_c8
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  326          
//  327         macRC522_SCK_1();
        SETB    0x90.5
        SETB    0x90.5
//  328 
//  329 //			Delay_us ( 3 );
//  330         macRC522_DELAY();
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_c8
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  331          
//  332         byte <<= 1; 
        MOV     A,R7
        CLR     C
        RLC     A
        MOV     R7,A
        INC     R6
??SPI_RC522_SendByte_0:
        MOV     A,R6
        CLR     C
        SUBB    A,#0x8
        JNC     ??SPI_RC522_SendByte_3
        MOV     A,R7
        MOV     C,0xE0 /* A   */.7
        JNC     ??SPI_RC522_SendByte_1
        SETB    0x90.6
        SETB    0x90.6
        SJMP    ??SPI_RC522_SendByte_2
//  333 			
//  334     } 
//  335 }
??SPI_RC522_SendByte_3:
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock7
        REQUIRE _A_P1
//  336 
//  337 //==========================================================
//  338 //	函数名称：	SPI_RC522_ReadByte
//  339 //
//  340 //	函数功能：	从RC522发送1 Byte 数据
//  341 //
//  342 //	入口参数：	无
//  343 //
//  344 //	返回参数：	RC522返回的数据
//  345 //
//  346 //	说明：		
//  347 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  348 unsigned char SPI_RC522_ReadByte ( void )
SPI_RC522_ReadByte:
        CFI Block cfiBlock8 Using cfiCommon0
        CFI Function SPI_RC522_ReadByte
        CODE
//  349 {
        FUNCALL SPI_RC522_ReadByte, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL SPI_RC522_ReadByte, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL SPI_RC522_ReadByte, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//  350 	unsigned char counter;
//  351 	unsigned char SPI_Data;
//  352 
//  353 
//  354 	for(counter=0;counter<8;counter++)
        MOV     R7,#0x0
        SJMP    ??SPI_RC522_ReadByte_0
//  355 	{
//  356             SPI_Data <<= 1;
??SPI_RC522_ReadByte_1:
        CLR     C
        RLC     A
        MOV     R6,A
//  357 
//  358             macRC522_SCK_0 ();
        CLR     0x90.5
        CLR     0x90.5
//  359 
//  360 //			Delay_us ( 3 );
//  361             macRC522_DELAY();
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_c8
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  362     
//  363             if ( macRC522_MISO_GET() == 1)
        MOV     C,0x90.7
        JNC     ??SPI_RC522_ReadByte_2
//  364                SPI_Data |= 0x01;
        MOV     A,R6
        SETB    0xE0 /* A   */.0
        MOV     R6,A
//  365 
//  366 //			Delay_us ( 2 );
//  367 //			Delay_us ( 3 );
//  368             macRC522_DELAY();
??SPI_RC522_ReadByte_2:
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_c8
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  369 
//  370             macRC522_SCK_1 ();
        SETB    0x90.5
        SETB    0x90.5
//  371 
//  372 //			Delay_us ( 3 );
//  373             macRC522_DELAY();
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_c8
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  374 			
//  375 	}
        INC     R7
??SPI_RC522_ReadByte_0:
        MOV     A,R7
        CLR     C
        SUBB    A,#0x8
        MOV     A,R6
        JC      ??SPI_RC522_ReadByte_1
//  376 	
//  377 	return SPI_Data;
        MOV     R1,A
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock8
        REQUIRE _A_P1
//  378 	
//  379 }
//  380 
//  381 //==========================================================
//  382 //	函数名称：	ReadRawRC
//  383 //
//  384 //	函数功能：	读RC522寄存器
//  385 //
//  386 //	入口参数：	ucAddress，寄存器地址
//  387 //
//  388 //	返回参数：	寄存器的当前值
//  389 //
//  390 //	说明：		
//  391 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  392 unsigned char ReadRawRC ( unsigned char ucAddress )
ReadRawRC:
        CFI Block cfiBlock9 Using cfiCommon0
        CFI Function ReadRawRC
        CODE
//  393 {
        FUNCALL ReadRawRC, SPI_RC522_SendByte
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ReadRawRC, SPI_RC522_ReadByte
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
//  394       unsigned char ucAddr, ucReturn;
//  395       
//  396       ucAddr = ( ( ucAddress << 1 ) & 0x7E ) | 0x80;
//  397       
//  398       macRC522_CS_Enable();
        CLR     0x90.4
        CLR     0x90.4
//  399       
//  400       SPI_RC522_SendByte ( ucAddr );
        ; Setup parameters for call to function SPI_RC522_SendByte
        CLR     C
        RLC     A
        ORL     A,#0x80
        MOV     R1,A
        LCALL   ??SPI_RC522_SendByte?relay
//  401       
//  402       ucReturn = SPI_RC522_ReadByte ();
        ; Setup parameters for call to function SPI_RC522_ReadByte
        LCALL   ??SPI_RC522_ReadByte?relay
//  403       
//  404       macRC522_CS_Disable();
        SETB    0x90.4
        SETB    0x90.4
//  405       
//  406       return ucReturn;
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock9
        REQUIRE _A_P1
//  407 }
//  408 //==========================================================
//  409 //	函数名称：	WriteRawRC
//  410 //
//  411 //	函数功能：	写RC522寄存器
//  412 //
//  413 //	入口参数：	ucAddress，寄存器地址
//  414 //              ucValue，写入寄存器的值
//  415 //
//  416 //	返回参数：	无
//  417 //
//  418 //	说明：		
//  419 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  420 void WriteRawRC ( unsigned char ucAddress, unsigned char ucValue )
WriteRawRC:
        CFI Block cfiBlock10 Using cfiCommon0
        CFI Function WriteRawRC
        CODE
//  421 {  
        FUNCALL WriteRawRC, SPI_RC522_SendByte
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL WriteRawRC, SPI_RC522_SendByte
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R7,A
        MOV     A,R2
        MOV     R6,A
//  422 	unsigned char ucAddr;
//  423 	
//  424 	ucAddr = ( ucAddress << 1 ) & 0x7E;
//  425 	
//  426 	macRC522_CS_Enable();
        CLR     0x90.4
        CLR     0x90.4
//  427 	
//  428 	SPI_RC522_SendByte ( ucAddr );
        ; Setup parameters for call to function SPI_RC522_SendByte
        MOV     A,R7
        CLR     C
        RLC     A
        ANL     A,#0x7e
        MOV     R1,A
        LCALL   ??SPI_RC522_SendByte?relay
//  429 	
//  430 	SPI_RC522_SendByte ( ucValue );
        ; Setup parameters for call to function SPI_RC522_SendByte
        MOV     A,R6
        MOV     R1,A
        LCALL   ??SPI_RC522_SendByte?relay
//  431 	
//  432 	macRC522_CS_Disable();	
        SETB    0x90.4
        SETB    0x90.4
//  433 
//  434 }
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock10
        REQUIRE _A_P1
//  435 //==========================================================
//  436 //	函数名称：	SetBitMask
//  437 //
//  438 //	函数功能：	对RC522寄存器置位
//  439 //
//  440 //	入口参数：	ucReg，寄存器地址
//  441 //              ucMask，置位值
//  442 //
//  443 //	返回参数：	无
//  444 //
//  445 //	说明：		
//  446 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  447 void SetBitMask ( unsigned char ucReg, unsigned char ucMask )  
SetBitMask:
        CFI Block cfiBlock11 Using cfiCommon0
        CFI Function SetBitMask
        CODE
//  448 {
        FUNCALL SetBitMask, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL SetBitMask, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
        MOV     A,R2
        MOV     R7,A
//  449     unsigned char ucTemp;
//  450 	
//  451     ucTemp = ReadRawRC ( ucReg );
//  452 	
//  453     WriteRawRC ( ucReg, ucTemp | ucMask );         // set bit mask
        ; Setup parameters for call to function WriteRawRC
        ; Setup parameters for call to function ReadRawRC
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        ORL     A,R7
        MOV     R2,A
        MOV     A,R6
        MOV     R1,A
        LCALL   ??WriteRawRC?relay
//  454 }
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock11
//  455 
//  456 //==========================================================
//  457 //	函数名称：	ClearBitMask
//  458 //
//  459 //	函数功能：	对RC522寄存器清位
//  460 //
//  461 //	入口参数：	ucReg，寄存器地址
//  462 //              ucMask，清位值
//  463 //
//  464 //	返回参数：	无
//  465 //
//  466 //	说明：		
//  467 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  468 void ClearBitMask ( unsigned char ucReg, unsigned char ucMask )  
ClearBitMask:
        CFI Block cfiBlock12 Using cfiCommon0
        CFI Function ClearBitMask
        CODE
//  469 {
        FUNCALL ClearBitMask, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ClearBitMask, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
//  470     unsigned char ucTemp;
//  471 		
//  472     ucTemp = ReadRawRC ( ucReg );
//  473 	
//  474     WriteRawRC ( ucReg, ucTemp & ( ~ ucMask) );  // clear bit mask
        ; Setup parameters for call to function WriteRawRC
        MOV     A,R2
        CPL     A
        MOV     R7,A
        ; Setup parameters for call to function ReadRawRC
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        ANL     A,R7
        MOV     R2,A
        MOV     A,R6
        MOV     R1,A
        LCALL   ??WriteRawRC?relay
//  475 }
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock12
//  476 
//  477 //==========================================================
//  478 //	函数名称：	PcdAntennaOn
//  479 //
//  480 //	函数功能：	开启天线 
//  481 //
//  482 //	入口参数：	无
//  483 //
//  484 //	返回参数：	无
//  485 //
//  486 //	说明：		
//  487 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  488 void PcdAntennaOn ( void )
PcdAntennaOn:
        CFI Block cfiBlock13 Using cfiCommon0
        CFI Function PcdAntennaOn
        CODE
//  489 {
        FUNCALL PcdAntennaOn, ReadRawRC
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdAntennaOn, SetBitMask
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  490     unsigned char uc;
//  491 	
//  492     uc = ReadRawRC ( TxControlReg );
//  493 	
//  494     if ( ! ( uc & 0x03 ) )
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x14
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        ANL     A,#0x3
        JNZ     ??PcdAntennaOn_0
//  495 	SetBitMask(TxControlReg, 0x03);	
        ; Setup parameters for call to function SetBitMask
        MOV     R2,#0x3
        MOV     R1,#0x14
        LCALL   ??SetBitMask?relay
//  496 }
??PcdAntennaOn_0:
        POP     DPH
        CFI DPH0 SameValue
        CFI CFA_SP SP+-4
        POP     DPL
        CFI DPL0 SameValue
        CFI CFA_SP SP+-3
        LJMP    ?BRET
        CFI EndBlock cfiBlock13
//  497 
//  498 //==========================================================
//  499 //	函数名称：	PcdAntennaOff
//  500 //
//  501 //	函数功能：	关闭天线
//  502 //
//  503 //	入口参数：	无
//  504 //
//  505 //	返回参数：	无
//  506 //
//  507 //	说明：		
//  508 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  509 void PcdAntennaOff ( void )
PcdAntennaOff:
        CFI Block cfiBlock14 Using cfiCommon0
        CFI Function PcdAntennaOff
        CODE
//  510 {
        FUNCALL PcdAntennaOff, ClearBitMask
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  511   ClearBitMask ( TxControlReg, 0x03 );
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#0x3
        MOV     R1,#0x14
        LCALL   ??ClearBitMask?relay
//  512 }
        POP     DPH
        CFI DPH0 SameValue
        CFI CFA_SP SP+-4
        POP     DPL
        CFI DPL0 SameValue
        CFI CFA_SP SP+-3
        LJMP    ?BRET
        CFI EndBlock cfiBlock14
//  513 
//  514 //==========================================================
//  515 //	函数名称：	RC522_InitStatus
//  516 //
//  517 //	函数功能：	获取RC522是否正常复位
//  518 //
//  519 //	入口参数：	无
//  520 //
//  521 //	返回参数：	无
//  522 //
//  523 //	说明：		
//  524 //==========================================================

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  525 uint8 InitStatus = 0;
InitStatus:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  526 uint8 RC522_InitStatus(void) 
RC522_InitStatus:
        CFI Block cfiBlock15 Using cfiCommon0
        CFI Function RC522_InitStatus
        CODE
//  527 {
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  528   return InitStatus;
        MOV     DPTR,#InitStatus
        MOVX    A,@DPTR
        MOV     R1,A
        POP     DPH
        CFI DPH0 SameValue
        CFI CFA_SP SP+-4
        POP     DPL
        CFI DPL0 SameValue
        CFI CFA_SP SP+-3
        LJMP    ?BRET
        CFI EndBlock cfiBlock15
//  529 }
//  530 //==========================================================
//  531 //	函数名称：	PcdReset
//  532 //
//  533 //	函数功能：	复位RC522 
//  534 //
//  535 //	入口参数：	无
//  536 //
//  537 //	返回参数：	无
//  538 //
//  539 //	说明：		
//  540 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  541 uint8  PcdReset ( void )
PcdReset:
        CFI Block cfiBlock16 Using cfiCommon0
        CFI Function PcdReset
        CODE
//  542 {
        FUNCALL PcdReset, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, delay_ms
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdReset, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//  543         uint8 count=0;
        MOV     R6,#0x0
//  544 	macRC522_Reset_Disable();
        SETB    0x90.1
        SETB    0x90.1
//  545 	
//  546 	delay_us ( 1 );
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_1
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  547 	
//  548 	macRC522_Reset_Enable();
        CLR     0x90.1
        CLR     0x90.1
//  549 	
//  550 	delay_us ( 1 );
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_1
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  551 	
//  552 	macRC522_Reset_Disable();
        SETB    0x90.1
        SETB    0x90.1
//  553 	
//  554 	delay_us ( 1 );
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_1
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  555 	
//  556 	WriteRawRC ( CommandReg, 0x0f );
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0xf
        MOV     R1,#0x1
        LCALL   ??WriteRawRC?relay
        SJMP    ??PcdReset_0
//  557 	
//  558 	while ( (ReadRawRC ( CommandReg ) & 0x10 ))
//  559         {
//  560           if((++count) < 6)
//  561           {
//  562             delay_ms(100);
??PcdReset_1:
        ; Setup parameters for call to function delay_ms
        MOV     DPTR,#__Constant_64
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_ms?relay
//  563           }
??PcdReset_0:
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x1
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        MOV     C,0xE0 /* A   */.4
        JNC     ??PcdReset_2
        INC     R6
        MOV     A,R6
        CLR     C
        SUBB    A,#0x6
        JC      ??PcdReset_1
//  564           else
//  565           {
//  566             break;
//  567           }
//  568         }
//  569         delay_us ( 1 );
??PcdReset_2:
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_1
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  570         
//  571         WriteRawRC ( ModeReg, 0x3D );           //定义发送和接收常用模式 和Mifare卡通讯，CRC初始值0x6363
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x3d
        MOV     R1,#0x11
        LCALL   ??WriteRawRC?relay
//  572         
//  573         WriteRawRC ( TReloadRegL, 30 );         //16位定时器低位    
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x1e
        MOV     R1,#0x2d
        LCALL   ??WriteRawRC?relay
//  574         WriteRawRC ( TReloadRegH, 0 );	        //16位定时器高位
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x0
        MOV     R1,#0x2c
        LCALL   ??WriteRawRC?relay
//  575         
//  576         WriteRawRC ( TModeReg, 0x8D );	        //定义内部定时器的设置
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#-0x73
        MOV     R1,#0x2a
        LCALL   ??WriteRawRC?relay
//  577         
//  578         WriteRawRC ( TPrescalerReg, 0x3E );	//设置定时器分频系数
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x3e
        MOV     R1,#0x2b
        LCALL   ??WriteRawRC?relay
//  579         
//  580         WriteRawRC ( TxAutoReg, 0x40 );	        //调制发送信号为100%ASK	
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x40
        MOV     R1,#0x15
        LCALL   ??WriteRawRC?relay
//  581         InitStatus = 1;
        MOV     DPTR,#InitStatus
        MOV     A,#0x1
        MOVX    @DPTR,A
//  582         delay_us ( 100 ); 
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_64
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  583         return InitStatus;
        MOV     DPTR,#InitStatus
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock16
        REQUIRE _A_P1
//  584 }
//  585 
//  586 //==========================================================
//  587 //	函数名称：	M500PcdConfigISOType
//  588 //
//  589 //	函数功能：	设置RC522的工作方式
//  590 //
//  591 //	入口参数：	ucType，工作方式
//  592 //
//  593 //	返回参数：	无
//  594 //
//  595 //	说明：		
//  596 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  597 void M500PcdConfigISOType ( unsigned char ucType )
M500PcdConfigISOType:
        CFI Block cfiBlock17 Using cfiCommon0
        CFI Function M500PcdConfigISOType
        CODE
//  598 {
        FUNCALL M500PcdConfigISOType, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, delay_us
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL M500PcdConfigISOType, PcdAntennaOn
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
//  599   if ( ucType == 'A')                     //ISO14443_A
        MOV     A,#0x41
        XRL     A,R6
        JNZ     ??M500PcdConfigISOType_0
//  600   {
//  601         ClearBitMask ( Status2Reg, 0x08 );
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#0x8
        MOV     R1,#0x8
        LCALL   ??ClearBitMask?relay
//  602 
//  603         WriteRawRC ( ModeReg, 0x3D );//3F
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x3d
        MOV     R1,#0x11
        LCALL   ??WriteRawRC?relay
//  604 
//  605         WriteRawRC ( RxSelReg, 0x86 );//84
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#-0x7a
        MOV     R1,#0x17
        LCALL   ??WriteRawRC?relay
//  606 
//  607         WriteRawRC( RFCfgReg, 0x7F );   //4F
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x7f
        MOV     R1,#0x26
        LCALL   ??WriteRawRC?relay
//  608 
//  609         WriteRawRC( TReloadRegL, 30 );//tmoLength);// TReloadVal = 'h6a =tmoLength(dec) 
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x1e
        MOV     R1,#0x2d
        LCALL   ??WriteRawRC?relay
//  610 
//  611         WriteRawRC ( TReloadRegH, 0 );
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x0
        MOV     R1,#0x2c
        LCALL   ??WriteRawRC?relay
//  612 
//  613         WriteRawRC ( TModeReg, 0x8D );
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#-0x73
        MOV     R1,#0x2a
        LCALL   ??WriteRawRC?relay
//  614 
//  615         WriteRawRC ( TPrescalerReg, 0x3E );
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x3e
        MOV     R1,#0x2b
        LCALL   ??WriteRawRC?relay
//  616 
//  617         delay_us ( 2 );
        ; Setup parameters for call to function delay_us
        MOV     DPTR,#__Constant_2
        LCALL   ?XLOAD_R2345
        LCALL   ??delay_us?relay
//  618 
//  619         PcdAntennaOn ();//开天线	
        ; Setup parameters for call to function PcdAntennaOn
        LCALL   ??PcdAntennaOn?relay
//  620    } 
//  621 }
??M500PcdConfigISOType_0:
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock17
//  622 
//  623 //==========================================================
//  624 //	函数名称：	PcdComMF522
//  625 //
//  626 //	函数功能：	通过RC522和ISO14443卡通讯
//  627 //
//  628 //	入口参数：	ucCommand，RC522命令字
//  629 //              pInData，通过RC522发送到卡片的数据
//  630 //              ucInLenByte，发送数据的字节长度
//  631 //              pOutData，接收到的卡片返回数据
//  632 //              pOutLenBit，返回数据的位长度
//  633 //
//  634 //	返回参数：	状态值 = MI_OK，成功
//  635 //
//  636 //	说明：		
//  637 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  638 char PcdComMF522 ( unsigned char ucCommand, unsigned char * pInData, unsigned char ucInLenByte, unsigned char * pOutData, int * pOutLenBit )		
PcdComMF522:
        CFI Block cfiBlock18 Using cfiCommon0
        CFI Function PcdComMF522
        CODE
//  639 {
        FUNCALL PcdComMF522, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, SetBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, SetBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, SetBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdComMF522, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x16
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-17)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-18)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-19)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-20)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-21)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-22)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 22)
        ; Saved register size: 22
        ; Auto size: 0
        MOV     ?V0 + 2,R1
        MOV     ?V0 + 10,R2
        MOV     ?V0 + 11,R3
        MOV     ?V0 + 4,R4
        MOV     A,#0x16
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 12,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 13,A
        MOV     A,#0x18
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 1,A
//  640     char cStatus = MI_ERR;
        MOV     ?V0 + 3,#-0x45
//  641     unsigned char ucIrqEn   = 0x00;
        MOV     ?V0 + 5,#0x0
//  642     unsigned char ucWaitFor = 0x00;
        MOV     ?V0 + 6,#0x0
//  643     unsigned char ucLastBits;
//  644     unsigned char ucN;
//  645     int ul;
//  646 	
//  647 	
//  648     switch ( ucCommand )
        MOV     A,R1
        ADD     A,#-0xc
        JZ      ??PcdComMF522_0
        ADD     A,#-0x2
        JNZ     ??PcdComMF522_1
//  649     {
//  650        case PCD_AUTHENT:		//Mifare认证
//  651           ucIrqEn   = 0x12;		//允许错误中断请求ErrIEn  允许空闲中断IdleIEn
        MOV     ?V0 + 5,#0x12
//  652           ucWaitFor = 0x10;		//认证寻卡等待时候 查询空闲中断标志位
        MOV     ?V0 + 6,#0x10
//  653           break;
        SJMP    ??PcdComMF522_1
//  654 			 
//  655        case PCD_TRANSCEIVE:		//接收发送 发送接收
//  656           ucIrqEn   = 0x77;		//允许TxIEn RxIEn IdleIEn LoAlertIEn ErrIEn TimerIEn
??PcdComMF522_0:
        MOV     ?V0 + 5,#0x77
//  657           ucWaitFor = 0x30;		//寻卡等待时候 查询接收中断标志位与 空闲中断标志位
        MOV     ?V0 + 6,#0x30
//  658           break;
//  659 			 
//  660        default:
//  661          break;
//  662 			 
//  663     }
//  664    
//  665     WriteRawRC ( ComIEnReg, ucIrqEn | 0x80 );		//IRqInv置位管脚IRQ与Status1Reg的IRq位的值相反 
??PcdComMF522_1:
        ; Setup parameters for call to function WriteRawRC
        MOV     A,#-0x80
        ORL     A,?V0 + 5
        MOV     R2,A
        MOV     R1,#0x2
        LCALL   ??WriteRawRC?relay
//  666     ClearBitMask ( ComIrqReg, 0x80 );			//Set1该位清零时，CommIRqReg的屏蔽位清零
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#-0x80
        MOV     R1,#0x4
        LCALL   ??ClearBitMask?relay
//  667     WriteRawRC ( CommandReg, PCD_IDLE );		//写空闲命令
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x0
        MOV     R1,#0x1
        LCALL   ??WriteRawRC?relay
//  668     SetBitMask ( FIFOLevelReg, 0x80 );			//置位FlushBuffer清除内部FIFO的读和写指针以及ErrReg的BufferOvfl标志位被清除
        ; Setup parameters for call to function SetBitMask
        MOV     R2,#-0x80
        MOV     R1,#0xa
        LCALL   ??SetBitMask?relay
//  669     
//  670     for ( ul = 0; ul < ucInLenByte; ul ++ )
        MOV     R6,#0x0
        MOV     R7,#0x0
        SJMP    ??PcdComMF522_2
//  671 		  WriteRawRC ( FIFODataReg, pInData [ ul ] );    		//写数据进FIFOdata
??PcdComMF522_3:
        ; Setup parameters for call to function WriteRawRC
        MOV     A,?V0 + 10
        ADD     A,R6
        MOV     DPL,A
        MOV     A,?V0 + 11
        ADDC    A,R7
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     R1,#0x9
        LCALL   ??WriteRawRC?relay
        MOV     A,R6
        ADD     A,#0x1
        INC     R6
        MOV     A,R7
        ADDC    A,#0x0
        MOV     R7,A
??PcdComMF522_2:
        MOV     ?V0 + 8,?V0 + 4
        CLR     C
        MOV     A,R6
        SUBB    A,?V0 + 8
        MOV     A,R7
        SUBB    A,#0x0
        MOV     C,0xD0 /* PSW */.2
        XRL     A,PSW
        RLC     A
        JC      ??PcdComMF522_3
//  672 			
//  673     WriteRawRC ( CommandReg, ucCommand );					//写命令
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,?V0 + 2
        MOV     R1,#0x1
        LCALL   ??WriteRawRC?relay
//  674    
//  675     
//  676     if ( ucCommand == PCD_TRANSCEIVE )
        MOV     A,#0xc
        XRL     A,?V0 + 2
        JNZ     ??PcdComMF522_4
//  677 			SetBitMask(BitFramingReg,0x80);  				//StartSend置位启动数据发送 该位与收发命令使用时才有效
        ; Setup parameters for call to function SetBitMask
        MOV     R2,#-0x80
        MOV     R1,#0xd
        LCALL   ??SetBitMask?relay
//  678     
//  679     ul = 1000;//根据时钟频率调整，操作M1卡最大等待时间25ms
??PcdComMF522_4:
        MOV     R6,#-0x18
        MOV     R7,#0x3
//  680 		
//  681     do 														//认证 与寻卡等待时间	
//  682     {
//  683          ucN = ReadRawRC ( ComIrqReg );							//查询事件中断
??PcdComMF522_5:
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x4
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        MOV     ?V0 + 8,A
//  684          ul --;
//  685     } while ( ( ul != 0 ) && ( ! ( ucN & 0x01 ) ) && ( ! ( ucN & ucWaitFor ) ) );		//退出条件i=0,定时器中断，与写空闲命令
        MOV     A,R6
        ADD     A,#-0x1
        DEC     R6
        MOV     A,R7
        ADDC    A,#-0x1
        MOV     R7,A
        MOV     A,R6
        ORL     A,R7
        JZ      ??PcdComMF522_6
        MOV     A,R1
        MOV     C,0xE0 /* A   */.0
        JC      ??PcdComMF522_6
        ANL     A,?V0 + 6
        JZ      ??PcdComMF522_5
//  686 		
//  687     ClearBitMask ( BitFramingReg, 0x80 );					//清理允许StartSend位
??PcdComMF522_6:
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#-0x80
        MOV     R1,#0xd
        LCALL   ??ClearBitMask?relay
//  688 		
//  689     if ( ul != 0 )
        MOV     A,R6
        ORL     A,R7
        JNZ     $+5
        LJMP    ??PcdComMF522_7 & 0xFFFF
//  690     {
//  691       if ( ! ( ReadRawRC ( ErrorReg ) & 0x1B ) )			//读错误标志寄存器BufferOfI CollErr ParityErr ProtocolErr
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x6
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        ANL     A,#0x1b
        JZ      $+5
        LJMP    ??PcdComMF522_7 & 0xFFFF
//  692       {
//  693           cStatus = MI_OK;
        MOV     ?V0 + 3,#0x26
//  694           
//  695           if ( ucN & ucIrqEn & 0x01 )					//是否发生定时器中断
        MOV     A,?V0 + 5
        MOV     C,0xE0 /* A   */.0
        PUSH    PSW
        CFI CFA_SP SP+-1
        MOV     A,?V0 + 8
        MOV     C,0xE0 /* A   */.0
        MOV     B.0,C
        LCALL   ?POP_BIT_ISP
        DEC     SP
        CFI CFA_SP SP+0
        ANL     C,B.0
        JNC     ??PcdComMF522_8
//  696             cStatus = MI_NOTAGERR;   
        MOV     ?V0 + 3,#-0x34
//  697                   
//  698           if ( ucCommand == PCD_TRANSCEIVE )
??PcdComMF522_8:
        MOV     A,#0xc
        XRL     A,?V0 + 2
        JZ      $+5
        LJMP    ??PcdComMF522_7 & 0xFFFF
//  699           {
//  700               ucN = ReadRawRC ( FIFOLevelReg );			//读FIFO中保存的字节数
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0xa
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        MOV     ?V0 + 8,A
//  701               
//  702               ucLastBits = ReadRawRC ( ControlReg ) & 0x07;	//最后接收到得字节的有效位数
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0xc
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        ANL     A,#0x7
        MOV     ?V0 + 10,A
//  703               
//  704               if ( ucLastBits )
        MOV     DPL,?V0 + 8
        MOV     ?V0 + 6,DPL
        MOV     ?V0 + 7,#0x0
        JZ      ??PcdComMF522_9
//  705                       * pOutLenBit = ( ucN - 1 ) * 8 + ucLastBits;   	//N个字节数减去1（最后一个字节）+最后一位的位数 读取到的数据总位数
        MOV     A,?V0 + 6
        ADD     A,#-0x1
        MOV     ?V0 + 6,A
        CLR     A
        ADDC    A,#-0x1
        MOV     ?V0 + 7,A
        MOV     A,#0x3
        MOV     R0,#?V0 + 6
        LCALL   ?S_SHL
        MOV     A,?V0 + 6
        ADD     A,?V0 + 10
        MOV     R0,A
        MOV     A,?V0 + 7
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        SJMP    ??PcdComMF522_10
//  706               else
//  707                       * pOutLenBit = ucN * 8;   					//最后接收到的字节整个字节有效
??PcdComMF522_9:
        MOV     A,#0x3
        MOV     R0,#?V0 + 6
        LCALL   ?S_SHL
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOV     A,?V0 + 6
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 7
??PcdComMF522_10:
        MOVX    @DPTR,A
//  708               
//  709               if ( ucN == 0 )		
        MOV     A,?V0 + 8
        JNZ     ??PcdComMF522_11
//  710                   ucN = 1;    
        MOV     ?V0 + 8,#0x1
//  711               
//  712               if ( ucN > MAXRLEN )
??PcdComMF522_11:
        MOV     A,?V0 + 8
        CLR     C
        SUBB    A,#0x13
        JC      ??PcdComMF522_12
//  713                       ucN = MAXRLEN;   
        MOV     ?V0 + 8,#0x12
//  714               
//  715               for ( ul = 0; ul < ucN; ul ++ )
??PcdComMF522_12:
        MOV     R6,#0x0
        MOV     R7,#0x0
        SJMP    ??PcdComMF522_13
//  716                 pOutData [ ul ] = ReadRawRC ( FIFODataReg );   
??PcdComMF522_14:
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x9
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,?V0 + 12
        ADD     A,R6
        MOV     DPL,A
        MOV     A,?V0 + 13
        ADDC    A,R7
        MOV     DPH,A
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        MOV     A,R6
        ADD     A,#0x1
        INC     R6
        MOV     A,R7
        ADDC    A,#0x0
        MOV     R7,A
??PcdComMF522_13:
        MOV     ?V0 + 0,?V0 + 8
        CLR     C
        MOV     A,R6
        SUBB    A,?V0 + 0
        MOV     A,R7
        SUBB    A,#0x0
        MOV     C,0xD0 /* PSW */.2
        XRL     A,PSW
        RLC     A
        JC      ??PcdComMF522_14
//  717                   
//  718             }		
//  719       }
//  720 			
//  721       else
//  722       cStatus = MI_ERR;   
//  723     }
//  724    
//  725    SetBitMask ( ControlReg, 0x80 );           // stop timer now
??PcdComMF522_7:
        ; Setup parameters for call to function SetBitMask
        MOV     R2,#-0x80
        MOV     R1,#0xc
        LCALL   ??SetBitMask?relay
//  726    WriteRawRC ( CommandReg, PCD_IDLE ); 
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x0
        MOV     R1,#0x1
        LCALL   ??WriteRawRC?relay
//  727 	
//  728    return cStatus;
        MOV     R1,?V0 + 3
        MOV     R7,#0xe
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock18
//  729 }
//  730 
//  731 //==========================================================
//  732 //	函数名称：	PcdRequest
//  733 //
//  734 //	函数功能：	寻卡
//  735 //
//  736 //	入口参数：	ucReq_code，寻卡方式
//  737 //                     = 0x52，寻感应区内所有符合14443A标准的卡
//  738 //                     = 0x26，寻未进入休眠状态的卡
//  739 //              pTagType，卡片类型代码
//  740 //                   = 0x4400，Mifare_UltraLight
//  741 //                   = 0x0400，Mifare_One(S50)
//  742 //                   = 0x0200，Mifare_One(S70)
//  743 //                   = 0x0800，Mifare_Pro(X))
//  744 //                   = 0x4403，Mifare_DESFire
//  745 //
//  746 //	返回参数：	状态值 = MI_OK，成功
//  747 //
//  748 //	说明：		
//  749 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  750 char PcdRequest ( unsigned char ucReq_code, unsigned char * pTagType)
PcdRequest:
        CFI Block cfiBlock19 Using cfiCommon0
        CFI Function PcdRequest
        CODE
//  751 {
        FUNCALL PcdRequest, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdRequest, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdRequest, SetBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdRequest, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xb
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 31)
        MOV     ?V0 + 2,R1
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  752    char cStatus;  
//  753    unsigned char ucComMF522Buf [ MAXRLEN ]; 
//  754    int ulLen;
//  755 
//  756    ClearBitMask ( Status2Reg, 0x08 );	//清理指示MIFARECyptol单元接通以及所有卡的数据通信被加密的情况
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#0x8
        MOV     R1,#0x8
        LCALL   ??ClearBitMask?relay
//  757    WriteRawRC ( BitFramingReg, 0x07 );	//	发送的最后一个字节的 七位
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x7
        MOV     R1,#0xd
        LCALL   ??WriteRawRC?relay
//  758    SetBitMask ( TxControlReg, 0x03 );	//TX1,TX2管脚的输出信号传递经发送调制的13.56的能量载波信号
        ; Setup parameters for call to function SetBitMask
        MOV     R2,#0x3
        MOV     R1,#0x14
        LCALL   ??SetBitMask?relay
//  759 
//  760    ucComMF522Buf [ 0 ] = ucReq_code;		//存入 卡片命令字
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,?V0 + 2
        MOVX    @DPTR,A
//  761 
//  762    cStatus = PcdComMF522 ( PCD_TRANSCEIVE,	ucComMF522Buf, 1, ucComMF522Buf, & ulLen );	//寻卡  
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 33)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 35)
        MOV     R4,#0x1
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xc
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 31)
//  763  
//  764    if ( ( cStatus == MI_OK ) && ( ulLen == 0x10 ) )	//寻卡成功返回卡类型 
        MOV     A,#0x26
        XRL     A,R1
        JNZ     ??PcdRequest_0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0x10
        JNZ     ??PcdRequest_1
        INC     DPTR
        MOVX    A,@DPTR
??PcdRequest_1:
        JNZ     ??PcdRequest_0
//  765    {    
//  766        * pTagType = ucComMF522Buf [ 0 ];
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
//  767        * ( pTagType + 1 ) = ucComMF522Buf [ 1 ];
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOVX    @DPTR,A
        SJMP    ??PcdRequest_2
//  768    }
//  769    else
//  770    {
//  771      cStatus = MI_ERR;
??PcdRequest_0:
        MOV     R1,#-0x45
//  772    }
//  773 	 
//  774    return cStatus; 
??PcdRequest_2:
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
        MOV     R7,#0x3
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock19
//  775 }
//  776 
//  777 //==========================================================
//  778 //	函数名称：	PcdAnticoll
//  779 //
//  780 //	函数功能：	防冲撞
//  781 //
//  782 //	入口参数：	pSnr，卡片序列号，4字节
//  783 //
//  784 //	返回参数：	状态值 = MI_OK，成功
//  785 //
//  786 //	说明：		
//  787 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  788 char PcdAnticoll ( unsigned char * pSnr )
PcdAnticoll:
        CFI Block cfiBlock20 Using cfiCommon0
        CFI Function PcdAnticoll
        CODE
//  789 {
        FUNCALL PcdAnticoll, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdAnticoll, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdAnticoll, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdAnticoll, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdAnticoll, SetBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xb
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 31)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  790     char cStatus;
//  791     unsigned char uc, ucSnr_check = 0;
        MOV     ?V0 + 2,#0x0
//  792     unsigned char ucComMF522Buf [ MAXRLEN ]; 
//  793 	int ulLen;
//  794     
//  795 
//  796     ClearBitMask ( Status2Reg, 0x08 );		//清MFCryptol On位 只有成功执行MFAuthent命令后，该位才能置位
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#0x8
        MOV     R1,#0x8
        LCALL   ??ClearBitMask?relay
//  797     WriteRawRC ( BitFramingReg, 0x00);		//清理寄存器 停止收发
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x0
        MOV     R1,#0xd
        LCALL   ??WriteRawRC?relay
//  798     ClearBitMask ( CollReg, 0x80 );			//清ValuesAfterColl所有接收的位在冲突后被清除
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#-0x80
        MOV     R1,#0xe
        LCALL   ??ClearBitMask?relay
//  799    
//  800     ucComMF522Buf [ 0 ] = 0x93;	//卡片防冲突命令
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#-0x6d
        MOVX    @DPTR,A
//  801     ucComMF522Buf [ 1 ] = 0x20;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x20
        MOVX    @DPTR,A
//  802    
//  803     cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 2, ucComMF522Buf, & ulLen);//与卡片通信
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 33)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 35)
        MOV     R4,#0x2
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xc
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 31)
        MOV     A,R1
        MOV     ?V0 + 0,A
//  804 	
//  805     if ( cStatus == MI_OK)		//通信成功
        MOV     A,#0x26
        XRL     A,?V0 + 0
        JNZ     ??PcdAnticoll_0
//  806     {
//  807       for ( uc = 0; uc < 4; uc ++ )
        MOV     R4,#0x0
        SJMP    ??PcdAnticoll_1
//  808       {
//  809         * ( pSnr + uc )  = ucComMF522Buf [ uc ];			//读出UID
??PcdAnticoll_2:
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,R6
        ADD     A,R2
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  810         ucSnr_check ^= ucComMF522Buf [ uc ];
        MOV     DPL,R0
        MOV     DPH,R1
        MOVX    A,@DPTR
        XRL     ?V0 + 2,A
//  811       }
        INC     R4
??PcdAnticoll_1:
        MOV     DPL,R4
        MOV     R2,DPL
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,DPL
        ADD     A,R2
        MOV     R0,A
        MOV     A,DPH
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,R0
        MOV     DPH,R1
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     A,R4
        CLR     C
        SUBB    A,#0x4
        MOV     A,R5
        JC      ??PcdAnticoll_2
//  812 			
//  813       if ( ucSnr_check != ucComMF522Buf [ uc ] )
        XRL     A,?V0 + 2
        JZ      ??PcdAnticoll_0
//  814       {
//  815         cStatus = MI_ERR; 
        MOV     ?V0 + 0,#-0x45
//  816       }
//  817 				 
//  818     }
//  819     
//  820     SetBitMask ( CollReg, 0x80 );
??PcdAnticoll_0:
        ; Setup parameters for call to function SetBitMask
        MOV     R2,#-0x80
        MOV     R1,#0xe
        LCALL   ??SetBitMask?relay
//  821 		
//  822 		
//  823     return cStatus;
        MOV     R1,?V0 + 0
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
        MOV     R7,#0x3
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock20
//  824 		
//  825 		
//  826 }
//  827 
//  828 //==========================================================
//  829 //	函数名称：	CalulateCRC
//  830 //
//  831 //	函数功能：	用RC522计算CRC16
//  832 //
//  833 //	入口参数：	pIndata，计算CRC16的数组
//  834 //              ucLen，计算CRC16的数组字节长度
//  835 //              pOutData，存放计算结果存放的首地址
//  836 //
//  837 //	返回参数：	无
//  838 //
//  839 //	说明：		
//  840 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  841 void CalulateCRC ( unsigned char * pIndata, unsigned char ucLen, unsigned char * pOutData )
CalulateCRC:
        CFI Block cfiBlock21 Using cfiCommon0
        CFI Function CalulateCRC
        CODE
//  842 {
        FUNCALL CalulateCRC, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CalulateCRC, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CalulateCRC, SetBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CalulateCRC, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CalulateCRC, WriteRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CalulateCRC, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CalulateCRC, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CalulateCRC, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
        MOV     ?V0 + 5,R1
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
//  843     unsigned char uc, ucN;
//  844 	
//  845 	
//  846     ClearBitMask(DivIrqReg,0x04);
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#0x4
        MOV     R1,#0x5
        LCALL   ??ClearBitMask?relay
//  847 	
//  848     WriteRawRC(CommandReg,PCD_IDLE);
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x0
        MOV     R1,#0x1
        LCALL   ??WriteRawRC?relay
//  849 	
//  850     SetBitMask(FIFOLevelReg,0x80);
        ; Setup parameters for call to function SetBitMask
        MOV     R2,#-0x80
        MOV     R1,#0xa
        LCALL   ??SetBitMask?relay
//  851 	
//  852     for ( uc = 0; uc < ucLen; uc ++)
        MOV     ?V0 + 4,#0x0
        SJMP    ??CalulateCRC_0
//  853 	    WriteRawRC ( FIFODataReg, * ( pIndata + uc ) );   
??CalulateCRC_1:
        ; Setup parameters for call to function WriteRawRC
        MOV     ?V0 + 2,?V0 + 4
        MOV     A,R6
        ADD     A,?V0 + 2
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     R1,#0x9
        LCALL   ??WriteRawRC?relay
        INC     ?V0 + 4
??CalulateCRC_0:
        MOV     A,?V0 + 4
        CLR     C
        SUBB    A,?V0 + 5
        JC      ??CalulateCRC_1
//  854 
//  855     WriteRawRC ( CommandReg, PCD_CALCCRC );
        ; Setup parameters for call to function WriteRawRC
        MOV     R2,#0x3
        MOV     R1,#0x1
        LCALL   ??WriteRawRC?relay
//  856 	
//  857     uc = 0xFF;
        MOV     ?V0 + 4,#-0x1
//  858 	
//  859     do 
//  860     {
//  861         ucN = ReadRawRC ( DivIrqReg );
??CalulateCRC_2:
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x5
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        MOV     R0,A
//  862         uc --;
//  863     } while ( ( uc != 0 ) && ! ( ucN & 0x04 ) );
        DEC     ?V0 + 4
        MOV     A,?V0 + 4
        JZ      ??CalulateCRC_3
        MOV     A,R0
        MOV     C,0xE0 /* A   */.2
        JNC     ??CalulateCRC_2
//  864 		
//  865     pOutData [ 0 ] = ReadRawRC ( CRCResultRegL );
??CalulateCRC_3:
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x22
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
//  866     pOutData [ 1 ] = ReadRawRC ( CRCResultRegM );
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x21
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOVX    @DPTR,A
//  867 		
//  868 		
//  869 }
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock21
//  870 
//  871 //==========================================================
//  872 //	函数名称：	PcdSelect
//  873 //
//  874 //	函数功能：	选定卡片
//  875 //
//  876 //	入口参数：	pSnr，卡片序列号，4字节
//  877 //
//  878 //	返回参数：	状态值 = MI_OK，成功
//  879 //
//  880 //	说明：		
//  881 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  882 char PcdSelect ( unsigned char * pSnr )
PcdSelect:
        CFI Block cfiBlock22 Using cfiCommon0
        CFI Function PcdSelect
        CODE
//  883 {
        FUNCALL PcdSelect, CalulateCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 30, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 30, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdSelect, ClearBitMask
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 30, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 30, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdSelect, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 30)
//  884     char ucN;
//  885     unsigned char uc;
//  886 	  unsigned char ucComMF522Buf [ MAXRLEN ]; 
//  887     int  ulLen;
//  888     
//  889     
//  890     ucComMF522Buf [ 0 ] = PICC_ANTICOLL1;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#-0x6d
        MOVX    @DPTR,A
//  891     ucComMF522Buf [ 1 ] = 0x70;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x70
        MOVX    @DPTR,A
//  892     ucComMF522Buf [ 6 ] = 0;
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
//  893 	
//  894     for ( uc = 0; uc < 4; uc ++ )
        MOV     R6,A
        SJMP    ??PcdSelect_0
//  895     {
//  896     	ucComMF522Buf [ uc + 2 ] = * ( pSnr + uc );
??PcdSelect_1:
        MOV     DPL,R6
        MOV     R4,DPL
        MOV     A,R2
        ADD     A,R4
        MOV     R0,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,R0
        MOV     DPH,R1
        MOVX    A,@DPTR
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,DPL
        ADD     A,R4
        MOV     DPL,A
        MOV     A,DPH
        ADDC    A,#0x0
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  897     	ucComMF522Buf [ 6 ] ^= * ( pSnr + uc );
        MOV     DPL,R0
        MOV     DPH,R1
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,R0
        MOVX    @DPTR,A
//  898     }
        INC     R6
??PcdSelect_0:
        MOV     A,R6
        CLR     C
        SUBB    A,#0x4
        JC      ??PcdSelect_1
//  899 		
//  900     CalulateCRC ( ucComMF522Buf, 7, & ucComMF522Buf [ 7 ] );
        ; Setup parameters for call to function CalulateCRC
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R1,#0x7
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??CalulateCRC?relay
//  901   
//  902     ClearBitMask ( Status2Reg, 0x08 );
        ; Setup parameters for call to function ClearBitMask
        MOV     R2,#0x8
        MOV     R1,#0x8
        LCALL   ??ClearBitMask?relay
//  903 
//  904     ucN = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 9, ucComMF522Buf, & ulLen );
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 32)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 34)
        MOV     R4,#0x9
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xc
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 30)
//  905     
//  906     if ( ( ucN == MI_OK ) && ( ulLen == 0x18 ) )
        MOV     A,#0x26
        XRL     A,R1
        JNZ     ??PcdSelect_2
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0x18
        JNZ     ??PcdSelect_3
        INC     DPTR
        MOVX    A,@DPTR
??PcdSelect_3:
        JZ      ??PcdSelect_4
//  907       ucN = MI_OK;  
//  908     else
//  909       ucN = MI_ERR;    
??PcdSelect_2:
        MOV     R1,#-0x45
//  910 
//  911 		
//  912     return ucN;
??PcdSelect_4:
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock22
//  913 		
//  914 		
//  915 }
//  916 
//  917 //==========================================================
//  918 //	函数名称：	PcdAuthState
//  919 //
//  920 //	函数功能：	验证卡片密码
//  921 //
//  922 //	入口参数：	ucAuth_mode，密码验证模式
//  923 //                     = 0x60，验证A密钥
//  924 //                     = 0x61，验证B密钥
//  925 //         unsigned char ucAddr，块地址
//  926 //         pKey，密码
//  927 //         pSnr，卡片序列号，4字节
//  928 //
//  929 //	返回参数：	 状态值 = MI_OK，成功
//  930 //
//  931 //	说明：		
//  932 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  933 char PcdAuthState ( unsigned char ucAuth_mode, unsigned char ucAddr, unsigned char * pKey, unsigned char * pSnr )
PcdAuthState:
        CFI Block cfiBlock23 Using cfiCommon0
        CFI Function PcdAuthState
        CODE
//  934 {
        FUNCALL PcdAuthState, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdAuthState, ReadRawRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 30, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 30, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 30)
        MOV     A,R1
        MOV     R6,A
        MOV     A,R2
        MOV     R7,A
        MOV     A,#0x1e
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
//  935     char cStatus;
//  936 	  unsigned char uc, ucComMF522Buf [ MAXRLEN ];
//  937     int ulLen;
//  938     
//  939 	
//  940     ucComMF522Buf [ 0 ] = ucAuth_mode;
        MOV     A,R6
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  941     ucComMF522Buf [ 1 ] = ucAddr;
        MOV     A,R7
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  942 	
//  943     for ( uc = 0; uc < 6; uc ++ )
        MOV     ?V0 + 0,#0x0
        SJMP    ??PcdAuthState_0
//  944 	    ucComMF522Buf [ uc + 2 ] = * ( pKey + uc );   
??PcdAuthState_1:
        MOV     DPL,?V0 + 0
        MOV     R2,DPL
        MOV     A,R4
        ADD     A,R2
        MOV     DPL,A
        MOV     A,R5
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,DPL
        ADD     A,R2
        MOV     DPL,A
        MOV     A,DPH
        ADDC    A,#0x0
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        INC     ?V0 + 0
??PcdAuthState_0:
        MOV     A,?V0 + 0
        CLR     C
        SUBB    A,#0x6
        JC      ??PcdAuthState_1
//  945 	
//  946     for ( uc = 0; uc < 6; uc ++ )
        MOV     ?V0 + 0,#0x0
        SJMP    ??PcdAuthState_2
//  947 	    ucComMF522Buf [ uc + 8 ] = * ( pSnr + uc );   
??PcdAuthState_3:
        MOV     DPL,?V0 + 0
        MOV     R2,DPL
        MOV     A,R0
        ADD     A,R2
        MOV     DPL,A
        MOV     A,R1
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,DPL
        ADD     A,R2
        MOV     DPL,A
        MOV     A,DPH
        ADDC    A,#0x0
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        INC     ?V0 + 0
??PcdAuthState_2:
        MOV     A,?V0 + 0
        CLR     C
        SUBB    A,#0x6
        JC      ??PcdAuthState_3
//  948 
//  949     cStatus = PcdComMF522 ( PCD_AUTHENT, ucComMF522Buf, 12, ucComMF522Buf, & ulLen );
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 32)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 34)
        MOV     R4,#0xc
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xe
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 30)
        MOV     A,R1
        MOV     ?V0 + 0,A
//  950 	
//  951     if ( ( cStatus != MI_OK ) || ( ! ( ReadRawRC ( Status2Reg ) & 0x08 ) ) )
        MOV     A,#0x26
        XRL     A,?V0 + 0
        JNZ     ??PcdAuthState_4
        ; Setup parameters for call to function ReadRawRC
        MOV     R1,#0x8
        LCALL   ??ReadRawRC?relay
        MOV     A,R1
        MOV     C,0xE0 /* A   */.3
        JC      ??PcdAuthState_5
//  952       cStatus = MI_ERR;   
??PcdAuthState_4:
        MOV     ?V0 + 0,#-0x45
//  953     
//  954 		
//  955     return cStatus;
??PcdAuthState_5:
        MOV     R1,?V0 + 0
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock23
//  956 		
//  957 		
//  958 }
//  959 
//  960 //==========================================================
//  961 //	函数名称：	PcdWrite
//  962 //
//  963 //	函数功能：	写数据到M1卡一块
//  964 //
//  965 //	入口参数：	unsigned char ucAddr，块地址
//  966 //              pData，写入的数据，16字节
//  967 //
//  968 //	返回参数：	状态值 = MI_OK，成功
//  969 //
//  970 //	说明：		
//  971 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  972 char PcdWrite ( unsigned char ucAddr, unsigned char * pData )
PcdWrite:
        CFI Block cfiBlock24 Using cfiCommon0
        CFI Function PcdWrite
        CODE
//  973 {
        FUNCALL PcdWrite, CalulateCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 32, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 32, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdWrite, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdWrite, CalulateCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 32, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 32, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdWrite, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 32)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  974     char cStatus;
//  975 	  unsigned char uc, ucComMF522Buf [ MAXRLEN ];
//  976     int ulLen;
//  977      
//  978     
//  979     ucComMF522Buf [ 0 ] = PICC_WRITE;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#-0x60
        MOVX    @DPTR,A
//  980     ucComMF522Buf [ 1 ] = ucAddr;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R1
        MOVX    @DPTR,A
//  981 	
//  982     CalulateCRC ( ucComMF522Buf, 2, & ucComMF522Buf [ 2 ] );
        ; Setup parameters for call to function CalulateCRC
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R1,#0x2
        MOV     A,R1
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??CalulateCRC?relay
//  983  
//  984     cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 4, ucComMF522Buf, & ulLen );
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 34)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 36)
        MOV     R4,#0x4
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xc
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 32)
//  985 
//  986     if ( ( cStatus != MI_OK ) || ( ulLen != 4 ) || ( ( ucComMF522Buf [ 0 ] & 0x0F ) != 0x0A ) )
        MOV     A,#0x26
        XRL     A,R1
        JNZ     ??PcdWrite_0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0x4
        JNZ     ??PcdWrite_1
        INC     DPTR
        MOVX    A,@DPTR
??PcdWrite_1:
        JNZ     ??PcdWrite_0
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        ANL     A,#0xf
        XRL     A,#0xa
        JZ      ??PcdWrite_2
//  987       cStatus = MI_ERR;   
??PcdWrite_0:
        MOV     R1,#-0x45
//  988         
//  989     if ( cStatus == MI_OK )
??PcdWrite_2:
        MOV     A,#0x26
        XRL     A,R1
        JZ      $+5
        LJMP    ??PcdWrite_3 & 0xFFFF
//  990     {
//  991 			//memcpy(ucComMF522Buf, pData, 16);
//  992       for ( uc = 0; uc < 16; uc ++ )
        MOV     R2,#0x0
        SJMP    ??PcdWrite_4
//  993 			  ucComMF522Buf [ uc ] = * ( pData + uc );  
??PcdWrite_5:
        MOV     DPL,R2
        MOV     R0,DPL
        MOV     A,R6
        ADD     A,R0
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,DPL
        ADD     A,R0
        MOV     DPL,A
        MOV     A,DPH
        ADDC    A,#0x0
        MOV     DPH,A
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        INC     R2
??PcdWrite_4:
        MOV     A,R2
        CLR     C
        SUBB    A,#0x10
        JC      ??PcdWrite_5
//  994 			
//  995       CalulateCRC ( ucComMF522Buf, 16, & ucComMF522Buf [ 16 ] );
        ; Setup parameters for call to function CalulateCRC
        MOV     A,#0x12
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R1,#0x10
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??CalulateCRC?relay
//  996 
//  997       cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 18, ucComMF522Buf, & ulLen );
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 34)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 36)
        MOV     R4,#0x12
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xc
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 32)
//  998 			
//  999 			if ( ( cStatus != MI_OK ) || ( ulLen != 4 ) || ( ( ucComMF522Buf [ 0 ] & 0x0F ) != 0x0A ) )
        MOV     A,#0x26
        XRL     A,R1
        JNZ     ??PcdWrite_6
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0x4
        JNZ     ??PcdWrite_7
        INC     DPTR
        MOVX    A,@DPTR
??PcdWrite_7:
        JNZ     ??PcdWrite_6
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        ANL     A,#0xf
        XRL     A,#0xa
        JZ      ??PcdWrite_3
// 1000         cStatus = MI_ERR;   
??PcdWrite_6:
        MOV     R1,#-0x45
// 1001 			
// 1002     } 
// 1003 		
// 1004 		
// 1005     return cStatus;
??PcdWrite_3:
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     R7,#0x4
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock24
// 1006 			
// 1007 }
// 1008 
// 1009 //==========================================================
// 1010 //	函数名称：	PcdRead
// 1011 //
// 1012 //	函数功能：	读取M1卡一块数据
// 1013 //
// 1014 //	入口参数：	unsigned char ucAddr，块地址
// 1015 //               pData，读出的数据，16字节
// 1016 //
// 1017 //	返回参数：	状态值 = MI_OK，成功
// 1018 //
// 1019 //	说明：		
// 1020 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1021 char PcdRead ( unsigned char ucAddr, unsigned char * pData )
PcdRead:
        CFI Block cfiBlock25 Using cfiCommon0
        CFI Function PcdRead
        CODE
// 1022 {
        FUNCALL PcdRead, CalulateCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 31, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 31, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdRead, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 35, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 35, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xb
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 31)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1023     char cStatus;
// 1024 	  unsigned char uc, ucComMF522Buf [ MAXRLEN ]; 
// 1025     int ulLen;
// 1026     
// 1027 
// 1028     ucComMF522Buf [ 0 ] = PICC_READ;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x30
        MOVX    @DPTR,A
// 1029     ucComMF522Buf [ 1 ] = ucAddr;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R1
        MOVX    @DPTR,A
// 1030 	
// 1031     CalulateCRC ( ucComMF522Buf, 2, & ucComMF522Buf [ 2 ] );
        ; Setup parameters for call to function CalulateCRC
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R1,#0x2
        MOV     A,R1
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??CalulateCRC?relay
// 1032    
// 1033     cStatus = PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 4, ucComMF522Buf, & ulLen );
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 33)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 35)
        MOV     R4,#0x4
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xc
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 31)
// 1034 	
// 1035     if ( ( cStatus == MI_OK ) && ( ulLen == 0x90 ) )
        MOV     A,#0x26
        XRL     A,R1
        JNZ     ??PcdRead_0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0x90
        JNZ     ??PcdRead_1
        INC     DPTR
        MOVX    A,@DPTR
??PcdRead_1:
        JNZ     ??PcdRead_0
// 1036     {
// 1037 			for ( uc = 0; uc < 16; uc ++ )
        MOV     R0,#0x0
??PcdRead_2:
        MOV     A,R0
        CLR     C
        SUBB    A,#0x10
        JNC     ??PcdRead_3
// 1038         * ( pData + uc ) = ucComMF522Buf [ uc ];   
        MOV     DPL,R0
        MOV     R2,DPL
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,DPL
        ADD     A,R2
        MOV     DPL,A
        MOV     A,DPH
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,R6
        ADD     A,R2
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        INC     R0
        SJMP    ??PcdRead_2
// 1039     }
// 1040 		
// 1041     else
// 1042       cStatus = MI_ERR;   
??PcdRead_0:
        MOV     R1,#-0x45
// 1043     
// 1044 		
// 1045     return cStatus;
??PcdRead_3:
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
        MOV     R7,#0x3
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock25
// 1046 		
// 1047 		
// 1048 }
// 1049 
// 1050 //==========================================================
// 1051 //	函数名称：	PcdHalt
// 1052 //
// 1053 //	函数功能：	命令卡片进入休眠状态
// 1054 //
// 1055 //	入口参数：	无
// 1056 //
// 1057 //	返回参数：	状态值 = MI_OK，成功
// 1058 //
// 1059 //	说明：		
// 1060 //==========================================================

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1061 char PcdHalt( void )
PcdHalt:
        CFI Block cfiBlock26 Using cfiCommon0
        CFI Function PcdHalt
        CODE
// 1062 {
        FUNCALL PcdHalt, CalulateCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 30, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 30, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL PcdHalt, PcdComMF522
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 30)
// 1063 	unsigned char ucComMF522Buf [ MAXRLEN ]; 
// 1064 	int  ulLen;
// 1065   
// 1066 
// 1067   ucComMF522Buf [ 0 ] = PICC_HALT;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x50
        MOVX    @DPTR,A
// 1068   ucComMF522Buf [ 1 ] = 0;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
// 1069 	
// 1070   CalulateCRC ( ucComMF522Buf, 2, & ucComMF522Buf [ 2 ] );
        ; Setup parameters for call to function CalulateCRC
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R1,#0x2
        MOV     A,R1
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??CalulateCRC?relay
// 1071  	PcdComMF522 ( PCD_TRANSCEIVE, ucComMF522Buf, 4, ucComMF522Buf, & ulLen );
        ; Setup parameters for call to function PcdComMF522
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 32)
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 34)
        MOV     R4,#0x4
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0xc
        LCALL   ??PcdComMF522?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 30)
// 1072 
// 1073   return MI_OK;
        MOV     R1,#0x26
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock26
// 1074 	
// 1075 }
// 1076 
// 1077 

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1078 void IC_CMT ( unsigned char * UID, unsigned char * KEY, unsigned char RW, unsigned char * Dat )
IC_CMT:
        CFI Block cfiBlock27 Using cfiCommon0
        CFI Function IC_CMT
        CODE
// 1079 {
        FUNCALL IC_CMT, PcdRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_CMT, PcdAnticoll
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_CMT, PcdSelect
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_CMT, PcdAuthState
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_CMT, PcdRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_CMT, PcdWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL IC_CMT, PcdHalt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xd
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 13)
        ; Saved register size: 13
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 17)
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
        MOV     ?V0 + 4,R1
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 1,A
// 1080   unsigned char ucArray_ID [ 4 ] = { 0 };//先后存放IC卡的类型和UID(IC卡序列号)
        MOV     DPTR,#`?<Constant {0}>`
        PUSH    DPL
        CFI CFA_SP SP+-1
        PUSH    DPH
        CFI CFA_SP SP+-2
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        POP     DPH
        CFI CFA_SP SP+-1
        POP     DPL
        CFI CFA_SP SP+0
        MOV     A,#0x4
        LCALL   ?MOVE_LONG8_XDATA_XDATA
// 1081   
// 1082 	
// 1083   PcdRequest ( 0x52, ucArray_ID );//寻卡
        ; Setup parameters for call to function PcdRequest
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0x52
        LCALL   ??PcdRequest?relay
// 1084 
// 1085   PcdAnticoll ( ucArray_ID );//防冲撞
        ; Setup parameters for call to function PcdAnticoll
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??PcdAnticoll?relay
// 1086   
// 1087   PcdSelect ( UID );//选定卡
        ; Setup parameters for call to function PcdSelect
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??PcdSelect?relay
// 1088   
// 1089   PcdAuthState ( 0x60, 0x10, KEY, UID );//校验
        ; Setup parameters for call to function PcdAuthState
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 19)
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R2,#0x10
        MOV     R1,#0x60
        LCALL   ??PcdAuthState?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 17)
// 1090 	
// 1091 
// 1092 	if ( RW )//读写选择，1是读，0是写
        MOV     A,?V0 + 4
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        MOV     R1,#0x10
        JZ      ??IC_CMT_0
// 1093     PcdRead ( 0x10, Dat );
        ; Setup parameters for call to function PcdRead
        LCALL   ??PcdRead?relay
        SJMP    ??IC_CMT_1
// 1094    
// 1095    else 
// 1096      PcdWrite ( 0x10, Dat );
??IC_CMT_0:
        ; Setup parameters for call to function PcdWrite
        LCALL   ??PcdWrite?relay
// 1097    
// 1098 	 
// 1099    PcdHalt ();
??IC_CMT_1:
        ; Setup parameters for call to function PcdHalt
        LCALL   ??PcdHalt?relay
// 1100 	 
// 1101 	 
// 1102 }
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 13)
        MOV     R7,#0x5
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock27

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for pk>`:
        DATA8
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??RC522_Init?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    RC522_Init

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??DataRep?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    DataRep

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??RFID_GetCardID?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    RFID_GetCardID

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??IC_Card_Search?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    IC_Card_Search

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??IC_Card_Write?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    IC_Card_Write

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??IC_Card_Read?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    IC_Card_Read

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??RC522_SPI_Config?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    RC522_SPI_Config

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??SPI_RC522_SendByte?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    SPI_RC522_SendByte

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??SPI_RC522_ReadByte?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    SPI_RC522_ReadByte

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ReadRawRC?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    ReadRawRC

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??WriteRawRC?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    WriteRawRC

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??SetBitMask?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    SetBitMask

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ClearBitMask?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    ClearBitMask

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdAntennaOn?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdAntennaOn

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdAntennaOff?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdAntennaOff

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??RC522_InitStatus?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    RC522_InitStatus

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdReset?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdReset

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??M500PcdConfigISOType?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    M500PcdConfigISOType

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdComMF522?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdComMF522

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdRequest?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdRequest

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdAnticoll?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdAnticoll

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CalulateCRC?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CalulateCRC

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdSelect?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdSelect

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdAuthState?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdAuthState

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdWrite?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdWrite

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdRead?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdRead

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??PcdHalt?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    PcdHalt

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??IC_CMT?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    IC_CMT

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant "get IC Card\\r\\n">`:
        DB "get IC Card\015\012"

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant "UUID=0x%x%x%x%x\\r\\n">`:
        DB "UUID=0x%x%x%x%x\015\012"

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant "read UUID failure\\r\\n">`:
        DB "read UUID failure\015\012"

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant "lost IC Card\\r\\n">`:
        DB "lost IC Card\015\012"

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant "0x">`:
        DB "0x"

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
`?<Constant {0}>`:
        DATA8
        DB 0
        DB 0, 0, 0

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_c8:
        DD 200

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_1:
        DD 1

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_64:
        DD 100

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_2:
        DD 2

        END
// 1103 
// 1104 
// 
// 3 676 bytes in segment BANKED_CODE
//   168 bytes in segment BANK_RELAYS
//     4 bytes in segment SFR_AN
//     6 bytes in segment XDATA_I
//     6 bytes in segment XDATA_ID
//    90 bytes in segment XDATA_ROM_C
//    81 bytes in segment XDATA_Z
// 
// 3 850 bytes of CODE  memory
//    74 bytes of CONST memory (+ 16 bytes shared)
//     0 bytes of DATA  memory (+  4 bytes shared)
//    87 bytes of XDATA memory
//
//Errors: none
//Warnings: none
